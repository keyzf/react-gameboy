!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("React")):"function"==typeof define&&define.amd?define(["React"],factory):"object"==typeof exports?exports.Gameboy=factory(require("React")):root.Gameboy=factory(root.React)}(this,function(__WEBPACK_EXTERNAL_MODULE_2__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){var React=__webpack_require__(2),gameboy=__webpack_require__(3),XAudioServer=__webpack_require__(4),buttons=["right","left","up","down","a","b","select","start"],Gameboy=React.createClass({displayName:"Gameboy",getDefaultProps:function(){return{opts:{sound:XAudioServer},running:!1,speed:1,volume:1}},getInitialState:function(){return{running:this.props.running}},render:function(){return React.createElement("canvas",{className:"gameboy",ref:"gameboy"})},componentDidMount:function(){this.start()},componentDidUpdate:function(prevProps){var self=this;prevProps.romData!==this.props.romData&&(this.state.running&&this.stop(),this.start()),prevProps.volume!==this.props.volume&&this.gb.audioHandle&&this.gb.audioHandle.changeVolume(this.props.volume),clearTimeout(this.loopId),function animLoop(){if(self.state.running){var duration=8/self.props.speed;self.loopId=setTimeout(animLoop,duration),self.gb.run()}}()},componentWillReceiveProps:function(nextProps){if(this.gb)for(var button in nextProps.gamepad){var buttonId=buttons.indexOf(button);if(0>buttonId)return;this.gb.JoyPadEvent(buttonId,this.props.gamepad[button])}},componentWillUnmount:function(){this.stop()},pause:function(){this.setState({running:!1})},resume:function(){this.setState({running:!0})},start:function(){if(this.props.romData){var canvasEl=this.refs.gameboy.getDOMNode();this.gb=gameboy(canvasEl,this.props.romData,this.props.opts),this.gb.stopEmulator=1,this.gb.start(),this.gb.audioHandle&&this.gb.audioHandle.changeVolume(this.props.volume),this.setState({running:!0})}},stop:function(){this.setState({running:!1}),clearTimeout(this.loopId)},getSaveState:function(){return this.gb.saveState()},openSaveState:function(saveState){this.gb.returnFromState(saveState)}});module.exports=Gameboy},function(module){module.exports=__WEBPACK_EXTERNAL_MODULE_2__},function(module,exports,__webpack_require__){function GameBoyCore(canvas,ROMImage,opts){if(!(this instanceof GameBoyCore))return new GameBoyCore(canvas,ROMImage,opts);opts=opts||{},this.opts={},this.opts.bootRom=!1!==opts.bootRom,this.opts.gbBootRom=!!opts.gbBootRom,this.opts.mbc1=!!opts.mbc1,this.opts.prioritizeGb=!!opts.prioritizeGb,this.opts.interval=opts.interval||8,this.opts.imageSmoothing=!1!==opts.imageSmoothing,this.opts.sound=opts.sound,this.opts.volume=opts.volume||1,this.opts.audioBufferMin=opts.audioBufferMin||10,this.opts.audioBufferMax=opts.audioBufferMax||20,this.opts.colorizeGb=!1!==opts.colorizeGb,this.opts.typedArrays=!1!==opts.typedArrays,this.opts.overrideMbc=!!opts.overrideMbc,this.opts.canvas=opts.canvas,this.opts.channels=opts.channels||[!0,!0,!0,!0],this.opts.drawEvents=!!opts.drawEvents,this.canvas=canvas,this.drawContext=null,this.ROMImage=ROMImage,this.ROMImageIsString="string"==typeof ROMImage,this.registerA=1,this.FZero=!0,this.FSubtract=!1,this.FHalfCarry=!0,this.FCarry=!0,this.registerB=0,this.registerC=19,this.registerD=0,this.registerE=216,this.registersHL=333,this.stackPointer=65534,this.programCounter=256,this.CPUCyclesTotal=0,this.CPUCyclesTotalBase=0,this.CPUCyclesTotalCurrent=0,this.CPUCyclesTotalRoundoff=0,this.baseCPUCyclesPerIteration=0,this.remainingClocks=0,this.inBootstrap=!0,this.usedBootROM=!1,this.usedGBCBootROM=!1,this.halt=!1,this.skipPCIncrement=!1,this.stopEmulator=3,this.IME=!0,this.IRQLineMatched=0,this.interruptsRequested=0,this.interruptsEnabled=0,this.hdmaRunning=!1,this.CPUTicks=0,this.doubleSpeedShifter=0,this.JoyPad=255,this.CPUStopped=!1,this.memoryReader=[],this.memoryWriter=[],this.memoryHighReader=[],this.memoryHighWriter=[],this.ROM=[],this.memory=[],this.MBCRam=[],this.VRAM=[],this.GBCMemory=[],this.MBC1Mode=!1,this.MBCRAMBanksEnabled=!1,this.currMBCRAMBank=0,this.currMBCRAMBankPosition=-40960,this.cGBC=!1,this.gbcRamBank=1,this.gbcRamBankPosition=-53248,this.gbcRamBankPositionECHO=-61440,this.RAMBanks=[0,1,2,4,16],this.ROMBank1offs=0,this.currentROMBank=0,this.cartridgeType=0,this.name="",this.gameCode="",this.fromSaveState=!1,this.savedStateFileName="",this.STATTracker=0,this.modeSTAT=0,this.spriteCount=252,this.LYCMatchTriggerSTAT=!1,this.mode2TriggerSTAT=!1,this.mode1TriggerSTAT=!1,this.mode0TriggerSTAT=!1,this.LCDisOn=!1,this.LINECONTROL=[],this.DISPLAYOFFCONTROL=[function(){}],this.LCDCONTROL=null,this.initializeLCDController(),this.RTCisLatched=!1,this.latchedSeconds=0,this.latchedMinutes=0,this.latchedHours=0,this.latchedLDays=0,this.latchedHDays=0,this.RTCSeconds=0,this.RTCMinutes=0,this.RTCHours=0,this.RTCDays=0,this.RTCDayOverFlow=!1,this.RTCHALT=!1,this.highX=127,this.lowX=127,this.highY=127,this.lowY=127,this.audioHandle=null,this.numSamplesTotal=0,this.dutyLookup=[[!1,!1,!1,!1,!1,!1,!1,!0],[!0,!1,!1,!1,!1,!1,!1,!0],[!0,!1,!1,!1,!1,!0,!0,!0],[!1,!0,!0,!0,!0,!0,!0,!1]],this.bufferContainAmount=0,this.LSFR15Table=null,this.LSFR7Table=null,this.noiseSampleTable=null,this.initializeAudioStartState(),this.soundMasterEnabled=!1,this.channel3PCM=null,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.leftChannel1=!1,this.leftChannel2=!1,this.leftChannel3=!1,this.leftChannel4=!1,this.rightChannel1=!1,this.rightChannel2=!1,this.rightChannel3=!1,this.rightChannel4=!1,this.audioClocksUntilNextEvent=1,this.audioClocksUntilNextEventCounter=1,this.channel1currentSampleLeft=0,this.channel1currentSampleRight=0,this.channel2currentSampleLeft=0,this.channel2currentSampleRight=0,this.channel3currentSampleLeft=0,this.channel3currentSampleRight=0,this.channel4currentSampleLeft=0,this.channel4currentSampleRight=0,this.channel1currentSampleLeftSecondary=0,this.channel1currentSampleRightSecondary=0,this.channel2currentSampleLeftSecondary=0,this.channel2currentSampleRightSecondary=0,this.channel3currentSampleLeftSecondary=0,this.channel3currentSampleRightSecondary=0,this.channel4currentSampleLeftSecondary=0,this.channel4currentSampleRightSecondary=0,this.channel1currentSampleLeftTrimary=0,this.channel1currentSampleRightTrimary=0,this.channel2currentSampleLeftTrimary=0,this.channel2currentSampleRightTrimary=0,this.mixerOutputCache=0,this.emulatorSpeed=1,this.initializeTiming(),this.audioTicks=0,this.audioIndex=0,this.downsampleInput=0,this.audioDestinationPosition=0,this.rollover=0,this.emulatorTicks=0,this.DIVTicks=56,this.LCDTicks=60,this.timerTicks=0,this.TIMAEnabled=!1,this.TACClocker=1024,this.serialTimer=0,this.serialShiftTimer=0,this.serialShiftTimerAllocated=0,this.IRQEnableDelay=0;var dateVar=new Date;this.lastIteration=dateVar.getTime(),dateVar=new Date,this.firstIteration=dateVar.getTime(),this.iterations=0,this.actualScanLine=0,this.lastUnrenderedLine=0,this.queuedScanLines=0,this.totalLinesPassed=0,this.haltPostClocks=0,this.cMBC1=!1,this.cMBC2=!1,this.cMBC3=!1,this.cMBC5=!1,this.cMBC7=!1,this.cSRAM=!1,this.cMMMO1=!1,this.cRUMBLE=!1,this.cCamera=!1,this.cTAMA5=!1,this.cHuC3=!1,this.cHuC1=!1,this.cTIMER=!1,this.ROMBanks=[2,4,8,16,32,64,128,256,512],this.ROMBanks[82]=72,this.ROMBanks[83]=80,this.ROMBanks[84]=96,this.numRAMBanks=0,this.currVRAMBank=0,this.backgroundX=0,this.backgroundY=0,this.gfxWindowDisplay=!1,this.gfxSpriteShow=!1,this.gfxSpriteNormalHeight=!0,this.bgEnabled=!0,this.BGPriorityEnabled=!0,this.gfxWindowCHRBankPosition=0,this.gfxBackgroundCHRBankPosition=0,this.gfxBackgroundBankOffset=128,this.windowY=0,this.windowX=0,this.drewBlank=0,this.drewFrame=!1,this.midScanlineOffset=-1,this.pixelEnd=0,this.currentX=0,this.BGCHRBank1=null,this.BGCHRBank2=null,this.BGCHRCurrentBank=null,this.tileCache=null,this.colors=[15728606,11392916,5411443,1586242],this.OBJPalette=null,this.BGPalette=null,this.gbcOBJRawPalette=null,this.gbcBGRawPalette=null,this.gbOBJPalette=null,this.gbBGPalette=null,this.gbcOBJPalette=null,this.gbcBGPalette=null,this.gbBGColorizedPalette=null,this.gbOBJColorizedPalette=null,this.cachedBGPaletteConversion=null,this.cachedOBJPaletteConversion=null,this.updateGBBGPalette=this.updateGBRegularBGPalette,this.updateGBOBJPalette=this.updateGBRegularOBJPalette,this.colorizedGBPalettes=!1,this.BGLayerRender=null,this.WindowLayerRender=null,this.SpriteLayerRender=null,this.frameBuffer=[],this.swizzledFrame=null,this.canvasBuffer=null,this.pixelStart=0,this.onscreenWidth=this.offscreenWidth=160,this.onscreenHeight=this.offscreenHeight=144,this.offscreenRGBCount=this.onscreenWidth*this.onscreenHeight*4,this.resizePathClear=!0,this.intializeWhiteNoise()}var Emitter=__webpack_require__(6),debug=__webpack_require__(7)("gameboy");module.exports=GameBoyCore,Emitter(GameBoyCore.prototype),GameBoyCore.prototype.GBBOOTROM=[],GameBoyCore.prototype.GBCBOOTROM=[],GameBoyCore.prototype.ffxxDump=[15,0,124,255,0,0,0,248,255,255,255,255,255,255,255,1,128,191,243,255,191,255,63,0,255,191,127,255,159,255,191,255,255,0,0,191,119,243,241,255,255,255,255,255,255,255,255,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,145,128,0,0,0,0,0,252,0,0,0,0,255,126,255,254,255,255,255,255,255,255,62,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,192,255,193,0,254,255,255,255,248,255,0,0,0,143,0,0,255,255,255,255,255,255,255,255,206,237,102,102,204,13,0,11,3,115,0,131,0,12,0,13,0,8,17,31,136,137,0,14,220,204,110,230,221,221,217,153,187,187,103,99,110,14,236,204,221,220,153,159,187,185,51,62,69,236,82,250,8,183,7,93,1,253,192,255,8,252,0,229,11,248,194,206,244,249,15,127,69,109,61,254,70,151,51,94,8,239,241,255,134,131,36,116,18,252,0,159,180,183,6,213,208,122,0,158,4,95,65,47,29,119,54,117,129,170,112,58,152,209,113,2,77,1,193,255,13,0,211,5,249,0,11,0],GameBoyCore.prototype.OPCODE=[function(){},function(parentObj){parentObj.registerC=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.registerB=parentObj.memoryRead(parentObj.programCounter+1&65535),parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){parentObj.memoryWrite(parentObj.registerB<<8|parentObj.registerC,parentObj.registerA)},function(parentObj){var temp_var=(parentObj.registerB<<8|parentObj.registerC)+1;parentObj.registerB=temp_var>>8&255,parentObj.registerC=255&temp_var},function(parentObj){parentObj.registerB=parentObj.registerB+1&255,parentObj.FZero=0==parentObj.registerB,parentObj.FHalfCarry=0==(15&parentObj.registerB),parentObj.FSubtract=!1},function(parentObj){parentObj.registerB=parentObj.registerB-1&255,parentObj.FZero=0==parentObj.registerB,parentObj.FHalfCarry=15==(15&parentObj.registerB),parentObj.FSubtract=!0},function(parentObj){parentObj.registerB=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.FCarry=parentObj.registerA>127,parentObj.registerA=parentObj.registerA<<1&255|parentObj.registerA>>7,parentObj.FZero=parentObj.FSubtract=parentObj.FHalfCarry=!1},function(parentObj){var temp_var=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.memoryWrite(temp_var,255&parentObj.stackPointer),parentObj.memoryWrite(temp_var+1&65535,parentObj.stackPointer>>8)},function(parentObj){var dirtySum=parentObj.registersHL+(parentObj.registerB<<8|parentObj.registerC);parentObj.FHalfCarry=(4095&parentObj.registersHL)>(4095&dirtySum),parentObj.FCarry=dirtySum>65535,parentObj.registersHL=65535&dirtySum,parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=parentObj.memoryRead(parentObj.registerB<<8|parentObj.registerC)},function(parentObj){var temp_var=(parentObj.registerB<<8|parentObj.registerC)-1&65535;parentObj.registerB=temp_var>>8,parentObj.registerC=255&temp_var},function(parentObj){parentObj.registerC=parentObj.registerC+1&255,parentObj.FZero=0==parentObj.registerC,parentObj.FHalfCarry=0==(15&parentObj.registerC),parentObj.FSubtract=!1},function(parentObj){parentObj.registerC=parentObj.registerC-1&255,parentObj.FZero=0==parentObj.registerC,parentObj.FHalfCarry=15==(15&parentObj.registerC),parentObj.FSubtract=!0},function(parentObj){parentObj.registerC=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.registerA=parentObj.registerA>>1|(1&parentObj.registerA)<<7,parentObj.FCarry=parentObj.registerA>127,parentObj.FZero=parentObj.FSubtract=parentObj.FHalfCarry=!1},function(parentObj){parentObj.cGBC&&1==(1&parentObj.memory[65357])?(parentObj.memory[65357]>127?(debug("Going into single clock speed mode.",0),parentObj.doubleSpeedShifter=0,parentObj.memory[65357]&=127):(debug("Going into double clock speed mode.",0),parentObj.doubleSpeedShifter=1,parentObj.memory[65357]|=128),parentObj.memory[65357]&=254):parentObj.handleSTOP()},function(parentObj){parentObj.registerE=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.registerD=parentObj.memoryRead(parentObj.programCounter+1&65535),parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){parentObj.memoryWrite(parentObj.registerD<<8|parentObj.registerE,parentObj.registerA)},function(parentObj){var temp_var=(parentObj.registerD<<8|parentObj.registerE)+1;parentObj.registerD=temp_var>>8&255,parentObj.registerE=255&temp_var},function(parentObj){parentObj.registerD=parentObj.registerD+1&255,parentObj.FZero=0==parentObj.registerD,parentObj.FHalfCarry=0==(15&parentObj.registerD),parentObj.FSubtract=!1},function(parentObj){parentObj.registerD=parentObj.registerD-1&255,parentObj.FZero=0==parentObj.registerD,parentObj.FHalfCarry=15==(15&parentObj.registerD),parentObj.FSubtract=!0},function(parentObj){parentObj.registerD=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){var carry_flag=parentObj.FCarry?1:0;parentObj.FCarry=parentObj.registerA>127,parentObj.registerA=parentObj.registerA<<1&255|carry_flag,parentObj.FZero=parentObj.FSubtract=parentObj.FHalfCarry=!1},function(parentObj){parentObj.programCounter=parentObj.programCounter+(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24)+1&65535},function(parentObj){var dirtySum=parentObj.registersHL+(parentObj.registerD<<8|parentObj.registerE);parentObj.FHalfCarry=(4095&parentObj.registersHL)>(4095&dirtySum),parentObj.FCarry=dirtySum>65535,parentObj.registersHL=65535&dirtySum,parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=parentObj.memoryRead(parentObj.registerD<<8|parentObj.registerE)},function(parentObj){var temp_var=(parentObj.registerD<<8|parentObj.registerE)-1&65535;parentObj.registerD=temp_var>>8,parentObj.registerE=255&temp_var},function(parentObj){parentObj.registerE=parentObj.registerE+1&255,parentObj.FZero=0==parentObj.registerE,parentObj.FHalfCarry=0==(15&parentObj.registerE),parentObj.FSubtract=!1},function(parentObj){parentObj.registerE=parentObj.registerE-1&255,parentObj.FZero=0==parentObj.registerE,parentObj.FHalfCarry=15==(15&parentObj.registerE),parentObj.FSubtract=!0},function(parentObj){parentObj.registerE=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){var carry_flag=parentObj.FCarry?128:0;parentObj.FCarry=1==(1&parentObj.registerA),parentObj.registerA=parentObj.registerA>>1|carry_flag,parentObj.FZero=parentObj.FSubtract=parentObj.FHalfCarry=!1},function(parentObj){parentObj.FZero?parentObj.programCounter=parentObj.programCounter+1&65535:(parentObj.programCounter=parentObj.programCounter+(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24)+1&65535,parentObj.CPUTicks+=4)},function(parentObj){parentObj.registersHL=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerA),parentObj.registersHL=parentObj.registersHL+1&65535},function(parentObj){parentObj.registersHL=parentObj.registersHL+1&65535},function(parentObj){var H=(parentObj.registersHL>>8)+1&255;parentObj.FZero=0==H,parentObj.FHalfCarry=0==(15&H),parentObj.FSubtract=!1,parentObj.registersHL=H<<8|255&parentObj.registersHL},function(parentObj){var H=(parentObj.registersHL>>8)-1&255;parentObj.FZero=0==H,parentObj.FHalfCarry=15==(15&H),parentObj.FSubtract=!0,parentObj.registersHL=H<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<8|255&parentObj.registersHL,parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.FSubtract?parentObj.FCarry&&parentObj.FHalfCarry?(parentObj.registerA=parentObj.registerA+154&255,parentObj.FHalfCarry=!1):parentObj.FCarry?parentObj.registerA=parentObj.registerA+160&255:parentObj.FHalfCarry&&(parentObj.registerA=parentObj.registerA+250&255,parentObj.FHalfCarry=!1):((parentObj.FCarry||parentObj.registerA>153)&&(parentObj.registerA=parentObj.registerA+96&255,parentObj.FCarry=!0),(parentObj.FHalfCarry||(15&parentObj.registerA)>9)&&(parentObj.registerA=parentObj.registerA+6&255,parentObj.FHalfCarry=!1)),parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.FZero?(parentObj.programCounter=parentObj.programCounter+(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24)+1&65535,parentObj.CPUTicks+=4):parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.FHalfCarry=(4095&parentObj.registersHL)>2047,parentObj.FCarry=parentObj.registersHL>32767,parentObj.registersHL=parentObj.registersHL<<1&65535,parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),parentObj.registersHL=parentObj.registersHL+1&65535},function(parentObj){parentObj.registersHL=parentObj.registersHL-1&65535},function(parentObj){var L=parentObj.registersHL+1&255;parentObj.FZero=0==L,parentObj.FHalfCarry=0==(15&L),parentObj.FSubtract=!1,parentObj.registersHL=65280&parentObj.registersHL|L},function(parentObj){var L=parentObj.registersHL-1&255;parentObj.FZero=0==L,parentObj.FHalfCarry=15==(15&L),parentObj.FSubtract=!0,parentObj.registersHL=65280&parentObj.registersHL|L},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.registerA^=255,parentObj.FSubtract=parentObj.FHalfCarry=!0},function(parentObj){parentObj.FCarry?parentObj.programCounter=parentObj.programCounter+1&65535:(parentObj.programCounter=parentObj.programCounter+(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24)+1&65535,parentObj.CPUTicks+=4)},function(parentObj){parentObj.stackPointer=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerA),parentObj.registersHL=parentObj.registersHL-1&65535},function(parentObj){parentObj.stackPointer=parentObj.stackPointer+1&65535},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)+1&255;parentObj.FZero=0==temp_var,parentObj.FHalfCarry=0==(15&temp_var),parentObj.FSubtract=!1,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)-1&255;parentObj.FZero=0==temp_var,parentObj.FHalfCarry=15==(15&temp_var),parentObj.FSubtract=!0,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.FCarry=!0,parentObj.FSubtract=parentObj.FHalfCarry=!1},function(parentObj){parentObj.FCarry?(parentObj.programCounter=parentObj.programCounter+(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24)+1&65535,parentObj.CPUTicks+=4):parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){var dirtySum=parentObj.registersHL+parentObj.stackPointer;parentObj.FHalfCarry=(4095&parentObj.registersHL)>(4095&dirtySum),parentObj.FCarry=dirtySum>65535,parentObj.registersHL=65535&dirtySum,parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),parentObj.registersHL=parentObj.registersHL-1&65535},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535},function(parentObj){parentObj.registerA=parentObj.registerA+1&255,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=0==(15&parentObj.registerA),parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=parentObj.registerA-1&255,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=15==(15&parentObj.registerA),parentObj.FSubtract=!0},function(parentObj){parentObj.registerA=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.FCarry=!parentObj.FCarry,parentObj.FSubtract=parentObj.FHalfCarry=!1},function(){},function(parentObj){parentObj.registerB=parentObj.registerC},function(parentObj){parentObj.registerB=parentObj.registerD},function(parentObj){parentObj.registerB=parentObj.registerE},function(parentObj){parentObj.registerB=parentObj.registersHL>>8},function(parentObj){parentObj.registerB=255&parentObj.registersHL},function(parentObj){parentObj.registerB=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(parentObj){parentObj.registerB=parentObj.registerA},function(parentObj){parentObj.registerC=parentObj.registerB},function(){},function(parentObj){parentObj.registerC=parentObj.registerD},function(parentObj){parentObj.registerC=parentObj.registerE},function(parentObj){parentObj.registerC=parentObj.registersHL>>8},function(parentObj){parentObj.registerC=255&parentObj.registersHL},function(parentObj){parentObj.registerC=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(parentObj){parentObj.registerC=parentObj.registerA},function(parentObj){parentObj.registerD=parentObj.registerB},function(parentObj){parentObj.registerD=parentObj.registerC},function(){},function(parentObj){parentObj.registerD=parentObj.registerE},function(parentObj){parentObj.registerD=parentObj.registersHL>>8},function(parentObj){parentObj.registerD=255&parentObj.registersHL},function(parentObj){parentObj.registerD=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(parentObj){parentObj.registerD=parentObj.registerA},function(parentObj){parentObj.registerE=parentObj.registerB},function(parentObj){parentObj.registerE=parentObj.registerC},function(parentObj){parentObj.registerE=parentObj.registerD},function(){},function(parentObj){parentObj.registerE=parentObj.registersHL>>8},function(parentObj){parentObj.registerE=255&parentObj.registersHL},function(parentObj){parentObj.registerE=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(parentObj){parentObj.registerE=parentObj.registerA},function(parentObj){parentObj.registersHL=parentObj.registerB<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=parentObj.registerC<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=parentObj.registerD<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=parentObj.registerE<<8|255&parentObj.registersHL},function(){},function(parentObj){parentObj.registersHL=257*(255&parentObj.registersHL)},function(parentObj){parentObj.registersHL=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=parentObj.registerA<<8|255&parentObj.registersHL},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registerB},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registerC},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registerD},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registerE},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registersHL>>8},function(){},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|parentObj.registerA},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerB)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerC)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerD)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerE)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registersHL>>8)},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,255&parentObj.registersHL)},function(parentObj){(parentObj.interruptsEnabled&parentObj.interruptsRequested&31)>0?parentObj.cGBC||parentObj.usedBootROM?parentObj.CPUTicks+=4:parentObj.skipPCIncrement=!0:parentObj.calculateHALTPeriod()},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,parentObj.registerA)},function(parentObj){parentObj.registerA=parentObj.registerB},function(parentObj){parentObj.registerA=parentObj.registerC},function(parentObj){parentObj.registerA=parentObj.registerD},function(parentObj){parentObj.registerA=parentObj.registerE},function(parentObj){parentObj.registerA=parentObj.registersHL>>8},function(parentObj){parentObj.registerA=255&parentObj.registersHL},function(parentObj){parentObj.registerA=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL)},function(){},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerB;parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerC;parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerD;parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerE;parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+(parentObj.registersHL>>8);parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+(255&parentObj.registersHL);parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){parentObj.FHalfCarry=8==(8&parentObj.registerA),parentObj.FCarry=parentObj.registerA>127,parentObj.registerA=parentObj.registerA<<1&255,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerB+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&parentObj.registerB)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerC+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&parentObj.registerC)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerD+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&parentObj.registerD)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA+parentObj.registerE+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&parentObj.registerE)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var tempValue=parentObj.registersHL>>8,dirtySum=parentObj.registerA+tempValue+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&tempValue)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var tempValue=255&parentObj.registersHL,dirtySum=parentObj.registerA+tempValue+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&tempValue)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var tempValue=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),dirtySum=parentObj.registerA+tempValue+(parentObj.FCarry?1:0);
parentObj.FHalfCarry=(15&parentObj.registerA)+(15&tempValue)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA<<1|(parentObj.FCarry?1:0);parentObj.FHalfCarry=(parentObj.registerA<<1&30|(parentObj.FCarry?1:0))>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerB;parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerC;parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerD;parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerE;parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-(parentObj.registersHL>>8);parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-(255&parentObj.registersHL);parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){parentObj.registerA=0,parentObj.FHalfCarry=parentObj.FCarry=!1,parentObj.FZero=parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerB-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&parentObj.registerB)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerC-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&parentObj.registerC)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerD-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&parentObj.registerD)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerE-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&parentObj.registerE)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var temp_var=parentObj.registersHL>>8,dirtySum=parentObj.registerA-temp_var-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&temp_var)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-(255&parentObj.registersHL)-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&parentObj.registersHL)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),dirtySum=parentObj.registerA-temp_var-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&temp_var)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){parentObj.FCarry?(parentObj.FZero=!1,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!0,parentObj.registerA=255):(parentObj.FHalfCarry=parentObj.FCarry=!1,parentObj.FSubtract=parentObj.FZero=!0,parentObj.registerA=0)},function(parentObj){parentObj.registerA&=parentObj.registerB,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.registerC,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.registerD,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.registerE,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.registersHL>>8,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.registersHL,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA&=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.registerB,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.registerC,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.registerD,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.registerE,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.registersHL>>8,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=255&parentObj.registersHL,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA^=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA=0,parentObj.FZero=!0,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.registerA|=parentObj.registerB,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=parentObj.registerC,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=parentObj.registerD,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=parentObj.registerE,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=parentObj.registersHL>>8,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=255&parentObj.registersHL,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.registerA|=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerB;parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerC;parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerD;parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.registerE;parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-(parentObj.registersHL>>8);parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-(255&parentObj.registersHL);parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){var dirtySum=parentObj.registerA-parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){parentObj.FHalfCarry=parentObj.FCarry=!1,parentObj.FZero=parentObj.FSubtract=!0},function(parentObj){parentObj.FZero||(parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535,parentObj.CPUTicks+=12)},function(parentObj){parentObj.registerC=parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.registerB=parentObj.memoryRead(parentObj.stackPointer+1&65535),parentObj.stackPointer=parentObj.stackPointer+2&65535},function(parentObj){parentObj.FZero?parentObj.programCounter=parentObj.programCounter+2&65535:(parentObj.programCounter=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.CPUTicks+=4)},function(parentObj){parentObj.programCounter=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)},function(parentObj){if(parentObj.FZero)parentObj.programCounter=parentObj.programCounter+2&65535;else{var temp_pc=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=temp_pc,parentObj.CPUTicks+=12}},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registerB),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registerC)},function(parentObj){var dirtySum=parentObj.registerA+parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FHalfCarry=(15&dirtySum)<(15&parentObj.registerA),parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=0},function(parentObj){parentObj.FZero&&(parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535,parentObj.CPUTicks+=12)},function(parentObj){parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535},function(parentObj){parentObj.FZero?(parentObj.programCounter=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.CPUTicks+=4):parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){var opcode=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.CPUTicks+=parentObj.SecondaryTICKTable[opcode],parentObj.CBOPCODE[opcode](parentObj)},function(parentObj){if(parentObj.FZero){var temp_pc=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=temp_pc,parentObj.CPUTicks+=12}else parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){var temp_pc=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=temp_pc},function(parentObj){var tempValue=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535;var dirtySum=parentObj.registerA+tempValue+(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)+(15&tempValue)+(parentObj.FCarry?1:0)>15,parentObj.FCarry=dirtySum>255,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!1},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=8},function(parentObj){parentObj.FCarry||(parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535,parentObj.CPUTicks+=12)},function(parentObj){parentObj.registerE=parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.registerD=parentObj.memoryRead(parentObj.stackPointer+1&65535),parentObj.stackPointer=parentObj.stackPointer+2&65535},function(parentObj){parentObj.FCarry?parentObj.programCounter=parentObj.programCounter+2&65535:(parentObj.programCounter=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.CPUTicks+=4)},function(){this.emit("error",new Error("Illegal op code 0xD3 called"))},function(parentObj){if(parentObj.FCarry)parentObj.programCounter=parentObj.programCounter+2&65535;else{var temp_pc=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=temp_pc,parentObj.CPUTicks+=12}},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registerD),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registerE)},function(parentObj){var dirtySum=parentObj.registerA-parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FHalfCarry=(15&parentObj.registerA)<(15&dirtySum),parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=16},function(parentObj){parentObj.FCarry&&(parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535,parentObj.CPUTicks+=12)},function(parentObj){parentObj.programCounter=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535,parentObj.IRQEnableDelay=2==parentObj.IRQEnableDelay||118==parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)?1:2},function(parentObj){parentObj.FCarry?(parentObj.programCounter=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.CPUTicks+=4):parentObj.programCounter=parentObj.programCounter+2&65535},function(){this.emit("error",new Error("Illegal op code 0xDB called"))},function(parentObj){if(parentObj.FCarry){var temp_pc=parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+2&65535,parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=temp_pc,parentObj.CPUTicks+=12}else parentObj.programCounter=parentObj.programCounter+2&65535},function(){this.emit("error",new Error("Illegal op code 0xDD called, pausing emulation."))},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535;var dirtySum=parentObj.registerA-temp_var-(parentObj.FCarry?1:0);parentObj.FHalfCarry=(15&parentObj.registerA)-(15&temp_var)-(parentObj.FCarry?1:0)<0,parentObj.FCarry=0>dirtySum,parentObj.registerA=255&dirtySum,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=!0},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=24},function(parentObj){parentObj.memoryHighWrite(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.registerA),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){parentObj.registersHL=parentObj.memoryRead(parentObj.stackPointer+1&65535)<<8|parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer),parentObj.stackPointer=parentObj.stackPointer+2&65535},function(parentObj){parentObj.memoryHighWriter[parentObj.registerC](parentObj,parentObj.registerC,parentObj.registerA)},function(){this.emit("error",new Error("Illegal op code 0xE3 called"))},function(){this.emit("error",new Error("Illegal op code 0xE4 called"))},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registersHL>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.registersHL)},function(parentObj){parentObj.registerA&=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FZero=0==parentObj.registerA,parentObj.FHalfCarry=!0,parentObj.FSubtract=parentObj.FCarry=!1},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=32},function(parentObj){var temp_value2=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24;parentObj.programCounter=parentObj.programCounter+1&65535;var temp_value=parentObj.stackPointer+temp_value2&65535;temp_value2=parentObj.stackPointer^temp_value2^temp_value,parentObj.stackPointer=temp_value,parentObj.FCarry=256==(256&temp_value2),parentObj.FHalfCarry=16==(16&temp_value2),parentObj.FZero=parentObj.FSubtract=!1},function(parentObj){parentObj.programCounter=parentObj.registersHL},function(parentObj){parentObj.memoryWrite(parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.registerA),parentObj.programCounter=parentObj.programCounter+2&65535},function(){this.emit("error",new Error("Illegal op code 0xEB called"))},function(){this.emit("error",new Error("Illegal op code 0xEC called"))},function(){this.emit("error",new Error("Illegal op code 0xED called"))},function(parentObj){parentObj.registerA^=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FZero=0==parentObj.registerA,parentObj.FSubtract=parentObj.FHalfCarry=parentObj.FCarry=!1},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=40},function(parentObj){parentObj.registerA=parentObj.memoryHighRead(parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)),parentObj.programCounter=parentObj.programCounter+1&65535},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.stackPointer](parentObj,parentObj.stackPointer);parentObj.FZero=temp_var>127,parentObj.FSubtract=64==(64&temp_var),parentObj.FHalfCarry=32==(32&temp_var),parentObj.FCarry=16==(16&temp_var),parentObj.registerA=parentObj.memoryRead(parentObj.stackPointer+1&65535),parentObj.stackPointer=parentObj.stackPointer+2&65535},function(parentObj){parentObj.registerA=parentObj.memoryHighReader[parentObj.registerC](parentObj,parentObj.registerC)},function(parentObj){parentObj.IME=!1,parentObj.IRQEnableDelay=0},function(){this.emit("error",new Error("Illegal op code 0xF4 called"))},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.registerA),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,(parentObj.FZero?128:0)|(parentObj.FSubtract?64:0)|(parentObj.FHalfCarry?32:0)|(parentObj.FCarry?16:0))},function(parentObj){parentObj.registerA|=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter),parentObj.FZero=0==parentObj.registerA,parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FSubtract=parentObj.FCarry=parentObj.FHalfCarry=!1},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=48},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)<<24>>24;parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.registersHL=parentObj.stackPointer+temp_var&65535,temp_var=parentObj.stackPointer^temp_var^parentObj.registersHL,parentObj.FCarry=256==(256&temp_var),parentObj.FHalfCarry=16==(16&temp_var),parentObj.FZero=parentObj.FSubtract=!1},function(parentObj){parentObj.stackPointer=parentObj.registersHL},function(parentObj){parentObj.registerA=parentObj.memoryRead(parentObj.memoryRead(parentObj.programCounter+1&65535)<<8|parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)),parentObj.programCounter=parentObj.programCounter+2&65535},function(parentObj){parentObj.IRQEnableDelay=2==parentObj.IRQEnableDelay||118==parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter)?1:2},function(){this.emit("error",new Error("Illegal op code 0xFC called"))},function(){this.emit("error",new Error("Illegal op code 0xFD called"))},function(parentObj){var dirtySum=parentObj.registerA-parentObj.memoryReader[parentObj.programCounter](parentObj,parentObj.programCounter);parentObj.programCounter=parentObj.programCounter+1&65535,parentObj.FHalfCarry=(15&dirtySum)>(15&parentObj.registerA),parentObj.FCarry=0>dirtySum,parentObj.FZero=0==dirtySum,parentObj.FSubtract=!0},function(parentObj){parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,parentObj.programCounter>>8),parentObj.stackPointer=parentObj.stackPointer-1&65535,parentObj.memoryWriter[parentObj.stackPointer](parentObj,parentObj.stackPointer,255&parentObj.programCounter),parentObj.programCounter=56}],GameBoyCore.prototype.CBOPCODE=[function(parentObj){parentObj.FCarry=parentObj.registerB>127,parentObj.registerB=parentObj.registerB<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){parentObj.FCarry=parentObj.registerC>127,parentObj.registerC=parentObj.registerC<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){parentObj.FCarry=parentObj.registerD>127,parentObj.registerD=parentObj.registerD<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){parentObj.FCarry=parentObj.registerE>127,parentObj.registerE=parentObj.registerE<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){parentObj.FCarry=parentObj.registersHL>32767,parentObj.registersHL=parentObj.registersHL<<1&65024|(parentObj.FCarry?256:0)|255&parentObj.registersHL,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){parentObj.FCarry=128==(128&parentObj.registersHL),parentObj.registersHL=65280&parentObj.registersHL|parentObj.registersHL<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FCarry=temp_var>127,temp_var=temp_var<<1&255|(parentObj.FCarry?1:0),parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){parentObj.FCarry=parentObj.registerA>127,parentObj.registerA=parentObj.registerA<<1&255|(parentObj.FCarry?1:0),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerB),parentObj.registerB=(parentObj.FCarry?128:0)|parentObj.registerB>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerC),parentObj.registerC=(parentObj.FCarry?128:0)|parentObj.registerC>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerD),parentObj.registerD=(parentObj.FCarry?128:0)|parentObj.registerD>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerE),parentObj.registerE=(parentObj.FCarry?128:0)|parentObj.registerE>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){parentObj.FCarry=256==(256&parentObj.registersHL),parentObj.registersHL=(parentObj.FCarry?32768:0)|parentObj.registersHL>>1&65280|255&parentObj.registersHL,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256
},function(parentObj){parentObj.FCarry=1==(1&parentObj.registersHL),parentObj.registersHL=65280&parentObj.registersHL|(parentObj.FCarry?128:0)|(255&parentObj.registersHL)>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FCarry=1==(1&temp_var),temp_var=(parentObj.FCarry?128:0)|temp_var>>1,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerA),parentObj.registerA=(parentObj.FCarry?128:0)|parentObj.registerA>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){var newFCarry=parentObj.registerB>127;parentObj.registerB=parentObj.registerB<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){var newFCarry=parentObj.registerC>127;parentObj.registerC=parentObj.registerC<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){var newFCarry=parentObj.registerD>127;parentObj.registerD=parentObj.registerD<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){var newFCarry=parentObj.registerE>127;parentObj.registerE=parentObj.registerE<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){var newFCarry=parentObj.registersHL>32767;parentObj.registersHL=parentObj.registersHL<<1&65024|(parentObj.FCarry?256:0)|255&parentObj.registersHL,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){var newFCarry=128==(128&parentObj.registersHL);parentObj.registersHL=65280&parentObj.registersHL|parentObj.registersHL<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),newFCarry=temp_var>127;temp_var=temp_var<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){var newFCarry=parentObj.registerA>127;parentObj.registerA=parentObj.registerA<<1&255|(parentObj.FCarry?1:0),parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){var newFCarry=1==(1&parentObj.registerB);parentObj.registerB=(parentObj.FCarry?128:0)|parentObj.registerB>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){var newFCarry=1==(1&parentObj.registerC);parentObj.registerC=(parentObj.FCarry?128:0)|parentObj.registerC>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){var newFCarry=1==(1&parentObj.registerD);parentObj.registerD=(parentObj.FCarry?128:0)|parentObj.registerD>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){var newFCarry=1==(1&parentObj.registerE);parentObj.registerE=(parentObj.FCarry?128:0)|parentObj.registerE>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){var newFCarry=256==(256&parentObj.registersHL);parentObj.registersHL=(parentObj.FCarry?32768:0)|parentObj.registersHL>>1&65280|255&parentObj.registersHL,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){var newFCarry=1==(1&parentObj.registersHL);parentObj.registersHL=65280&parentObj.registersHL|(parentObj.FCarry?128:0)|(255&parentObj.registersHL)>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL),newFCarry=1==(1&temp_var);temp_var=(parentObj.FCarry?128:0)|temp_var>>1,parentObj.FCarry=newFCarry,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){var newFCarry=1==(1&parentObj.registerA);parentObj.registerA=(parentObj.FCarry?128:0)|parentObj.registerA>>1,parentObj.FCarry=newFCarry,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.FCarry=parentObj.registerB>127,parentObj.registerB=parentObj.registerB<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){parentObj.FCarry=parentObj.registerC>127,parentObj.registerC=parentObj.registerC<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){parentObj.FCarry=parentObj.registerD>127,parentObj.registerD=parentObj.registerD<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){parentObj.FCarry=parentObj.registerE>127,parentObj.registerE=parentObj.registerE<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){parentObj.FCarry=parentObj.registersHL>32767,parentObj.registersHL=parentObj.registersHL<<1&65024|255&parentObj.registersHL,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){parentObj.FCarry=128==(128&parentObj.registersHL),parentObj.registersHL=65280&parentObj.registersHL|parentObj.registersHL<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FCarry=temp_var>127,temp_var=temp_var<<1&255,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){parentObj.FCarry=parentObj.registerA>127,parentObj.registerA=parentObj.registerA<<1&255,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerB),parentObj.registerB=128&parentObj.registerB|parentObj.registerB>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerC),parentObj.registerC=128&parentObj.registerC|parentObj.registerC>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerD),parentObj.registerD=128&parentObj.registerD|parentObj.registerD>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerE),parentObj.registerE=128&parentObj.registerE|parentObj.registerE>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){parentObj.FCarry=256==(256&parentObj.registersHL),parentObj.registersHL=parentObj.registersHL>>1&65280|33023&parentObj.registersHL,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){parentObj.FCarry=1==(1&parentObj.registersHL),parentObj.registersHL=65408&parentObj.registersHL|(255&parentObj.registersHL)>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FCarry=1==(1&temp_var),temp_var=128&temp_var|temp_var>>1,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==temp_var},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerA),parentObj.registerA=128&parentObj.registerA|parentObj.registerA>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.registerB=(15&parentObj.registerB)<<4|parentObj.registerB>>4,parentObj.FZero=0==parentObj.registerB,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registerC=(15&parentObj.registerC)<<4|parentObj.registerC>>4,parentObj.FZero=0==parentObj.registerC,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registerD=(15&parentObj.registerD)<<4|parentObj.registerD>>4,parentObj.FZero=0==parentObj.registerD,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registerE=(15&parentObj.registerE)<<4|parentObj.registerE>>4,parentObj.FZero=0==parentObj.registerE,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registersHL=(3840&parentObj.registersHL)<<4|(61440&parentObj.registersHL)>>4|255&parentObj.registersHL,parentObj.FZero=parentObj.registersHL<256,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registersHL=65280&parentObj.registersHL|(15&parentObj.registersHL)<<4|(240&parentObj.registersHL)>>4,parentObj.FZero=0==(255&parentObj.registersHL),parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);temp_var=(15&temp_var)<<4|temp_var>>4,parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var),parentObj.FZero=0==temp_var,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.registerA=(15&parentObj.registerA)<<4|parentObj.registerA>>4,parentObj.FZero=0==parentObj.registerA,parentObj.FCarry=parentObj.FHalfCarry=parentObj.FSubtract=!1},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerB),parentObj.registerB>>=1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerB},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerC),parentObj.registerC>>=1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerC},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerD),parentObj.registerD>>=1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerD},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerE),parentObj.registerE>>=1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerE},function(parentObj){parentObj.FCarry=256==(256&parentObj.registersHL),parentObj.registersHL=parentObj.registersHL>>1&65280|255&parentObj.registersHL,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=parentObj.registersHL<256},function(parentObj){parentObj.FCarry=1==(1&parentObj.registersHL),parentObj.registersHL=65280&parentObj.registersHL|(255&parentObj.registersHL)>>1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==(255&parentObj.registersHL)},function(parentObj){var temp_var=parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL);parentObj.FCarry=1==(1&temp_var),parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,temp_var>>1),parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=2>temp_var},function(parentObj){parentObj.FCarry=1==(1&parentObj.registerA),parentObj.registerA>>=1,parentObj.FHalfCarry=parentObj.FSubtract=!1,parentObj.FZero=0==parentObj.registerA},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(256&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(512&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(1024&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(2048&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(4096&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(8192&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(16384&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(64&parentObj.registerA)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registerB)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registerC)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registerD)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registerE)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(32768&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registersHL)},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.FHalfCarry=!0,parentObj.FSubtract=!1,parentObj.FZero=0==(128&parentObj.registerA)},function(parentObj){parentObj.registerB&=254},function(parentObj){parentObj.registerC&=254},function(parentObj){parentObj.registerD&=254},function(parentObj){parentObj.registerE&=254},function(parentObj){parentObj.registersHL&=65279},function(parentObj){parentObj.registersHL&=65534},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,254&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=254},function(parentObj){parentObj.registerB&=253},function(parentObj){parentObj.registerC&=253},function(parentObj){parentObj.registerD&=253},function(parentObj){parentObj.registerE&=253},function(parentObj){parentObj.registersHL&=65023},function(parentObj){parentObj.registersHL&=65533},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,253&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=253},function(parentObj){parentObj.registerB&=251},function(parentObj){parentObj.registerC&=251},function(parentObj){parentObj.registerD&=251},function(parentObj){parentObj.registerE&=251},function(parentObj){parentObj.registersHL&=64511},function(parentObj){parentObj.registersHL&=65531},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,251&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=251},function(parentObj){parentObj.registerB&=247},function(parentObj){parentObj.registerC&=247},function(parentObj){parentObj.registerD&=247},function(parentObj){parentObj.registerE&=247},function(parentObj){parentObj.registersHL&=63487},function(parentObj){parentObj.registersHL&=65527},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,247&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=247},function(parentObj){parentObj.registerB&=239},function(parentObj){parentObj.registerC&=239},function(parentObj){parentObj.registerD&=239},function(parentObj){parentObj.registerE&=239},function(parentObj){parentObj.registersHL&=61439},function(parentObj){parentObj.registersHL&=65519},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,239&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=239},function(parentObj){parentObj.registerB&=223},function(parentObj){parentObj.registerC&=223},function(parentObj){parentObj.registerD&=223},function(parentObj){parentObj.registerE&=223},function(parentObj){parentObj.registersHL&=57343},function(parentObj){parentObj.registersHL&=65503},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,223&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=223},function(parentObj){parentObj.registerB&=191},function(parentObj){parentObj.registerC&=191},function(parentObj){parentObj.registerD&=191},function(parentObj){parentObj.registerE&=191},function(parentObj){parentObj.registersHL&=49151},function(parentObj){parentObj.registersHL&=65471},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,191&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=191},function(parentObj){parentObj.registerB&=127},function(parentObj){parentObj.registerC&=127},function(parentObj){parentObj.registerD&=127},function(parentObj){parentObj.registerE&=127},function(parentObj){parentObj.registersHL&=32767},function(parentObj){parentObj.registersHL&=65407},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,127&parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA&=127},function(parentObj){parentObj.registerB|=1},function(parentObj){parentObj.registerC|=1},function(parentObj){parentObj.registerD|=1},function(parentObj){parentObj.registerE|=1},function(parentObj){parentObj.registersHL|=256},function(parentObj){parentObj.registersHL|=1},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,1|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=1},function(parentObj){parentObj.registerB|=2},function(parentObj){parentObj.registerC|=2},function(parentObj){parentObj.registerD|=2},function(parentObj){parentObj.registerE|=2},function(parentObj){parentObj.registersHL|=512},function(parentObj){parentObj.registersHL|=2},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,2|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=2},function(parentObj){parentObj.registerB|=4},function(parentObj){parentObj.registerC|=4},function(parentObj){parentObj.registerD|=4},function(parentObj){parentObj.registerE|=4},function(parentObj){parentObj.registersHL|=1024},function(parentObj){parentObj.registersHL|=4},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,4|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=4},function(parentObj){parentObj.registerB|=8},function(parentObj){parentObj.registerC|=8},function(parentObj){parentObj.registerD|=8},function(parentObj){parentObj.registerE|=8},function(parentObj){parentObj.registersHL|=2048},function(parentObj){parentObj.registersHL|=8},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,8|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=8},function(parentObj){parentObj.registerB|=16},function(parentObj){parentObj.registerC|=16},function(parentObj){parentObj.registerD|=16},function(parentObj){parentObj.registerE|=16},function(parentObj){parentObj.registersHL|=4096},function(parentObj){parentObj.registersHL|=16},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,16|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=16},function(parentObj){parentObj.registerB|=32},function(parentObj){parentObj.registerC|=32},function(parentObj){parentObj.registerD|=32},function(parentObj){parentObj.registerE|=32},function(parentObj){parentObj.registersHL|=8192},function(parentObj){parentObj.registersHL|=32},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,32|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=32},function(parentObj){parentObj.registerB|=64},function(parentObj){parentObj.registerC|=64},function(parentObj){parentObj.registerD|=64},function(parentObj){parentObj.registerE|=64},function(parentObj){parentObj.registersHL|=16384},function(parentObj){parentObj.registersHL|=64},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,64|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=64},function(parentObj){parentObj.registerB|=128},function(parentObj){parentObj.registerC|=128},function(parentObj){parentObj.registerD|=128},function(parentObj){parentObj.registerE|=128},function(parentObj){parentObj.registersHL|=32768},function(parentObj){parentObj.registersHL|=128},function(parentObj){parentObj.memoryWriter[parentObj.registersHL](parentObj,parentObj.registersHL,128|parentObj.memoryReader[parentObj.registersHL](parentObj,parentObj.registersHL))},function(parentObj){parentObj.registerA|=128}],GameBoyCore.prototype.TICKTable=[4,12,8,8,4,4,8,4,20,8,8,8,4,4,8,4,4,12,8,8,4,4,8,4,12,8,8,8,4,4,8,4,8,12,8,8,4,4,8,4,8,8,8,8,4,4,8,4,8,12,8,8,12,12,12,4,8,8,8,8,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,8,8,8,8,8,8,4,8,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,4,4,4,4,4,4,8,4,8,12,12,16,12,16,8,16,8,16,12,0,12,24,8,16,8,12,12,4,12,16,8,16,8,16,12,4,12,4,8,16,12,12,8,4,4,16,8,16,16,4,16,4,4,4,8,16,12,12,8,4,4,16,8,16,12,8,16,4,0,4,8,16],GameBoyCore.prototype.SecondaryTICKTable=[8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8,8,8,8,8,8,8,16,8],GameBoyCore.prototype.saveSRAMState=function(){return this.cBATT&&0!=this.MBCRam.length?this.fromTypedArray(this.MBCRam):[]},GameBoyCore.prototype.saveRTCState=function(){return this.cTIMER?[this.lastIteration,this.RTCisLatched,this.latchedSeconds,this.latchedMinutes,this.latchedHours,this.latchedLDays,this.latchedHDays,this.RTCSeconds,this.RTCMinutes,this.RTCHours,this.RTCDays,this.RTCDayOverFlow,this.RTCHALT]:[]},GameBoyCore.prototype.saveState=function(){return[this.fromTypedArray(this.ROM),this.inBootstrap,this.registerA,this.FZero,this.FSubtract,this.FHalfCarry,this.FCarry,this.registerB,this.registerC,this.registerD,this.registerE,this.registersHL,this.stackPointer,this.programCounter,this.halt,this.IME,this.hdmaRunning,this.CPUTicks,this.doubleSpeedShifter,this.fromTypedArray(this.memory),this.fromTypedArray(this.MBCRam),this.fromTypedArray(this.VRAM),this.currVRAMBank,this.fromTypedArray(this.GBCMemory),this.MBC1Mode,this.MBCRAMBanksEnabled,this.currMBCRAMBank,this.currMBCRAMBankPosition,this.cGBC,this.gbcRamBank,this.gbcRamBankPosition,this.ROMBank1offs,this.currentROMBank,this.cartridgeType,this.name,this.gameCode,this.modeSTAT,this.LYCMatchTriggerSTAT,this.mode2TriggerSTAT,this.mode1TriggerSTAT,this.mode0TriggerSTAT,this.LCDisOn,this.gfxWindowCHRBankPosition,this.gfxWindowDisplay,this.gfxSpriteShow,this.gfxSpriteNormalHeight,this.gfxBackgroundCHRBankPosition,this.gfxBackgroundBankOffset,this.TIMAEnabled,this.DIVTicks,this.LCDTicks,this.timerTicks,this.TACClocker,this.serialTimer,this.serialShiftTimer,this.serialShiftTimerAllocated,this.IRQEnableDelay,this.lastIteration,this.cMBC1,this.cMBC2,this.cMBC3,this.cMBC5,this.cMBC7,this.cSRAM,this.cMMMO1,this.cRUMBLE,this.cCamera,this.cTAMA5,this.cHuC3,this.cHuC1,this.drewBlank,this.fromTypedArray(this.frameBuffer),this.bgEnabled,this.BGPriorityEnabled,this.channel1FrequencyTracker,this.channel1FrequencyCounter,this.channel1totalLength,this.channel1envelopeVolume,this.channel1envelopeType,this.channel1envelopeSweeps,this.channel1envelopeSweepsLast,this.channel1consecutive,this.channel1frequency,this.channel1SweepFault,this.channel1ShadowFrequency,this.channel1timeSweep,this.channel1lastTimeSweep,this.channel1Swept,this.channel1frequencySweepDivider,this.channel1decreaseSweep,this.channel2FrequencyTracker,this.channel2FrequencyCounter,this.channel2totalLength,this.channel2envelopeVolume,this.channel2envelopeType,this.channel2envelopeSweeps,this.channel2envelopeSweepsLast,this.channel2consecutive,this.channel2frequency,this.channel3canPlay,this.channel3totalLength,this.channel3patternType,this.channel3frequency,this.channel3consecutive,this.fromTypedArray(this.channel3PCM),this.channel4FrequencyPeriod,this.channel4lastSampleLookup,this.channel4totalLength,this.channel4envelopeVolume,this.channel4currentVolume,this.channel4envelopeType,this.channel4envelopeSweeps,this.channel4envelopeSweepsLast,this.channel4consecutive,this.channel4BitRange,this.soundMasterEnabled,this.VinLeftChannelMasterVolume,this.VinRightChannelMasterVolume,this.leftChannel1,this.leftChannel2,this.leftChannel3,this.leftChannel4,this.rightChannel1,this.rightChannel2,this.rightChannel3,this.rightChannel4,this.channel1currentSampleLeft,this.channel1currentSampleRight,this.channel2currentSampleLeft,this.channel2currentSampleRight,this.channel3currentSampleLeft,this.channel3currentSampleRight,this.channel4currentSampleLeft,this.channel4currentSampleRight,this.channel1currentSampleLeftSecondary,this.channel1currentSampleRightSecondary,this.channel2currentSampleLeftSecondary,this.channel2currentSampleRightSecondary,this.channel3currentSampleLeftSecondary,this.channel3currentSampleRightSecondary,this.channel4currentSampleLeftSecondary,this.channel4currentSampleRightSecondary,this.channel1currentSampleLeftTrimary,this.channel1currentSampleRightTrimary,this.channel2currentSampleLeftTrimary,this.channel2currentSampleRightTrimary,this.mixerOutputCache,this.channel1DutyTracker,this.channel1CachedDuty,this.channel2DutyTracker,this.channel2CachedDuty,this.channel1Enabled,this.channel2Enabled,this.channel3Enabled,this.channel4Enabled,this.sequencerClocks,this.sequencePosition,this.channel3Counter,this.channel4Counter,this.cachedChannel3Sample,this.cachedChannel4Sample,this.channel3FrequencyPeriod,this.channel3lastSampleLookup,this.actualScanLine,this.lastUnrenderedLine,this.queuedScanLines,this.RTCisLatched,this.latchedSeconds,this.latchedMinutes,this.latchedHours,this.latchedLDays,this.latchedHDays,this.RTCSeconds,this.RTCMinutes,this.RTCHours,this.RTCDays,this.RTCDayOverFlow,this.RTCHALT,this.usedBootROM,this.skipPCIncrement,this.STATTracker,this.gbcRamBankPositionECHO,this.numRAMBanks,this.windowY,this.windowX,this.fromTypedArray(this.gbcOBJRawPalette),this.fromTypedArray(this.gbcBGRawPalette),this.fromTypedArray(this.gbOBJPalette),this.fromTypedArray(this.gbBGPalette),this.fromTypedArray(this.gbcOBJPalette),this.fromTypedArray(this.gbcBGPalette),this.fromTypedArray(this.gbBGColorizedPalette),this.fromTypedArray(this.gbOBJColorizedPalette),this.fromTypedArray(this.cachedBGPaletteConversion),this.fromTypedArray(this.cachedOBJPaletteConversion),this.fromTypedArray(this.BGCHRBank1),this.fromTypedArray(this.BGCHRBank2),this.haltPostClocks,this.interruptsRequested,this.interruptsEnabled,this.remainingClocks,this.colorizedGBPalettes,this.backgroundY,this.backgroundX,this.CPUStopped,this.audioClocksUntilNextEvent,this.audioClocksUntilNextEventCounter]
},GameBoyCore.prototype.returnFromState=function(returnedFrom){var index=0,state=returnedFrom.slice(0);this.ROM=this.toTypedArray(state[index++],"uint8"),this.ROMBankEdge=Math.floor(this.ROM.length/16384),this.inBootstrap=state[index++],this.registerA=state[index++],this.FZero=state[index++],this.FSubtract=state[index++],this.FHalfCarry=state[index++],this.FCarry=state[index++],this.registerB=state[index++],this.registerC=state[index++],this.registerD=state[index++],this.registerE=state[index++],this.registersHL=state[index++],this.stackPointer=state[index++],this.programCounter=state[index++],this.halt=state[index++],this.IME=state[index++],this.hdmaRunning=state[index++],this.CPUTicks=state[index++],this.doubleSpeedShifter=state[index++],this.memory=this.toTypedArray(state[index++],"uint8"),this.MBCRam=this.toTypedArray(state[index++],"uint8"),this.VRAM=this.toTypedArray(state[index++],"uint8"),this.currVRAMBank=state[index++],this.GBCMemory=this.toTypedArray(state[index++],"uint8"),this.MBC1Mode=state[index++],this.MBCRAMBanksEnabled=state[index++],this.currMBCRAMBank=state[index++],this.currMBCRAMBankPosition=state[index++],this.cGBC=state[index++],this.gbcRamBank=state[index++],this.gbcRamBankPosition=state[index++],this.ROMBank1offs=state[index++],this.currentROMBank=state[index++],this.cartridgeType=state[index++],this.name=state[index++],this.gameCode=state[index++],this.modeSTAT=state[index++],this.LYCMatchTriggerSTAT=state[index++],this.mode2TriggerSTAT=state[index++],this.mode1TriggerSTAT=state[index++],this.mode0TriggerSTAT=state[index++],this.LCDisOn=state[index++],this.gfxWindowCHRBankPosition=state[index++],this.gfxWindowDisplay=state[index++],this.gfxSpriteShow=state[index++],this.gfxSpriteNormalHeight=state[index++],this.gfxBackgroundCHRBankPosition=state[index++],this.gfxBackgroundBankOffset=state[index++],this.TIMAEnabled=state[index++],this.DIVTicks=state[index++],this.LCDTicks=state[index++],this.timerTicks=state[index++],this.TACClocker=state[index++],this.serialTimer=state[index++],this.serialShiftTimer=state[index++],this.serialShiftTimerAllocated=state[index++],this.IRQEnableDelay=state[index++],this.lastIteration=state[index++],this.cMBC1=state[index++],this.cMBC2=state[index++],this.cMBC3=state[index++],this.cMBC5=state[index++],this.cMBC7=state[index++],this.cSRAM=state[index++],this.cMMMO1=state[index++],this.cRUMBLE=state[index++],this.cCamera=state[index++],this.cTAMA5=state[index++],this.cHuC3=state[index++],this.cHuC1=state[index++],this.drewBlank=state[index++],this.frameBuffer=this.toTypedArray(state[index++],"int32"),this.bgEnabled=state[index++],this.BGPriorityEnabled=state[index++],this.channel1FrequencyTracker=state[index++],this.channel1FrequencyCounter=state[index++],this.channel1totalLength=state[index++],this.channel1envelopeVolume=state[index++],this.channel1envelopeType=state[index++],this.channel1envelopeSweeps=state[index++],this.channel1envelopeSweepsLast=state[index++],this.channel1consecutive=state[index++],this.channel1frequency=state[index++],this.channel1SweepFault=state[index++],this.channel1ShadowFrequency=state[index++],this.channel1timeSweep=state[index++],this.channel1lastTimeSweep=state[index++],this.channel1Swept=state[index++],this.channel1frequencySweepDivider=state[index++],this.channel1decreaseSweep=state[index++],this.channel2FrequencyTracker=state[index++],this.channel2FrequencyCounter=state[index++],this.channel2totalLength=state[index++],this.channel2envelopeVolume=state[index++],this.channel2envelopeType=state[index++],this.channel2envelopeSweeps=state[index++],this.channel2envelopeSweepsLast=state[index++],this.channel2consecutive=state[index++],this.channel2frequency=state[index++],this.channel3canPlay=state[index++],this.channel3totalLength=state[index++],this.channel3patternType=state[index++],this.channel3frequency=state[index++],this.channel3consecutive=state[index++],this.channel3PCM=this.toTypedArray(state[index++],"int8"),this.channel4FrequencyPeriod=state[index++],this.channel4lastSampleLookup=state[index++],this.channel4totalLength=state[index++],this.channel4envelopeVolume=state[index++],this.channel4currentVolume=state[index++],this.channel4envelopeType=state[index++],this.channel4envelopeSweeps=state[index++],this.channel4envelopeSweepsLast=state[index++],this.channel4consecutive=state[index++],this.channel4BitRange=state[index++],this.soundMasterEnabled=state[index++],this.VinLeftChannelMasterVolume=state[index++],this.VinRightChannelMasterVolume=state[index++],this.leftChannel1=state[index++],this.leftChannel2=state[index++],this.leftChannel3=state[index++],this.leftChannel4=state[index++],this.rightChannel1=state[index++],this.rightChannel2=state[index++],this.rightChannel3=state[index++],this.rightChannel4=state[index++],this.channel1currentSampleLeft=state[index++],this.channel1currentSampleRight=state[index++],this.channel2currentSampleLeft=state[index++],this.channel2currentSampleRight=state[index++],this.channel3currentSampleLeft=state[index++],this.channel3currentSampleRight=state[index++],this.channel4currentSampleLeft=state[index++],this.channel4currentSampleRight=state[index++],this.channel1currentSampleLeftSecondary=state[index++],this.channel1currentSampleRightSecondary=state[index++],this.channel2currentSampleLeftSecondary=state[index++],this.channel2currentSampleRightSecondary=state[index++],this.channel3currentSampleLeftSecondary=state[index++],this.channel3currentSampleRightSecondary=state[index++],this.channel4currentSampleLeftSecondary=state[index++],this.channel4currentSampleRightSecondary=state[index++],this.channel1currentSampleLeftTrimary=state[index++],this.channel1currentSampleRightTrimary=state[index++],this.channel2currentSampleLeftTrimary=state[index++],this.channel2currentSampleRightTrimary=state[index++],this.mixerOutputCache=state[index++],this.channel1DutyTracker=state[index++],this.channel1CachedDuty=state[index++],this.channel2DutyTracker=state[index++],this.channel2CachedDuty=state[index++],this.channel1Enabled=state[index++],this.channel2Enabled=state[index++],this.channel3Enabled=state[index++],this.channel4Enabled=state[index++],this.sequencerClocks=state[index++],this.sequencePosition=state[index++],this.channel3Counter=state[index++],this.channel4Counter=state[index++],this.cachedChannel3Sample=state[index++],this.cachedChannel4Sample=state[index++],this.channel3FrequencyPeriod=state[index++],this.channel3lastSampleLookup=state[index++],this.actualScanLine=state[index++],this.lastUnrenderedLine=state[index++],this.queuedScanLines=state[index++],this.RTCisLatched=state[index++],this.latchedSeconds=state[index++],this.latchedMinutes=state[index++],this.latchedHours=state[index++],this.latchedLDays=state[index++],this.latchedHDays=state[index++],this.RTCSeconds=state[index++],this.RTCMinutes=state[index++],this.RTCHours=state[index++],this.RTCDays=state[index++],this.RTCDayOverFlow=state[index++],this.RTCHALT=state[index++],this.usedBootROM=state[index++],this.skipPCIncrement=state[index++],this.STATTracker=state[index++],this.gbcRamBankPositionECHO=state[index++],this.numRAMBanks=state[index++],this.windowY=state[index++],this.windowX=state[index++],this.gbcOBJRawPalette=this.toTypedArray(state[index++],"uint8"),this.gbcBGRawPalette=this.toTypedArray(state[index++],"uint8"),this.gbOBJPalette=this.toTypedArray(state[index++],"int32"),this.gbBGPalette=this.toTypedArray(state[index++],"int32"),this.gbcOBJPalette=this.toTypedArray(state[index++],"int32"),this.gbcBGPalette=this.toTypedArray(state[index++],"int32"),this.gbBGColorizedPalette=this.toTypedArray(state[index++],"int32"),this.gbOBJColorizedPalette=this.toTypedArray(state[index++],"int32"),this.cachedBGPaletteConversion=this.toTypedArray(state[index++],"int32"),this.cachedOBJPaletteConversion=this.toTypedArray(state[index++],"int32"),this.BGCHRBank1=this.toTypedArray(state[index++],"uint8"),this.BGCHRBank2=this.toTypedArray(state[index++],"uint8"),this.haltPostClocks=state[index++],this.interruptsRequested=state[index++],this.interruptsEnabled=state[index++],this.checkIRQMatching(),this.remainingClocks=state[index++],this.colorizedGBPalettes=state[index++],this.backgroundY=state[index++],this.backgroundX=state[index++],this.CPUStopped=state[index++],this.audioClocksUntilNextEvent=state[index++],this.audioClocksUntilNextEventCounter=state[index],this.fromSaveState=!0,this.TICKTable=this.toTypedArray(this.TICKTable,"uint8"),this.SecondaryTICKTable=this.toTypedArray(this.SecondaryTICKTable,"uint8"),this.initializeReferencesFromSaveState(),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile(),this.initLCD(),this.initSound(),this.noiseSampleTable=32767==this.channel4BitRange?this.LSFR15Table:this.LSFR7Table,this.channel4VolumeShifter=32767==this.channel4BitRange?15:7},GameBoyCore.prototype.returnFromRTCState=function(){if("function"==typeof this.openRTC&&this.cTIMER){var rtcData=this.openRTC(this.name),index=0;this.lastIteration=rtcData[index++],this.RTCisLatched=rtcData[index++],this.latchedSeconds=rtcData[index++],this.latchedMinutes=rtcData[index++],this.latchedHours=rtcData[index++],this.latchedLDays=rtcData[index++],this.latchedHDays=rtcData[index++],this.RTCSeconds=rtcData[index++],this.RTCMinutes=rtcData[index++],this.RTCHours=rtcData[index++],this.RTCDays=rtcData[index++],this.RTCDayOverFlow=rtcData[index++],this.RTCHALT=rtcData[index]}},GameBoyCore.prototype.start=function(){this.initMemory(),this.ROMLoad(),this.initLCD(),this.initSound(),this.run()},GameBoyCore.prototype.initMemory=function(){this.memory=this.getTypedArray(65536,0,"uint8"),this.frameBuffer=this.getTypedArray(23040,16316664,"int32"),this.BGCHRBank1=this.getTypedArray(2048,0,"uint8"),this.TICKTable=this.toTypedArray(this.TICKTable,"uint8"),this.SecondaryTICKTable=this.toTypedArray(this.SecondaryTICKTable,"uint8"),this.channel3PCM=this.getTypedArray(32,0,"int8")},GameBoyCore.prototype.generateCacheArray=function(tileAmount){for(var tileArray=[],tileNumber=0;tileAmount>tileNumber;)tileArray[tileNumber++]=this.getTypedArray(64,0,"uint8");return tileArray},GameBoyCore.prototype.initSkipBootstrap=function(){for(var index=255;index>=0;){if(index>=48&&64>index)this.memoryWrite(65280|index,this.ffxxDump[index]);else switch(index){case 0:case 1:case 2:case 5:case 7:case 15:case 255:this.memoryWrite(65280|index,this.ffxxDump[index]);break;default:this.memory[65280|index]=this.ffxxDump[index]}--index}this.cGBC?(this.memory[65388]=254,this.memory[65396]=254):(this.memory[65352]=255,this.memory[65353]=255,this.memory[65388]=255,this.memory[65396]=255),debug("Starting without the GBC boot ROM.",0),this.registerA=this.cGBC?17:1,this.registerB=0,this.registerC=19,this.registerD=0,this.registerE=216,this.FZero=!0,this.FSubtract=!1,this.FHalfCarry=!0,this.FCarry=!0,this.registersHL=333,this.LCDCONTROL=this.LINECONTROL,this.IME=!1,this.IRQLineMatched=0,this.interruptsRequested=225,this.interruptsEnabled=0,this.hdmaRunning=!1,this.CPUTicks=12,this.STATTracker=0,this.modeSTAT=1,this.spriteCount=252,this.LYCMatchTriggerSTAT=!1,this.mode2TriggerSTAT=!1,this.mode1TriggerSTAT=!1,this.mode0TriggerSTAT=!1,this.LCDisOn=!0,this.channel1FrequencyTracker=8192,this.channel1DutyTracker=0,this.channel1CachedDuty=this.dutyLookup[2],this.channel1totalLength=0,this.channel1envelopeVolume=0,this.channel1envelopeType=!1,this.channel1envelopeSweeps=0,this.channel1envelopeSweepsLast=0,this.channel1consecutive=!0,this.channel1frequency=1985,this.channel1SweepFault=!0,this.channel1ShadowFrequency=1985,this.channel1timeSweep=1,this.channel1lastTimeSweep=0,this.channel1Swept=!1,this.channel1frequencySweepDivider=0,this.channel1decreaseSweep=!1,this.channel2FrequencyTracker=8192,this.channel2DutyTracker=0,this.channel2CachedDuty=this.dutyLookup[2],this.channel2totalLength=0,this.channel2envelopeVolume=0,this.channel2envelopeType=!1,this.channel2envelopeSweeps=0,this.channel2envelopeSweepsLast=0,this.channel2consecutive=!0,this.channel2frequency=0,this.channel3canPlay=!1,this.channel3totalLength=0,this.channel3patternType=4,this.channel3frequency=0,this.channel3consecutive=!0,this.channel3Counter=1048,this.channel4FrequencyPeriod=8,this.channel4totalLength=0,this.channel4envelopeVolume=0,this.channel4currentVolume=0,this.channel4envelopeType=!1,this.channel4envelopeSweeps=0,this.channel4envelopeSweepsLast=0,this.channel4consecutive=!0,this.channel4BitRange=32767,this.channel4VolumeShifter=15,this.channel1FrequencyCounter=512,this.channel2FrequencyCounter=512,this.channel3Counter=2048,this.channel3FrequencyPeriod=2048,this.channel3lastSampleLookup=0,this.channel4lastSampleLookup=0,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.soundMasterEnabled=!0,this.leftChannel1=!0,this.leftChannel2=!0,this.leftChannel3=!0,this.leftChannel4=!0,this.rightChannel1=!0,this.rightChannel2=!0,this.rightChannel3=!1,this.rightChannel4=!1,this.DIVTicks=27044,this.LCDTicks=160,this.timerTicks=0,this.TIMAEnabled=!1,this.TACClocker=1024,this.serialTimer=0,this.serialShiftTimer=0,this.serialShiftTimerAllocated=0,this.IRQEnableDelay=0,this.actualScanLine=144,this.lastUnrenderedLine=0,this.gfxWindowDisplay=!1,this.gfxSpriteShow=!1,this.gfxSpriteNormalHeight=!0,this.bgEnabled=!0,this.BGPriorityEnabled=!0,this.gfxWindowCHRBankPosition=0,this.gfxBackgroundCHRBankPosition=0,this.gfxBackgroundBankOffset=0,this.windowY=0,this.windowX=0,this.drewBlank=0,this.midScanlineOffset=-1,this.currentX=0},GameBoyCore.prototype.initBootstrap=function(){debug("Starting the selected boot ROM.",0),this.programCounter=0,this.stackPointer=0,this.IME=!1,this.LCDTicks=0,this.DIVTicks=0,this.registerA=0,this.registerB=0,this.registerC=0,this.registerD=0,this.registerE=0,this.FZero=this.FSubtract=this.FHalfCarry=this.FCarry=!1,this.registersHL=0,this.leftChannel1=!1,this.leftChannel2=!1,this.leftChannel3=!1,this.leftChannel4=!1,this.rightChannel1=!1,this.rightChannel2=!1,this.rightChannel3=!1,this.rightChannel4=!1,this.channel2frequency=this.channel1frequency=0,this.channel4consecutive=this.channel2consecutive=this.channel1consecutive=!1,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.memory[65280]=15},GameBoyCore.prototype.ROMLoad=function(){this.ROM=[],this.usedBootROM=this.opts.bootRom&&(!this.opts.gbBootRom&&2048==this.GBCBOOTROM.length||this.opts.gbBootRom&&256==this.GBBOOTROM.length);var maxLength=this.ROMImage.length;if(16384>maxLength)throw new Error("ROM image size too small.");this.ROM=this.getTypedArray(maxLength,0,"uint8");var romIndex=0;if(this.usedBootROM){if(this.opts.gbBootRom)if(this.ROMImageIsString)for(;256>romIndex;++romIndex)this.memory[romIndex]=this.GBBOOTROM[romIndex],this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);else for(;256>romIndex;++romIndex)this.memory[romIndex]=this.GBBOOTROM[romIndex],this.ROM[romIndex]=this.ROMImage.romIndex;else{if(this.ROMImageIsString){for(;256>romIndex;++romIndex)this.memory[romIndex]=this.GBCBOOTROM[romIndex],this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);for(;512>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);for(;2304>romIndex;++romIndex)this.memory[romIndex]=this.GBCBOOTROM[romIndex-256],this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex)}else{for(;256>romIndex;++romIndex)this.memory[romIndex]=this.GBCBOOTROM[romIndex],this.ROM[romIndex]=this.ROMImage[romIndex];for(;512>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=this.ROMImage[romIndex];for(;2304>romIndex;++romIndex)this.memory[romIndex]=this.GBCBOOTROM[romIndex-256],this.ROM[romIndex]=this.ROMImage[romIndex]}this.usedGBCBootROM=!0}if(this.ROMImageIsString)for(;16384>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);else for(;16384>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=this.ROMImage[romIndex]}else if(this.ROMImageIsString)for(;16384>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);else for(;16384>romIndex;++romIndex)this.memory[romIndex]=this.ROM[romIndex]=this.ROMImage[romIndex];if(this.ROMImageIsString)for(;maxLength>romIndex;++romIndex)this.ROM[romIndex]=255&this.ROMImage.charCodeAt(romIndex);else for(;maxLength>romIndex;++romIndex)this.ROM[romIndex]=this.ROMImage[romIndex];this.ROMBankEdge=Math.floor(this.ROM.length/16384),this.interpretCartridge(),this.checkIRQMatching()},GameBoyCore.prototype.getROMImage=function(){if(this.ROMImage.length>0)return this.ROMImage.length;for(var length=this.ROM.length,index=0;length>index;index++)this.ROMImage+=String.fromCharCode(this.ROM[index]);return this.ROMImage},GameBoyCore.prototype.interpretCartridge=function(){var extra;if(this.ROMImageIsString){for(var index=308;319>index;index++)this.ROMImage[index]>0&&(this.name+=this.ROMImage[index]);for(var index=319;323>index;index++)this.ROMImage[index]>0&&(this.gameCode+=this.ROMImage[index]);extra=this.ROMImage[323]}else{for(var index=308;319>index;index++)this.ROMImage[index]>0&&(this.name+=String.fromCharCode(this.ROMImage[index]));for(var index=319;323>index;index++)this.ROMImage[index]>0&&(this.gameCode+=String.fromCharCode(this.ROMImage[index]));extra=String.fromCharCode(this.ROMImage[323])}debug("Game Title: "+this.name+"["+this.gameCode+"]["+extra+"]",0),debug("Game Code: "+this.gameCode,0),this.cartridgeType=this.ROM[327],debug("Cartridge type #"+this.cartridgeType,0);var MBCType="";switch(this.cartridgeType){case 0:if(!this.opts.mbc1){MBCType="ROM";break}case 1:this.cMBC1=!0,MBCType="MBC1";break;case 2:this.cMBC1=!0,this.cSRAM=!0,MBCType="MBC1 + SRAM";break;case 3:this.cMBC1=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="MBC1 + SRAM + BATT";break;case 5:this.cMBC2=!0,MBCType="MBC2";break;case 6:this.cMBC2=!0,this.cBATT=!0,MBCType="MBC2 + BATT";break;case 8:this.cSRAM=!0,MBCType="ROM + SRAM";break;case 9:this.cSRAM=!0,this.cBATT=!0,MBCType="ROM + SRAM + BATT";break;case 11:this.cMMMO1=!0,MBCType="MMMO1";break;case 12:this.cMMMO1=!0,this.cSRAM=!0,MBCType="MMMO1 + SRAM";break;case 13:this.cMMMO1=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="MMMO1 + SRAM + BATT";break;case 15:this.cMBC3=!0,this.cTIMER=!0,this.cBATT=!0,MBCType="MBC3 + TIMER + BATT";break;case 16:this.cMBC3=!0,this.cTIMER=!0,this.cBATT=!0,this.cSRAM=!0,MBCType="MBC3 + TIMER + BATT + SRAM";break;case 17:this.cMBC3=!0,MBCType="MBC3";break;case 18:this.cMBC3=!0,this.cSRAM=!0,MBCType="MBC3 + SRAM";break;case 19:this.cMBC3=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="MBC3 + SRAM + BATT";break;case 25:this.cMBC5=!0,MBCType="MBC5";break;case 26:this.cMBC5=!0,this.cSRAM=!0,MBCType="MBC5 + SRAM";break;case 27:this.cMBC5=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="MBC5 + SRAM + BATT";break;case 28:this.cRUMBLE=!0,MBCType="RUMBLE";break;case 29:this.cRUMBLE=!0,this.cSRAM=!0,MBCType="RUMBLE + SRAM";break;case 30:this.cRUMBLE=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="RUMBLE + SRAM + BATT";break;case 31:this.cCamera=!0,MBCType="GameBoy Camera";break;case 34:this.cMBC7=!0,this.cSRAM=!0,this.cBATT=!0,MBCType="MBC7 + SRAM + BATT";break;case 253:this.cTAMA5=!0,MBCType="TAMA5";break;case 254:this.cHuC3=!0,MBCType="HuC3";break;case 255:this.cHuC1=!0,MBCType="HuC1";break;default:MBCType="Unknown",this.emit("error",new Error("Cartridge type is unknown."))}switch(debug("Cartridge Type: "+MBCType+".",0),this.numROMBanks=this.ROMBanks[this.ROM[328]],debug(this.numROMBanks+" ROM banks.",0),this.RAMBanks[this.ROM[329]]){case 0:debug("No RAM banking requested for allocation or MBC is of type 2.",0);break;case 2:debug("1 RAM bank requested for allocation.",0);break;case 3:debug("4 RAM banks requested for allocation.",0);break;case 4:debug("16 RAM banks requested for allocation.",0);break;default:debug("RAM bank amount requested is unknown, will use maximum allowed by specified MBC type.",0)}if(this.usedBootROM)this.cGBC=this.usedGBCBootROM,this.setupRAM(),this.initBootstrap();else{switch(this.ROM[323]){case 0:this.cGBC=!1,debug("Only GB mode detected.",0);break;case 50:this.opts.prioritizeGb||this.name+this.gameCode+this.ROM[323]!="Game and Watch 50"?this.cGBC=!1:(this.cGBC=!0,debug("Created a boot exception for Game and Watch Gallery 2 (GBC ID byte is wrong on the cartridge).",1));break;case 128:this.cGBC=!this.opts.prioritizeGb,debug("GB and GBC mode detected.",0);break;case 192:this.cGBC=!0,debug("Only GBC mode detected.",0);break;default:this.cGBC=!1,debug("Unknown GameBoy game type code #"+this.ROM[323]+", defaulting to GB mode (Old games don't have a type code).",1)}this.inBootstrap=!1,this.setupRAM(),this.initSkipBootstrap()}this.initializeModeSpecificArrays();var cOldLicense=this.ROM[331],cNewLicense=65280&this.ROM[324]|255&this.ROM[325];51!=cOldLicense?debug("Old style license code: "+cOldLicense,0):debug("New style license code: "+cNewLicense,0),this.ROMImage=""},GameBoyCore.prototype.disableBootROM=function(){for(var index=0;256>index;++index)this.memory[index]=this.ROM[index];if(this.usedGBCBootROM){for(index=512;2304>index;++index)this.memory[index]=this.ROM[index];this.cGBC?this.recompileBootIOWriteHandling():this.GBCtoGBModeAdjust()}else this.recompileBootIOWriteHandling()},GameBoyCore.prototype.initializeTiming=function(){this.clocksPerSecond=4194304*this.emulatorSpeed,this.baseCPUCyclesPerIteration=this.clocksPerSecond/1e3*this.opts.interval,this.CPUCyclesTotalRoundoff=this.baseCPUCyclesPerIteration%4,this.CPUCyclesTotalBase=this.CPUCyclesTotal=this.baseCPUCyclesPerIteration-this.CPUCyclesTotalRoundoff|0,this.CPUCyclesTotalCurrent=0},GameBoyCore.prototype.setSpeed=function(speed){this.emulatorSpeed=speed,this.initializeTiming(),this.audioHandle&&this.initSound()},GameBoyCore.prototype.setupRAM=function(){if(this.cMBC2?this.numRAMBanks=1/16:this.cMBC1||this.cRUMBLE||this.cMBC3||this.cHuC3?this.numRAMBanks=4:this.cMBC5?this.numRAMBanks=16:this.cSRAM&&(this.numRAMBanks=1),this.numRAMBanks>0){this.MBCRAMUtilized()||(this.MBCRAMBanksEnabled=!0);var MBCRam="function"==typeof this.openMBC?this.openMBC(this.name):[];this.MBCRam=MBCRam.length>0?this.toTypedArray(MBCRam,"uint8"):this.getTypedArray(8192*this.numRAMBanks,0,"uint8")}debug("Actual bytes of MBC RAM allocated: "+8192*this.numRAMBanks,0),this.returnFromRTCState(),this.cGBC&&(this.VRAM=this.getTypedArray(8192,0,"uint8"),this.GBCMemory=this.getTypedArray(28672,0,"uint8")),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile()},GameBoyCore.prototype.MBCRAMUtilized=function(){return this.cMBC1||this.cMBC2||this.cMBC3||this.cMBC5||this.cMBC7||this.cRUMBLE},GameBoyCore.prototype.recomputeDimension=function(){this.onscreenWidth=this.canvas.width,this.onscreenHeight=this.canvas.height,"undefined"!=typeof window&&window.mozRequestAnimationFrame?(this.canvas.width=this.onscreenWidth=160,this.canvas.height=this.onscreenHeight=144):(this.onscreenWidth=this.canvas.width,this.onscreenHeight=this.canvas.height),this.offscreenWidth=160,this.offscreenHeight=144,this.offscreenRGBCount=this.offscreenWidth*this.offscreenHeight*4},GameBoyCore.prototype.initLCD=function(){if(this.recomputeDimension(),this.resizer=null,"undefined"!=typeof document&&document.createElement)this.canvasOffscreen=document.createElement("canvas"),this.canvasOffscreen.width=this.offscreenWidth,this.canvasOffscreen.height=this.offscreenHeight;else{var ctor=this.canvas.constructor;this.canvasOffscreen=new ctor(this.offscreenWidth,this.offscreenHeight)}this.drawContextOffscreen=this.canvasOffscreen.getContext("2d"),this.drawContextOnscreen=this.canvas.getContext("2d"),this.canvas.setAttribute&&this.canvas.setAttribute("style",(this.canvas.getAttribute("style")||"")+"; image-rendering: "+(this.opts.imageSmoothing?"auto":"-webkit-optimize-contrast")+";image-rendering: "+(this.opts.imageSmoothing?"optimizeQuality":"-o-crisp-edges")+";image-rendering: "+(this.opts.imageSmoothing?"optimizeQuality":"-moz-crisp-edges")+";-ms-interpolation-mode: "+(this.opts.imageSmoothing?"bicubic":"nearest-neighbor")+";"),this.drawContextOffscreen.webkitImageSmoothingEnabled=this.opts.imageSmoothing,this.drawContextOffscreen.mozImageSmoothingEnabled=this.opts.imageSmoothing,this.drawContextOnscreen.webkitImageSmoothingEnabled=this.opts.imageSmoothing,this.drawContextOnscreen.mozImageSmoothingEnabled=this.opts.imageSmoothing;try{this.canvasBuffer=this.drawContextOffscreen.createImageData(this.offscreenWidth,this.offscreenHeight)}catch(error){debug('Falling back to the getImageData initialization (Error "'+error.message+'").',1),this.canvasBuffer=this.drawContextOffscreen.getImageData(0,0,this.offscreenWidth,this.offscreenHeight)}for(var index=this.offscreenRGBCount;index>0;)this.canvasBuffer.data[index-=4]=248,this.canvasBuffer.data[index+1]=248,this.canvasBuffer.data[index+2]=248,this.canvasBuffer.data[index+3]=255;this.graphicsBlit(),this.canvas.style&&(this.canvas.style.visibility="visible"),null==this.swizzledFrame&&(this.swizzledFrame=this.getTypedArray(69120,255,"uint8")),this.drewFrame=!0,this.requestDraw()},GameBoyCore.prototype.graphicsBlit=function(){this.offscreenWidth==this.onscreenWidth&&this.offscreenHeight==this.onscreenHeight?this.drawContextOnscreen.putImageData(this.canvasBuffer,0,0):(this.drawContextOffscreen.putImageData(this.canvasBuffer,0,0),this.drawContextOnscreen.drawImage(this.canvasOffscreen,0,0,this.onscreenWidth,this.onscreenHeight))},GameBoyCore.prototype.JoyPadEvent=function(key,down){down?(this.JoyPad&=255^1<<key,this.cGBC||this.usedBootROM&&this.usedGBCBootROM||(this.interruptsRequested|=16,this.remainingClocks=0,this.checkIRQMatching())):this.JoyPad|=1<<key,this.memory[65280]=(48&this.memory[65280])+((0==(32&this.memory[65280])?this.JoyPad>>4:15)&(0==(16&this.memory[65280])?15&this.JoyPad:15)),this.CPUStopped=!1},GameBoyCore.prototype.GyroEvent=function(x,y){x*=-100,x+=2047,this.highX=x>>8,this.lowX=255&x,y*=-100,y+=2047,this.highY=y>>8,this.lowY=255&y},GameBoyCore.prototype.initSound=function(){if(this.audioResamplerFirstPassFactor=Math.max(Math.min(Math.floor(this.clocksPerSecond/44100),Math.floor(136.53125)),1),this.downSampleInputDivider=1/(240*this.audioResamplerFirstPassFactor),this.opts.sound){var self=this;this.audioHandle=new this.opts.sound(2,this.clocksPerSecond/this.audioResamplerFirstPassFactor,0,Math.max(this.baseCPUCyclesPerIteration*this.opts.audioBufferMax/this.audioResamplerFirstPassFactor,8192)<<1,null,this.opts.volume,function(){self.opts.sound=!1}),this.initAudioBuffer()}else this.audioHandle&&this.audioHandle.changeVolume(0)},GameBoyCore.prototype.changeVolume=function(){this.opts.sound&&this.audioHandle&&this.audioHandle.changeVolume(this.opts.volume)},GameBoyCore.prototype.initAudioBuffer=function(){this.audioIndex=0,this.audioDestinationPosition=0,this.downsampleInput=0,this.bufferContainAmount=Math.max(this.baseCPUCyclesPerIteration*this.opts.audioBufferMin/this.audioResamplerFirstPassFactor,4096)<<1,this.numSamplesTotal=this.baseCPUCyclesPerIteration/this.audioResamplerFirstPassFactor<<1,this.audioBuffer=this.getTypedArray(this.numSamplesTotal,0,"float32")},GameBoyCore.prototype.intializeWhiteNoise=function(){var randomFactor=1;this.LSFR15Table=this.getTypedArray(524288,0,"int8");for(var LSFR=32767,LSFRShifted=16383,index=0;32768>index;++index)randomFactor=1-(1&LSFR),this.LSFR15Table[32768|index]=randomFactor,this.LSFR15Table[65536|index]=2*randomFactor,this.LSFR15Table[98304|index]=3*randomFactor,this.LSFR15Table[131072|index]=4*randomFactor,this.LSFR15Table[163840|index]=5*randomFactor,this.LSFR15Table[196608|index]=6*randomFactor,this.LSFR15Table[229376|index]=7*randomFactor,this.LSFR15Table[262144|index]=8*randomFactor,this.LSFR15Table[294912|index]=9*randomFactor,this.LSFR15Table[327680|index]=10*randomFactor,this.LSFR15Table[360448|index]=11*randomFactor,this.LSFR15Table[393216|index]=12*randomFactor,this.LSFR15Table[425984|index]=13*randomFactor,this.LSFR15Table[458752|index]=14*randomFactor,this.LSFR15Table[491520|index]=15*randomFactor,LSFRShifted=LSFR>>1,LSFR=LSFRShifted|(1&(LSFRShifted^LSFR))<<14;for(this.LSFR7Table=this.getTypedArray(2048,0,"int8"),LSFR=127,index=0;128>index;++index)randomFactor=1-(1&LSFR),this.LSFR7Table[128|index]=randomFactor,this.LSFR7Table[256|index]=2*randomFactor,this.LSFR7Table[384|index]=3*randomFactor,this.LSFR7Table[512|index]=4*randomFactor,this.LSFR7Table[640|index]=5*randomFactor,this.LSFR7Table[768|index]=6*randomFactor,this.LSFR7Table[896|index]=7*randomFactor,this.LSFR7Table[1024|index]=8*randomFactor,this.LSFR7Table[1152|index]=9*randomFactor,this.LSFR7Table[1280|index]=10*randomFactor,this.LSFR7Table[1408|index]=11*randomFactor,this.LSFR7Table[1536|index]=12*randomFactor,this.LSFR7Table[1664|index]=13*randomFactor,this.LSFR7Table[1792|index]=14*randomFactor,this.LSFR7Table[1920|index]=15*randomFactor,LSFRShifted=LSFR>>1,LSFR=LSFRShifted|(1&(LSFRShifted^LSFR))<<6;this.noiseSampleTable=this.LSFR15Table},GameBoyCore.prototype.audioUnderrunAdjustment=function(){if(this.opts.sound){var underrunAmount=this.audioHandle.remainingBuffer();"number"==typeof underrunAmount&&(underrunAmount=this.bufferContainAmount-Math.max(underrunAmount,0),underrunAmount>0&&this.recalculateIterationClockLimitForAudio((underrunAmount>>1)*this.audioResamplerFirstPassFactor))}},GameBoyCore.prototype.initializeAudioStartState=function(){this.channel1FrequencyTracker=8192,this.channel1DutyTracker=0,this.channel1CachedDuty=this.dutyLookup[2],this.channel1totalLength=0,this.channel1envelopeVolume=0,this.channel1envelopeType=!1,this.channel1envelopeSweeps=0,this.channel1envelopeSweepsLast=0,this.channel1consecutive=!0,this.channel1frequency=0,this.channel1SweepFault=!1,this.channel1ShadowFrequency=0,this.channel1timeSweep=1,this.channel1lastTimeSweep=0,this.channel1Swept=!1,this.channel1frequencySweepDivider=0,this.channel1decreaseSweep=!1,this.channel2FrequencyTracker=8192,this.channel2DutyTracker=0,this.channel2CachedDuty=this.dutyLookup[2],this.channel2totalLength=0,this.channel2envelopeVolume=0,this.channel2envelopeType=!1,this.channel2envelopeSweeps=0,this.channel2envelopeSweepsLast=0,this.channel2consecutive=!0,this.channel2frequency=0,this.channel3canPlay=!1,this.channel3totalLength=0,this.channel3patternType=4,this.channel3frequency=0,this.channel3consecutive=!0,this.channel3Counter=2048,this.channel4FrequencyPeriod=8,this.channel4totalLength=0,this.channel4envelopeVolume=0,this.channel4currentVolume=0,this.channel4envelopeType=!1,this.channel4envelopeSweeps=0,this.channel4envelopeSweepsLast=0,this.channel4consecutive=!0,this.channel4BitRange=32767,this.noiseSampleTable=this.LSFR15Table,this.channel4VolumeShifter=15,this.channel1FrequencyCounter=8192,this.channel2FrequencyCounter=8192,this.channel3Counter=2048,this.channel3FrequencyPeriod=2048,this.channel3lastSampleLookup=0,this.channel4lastSampleLookup=0,this.VinLeftChannelMasterVolume=8,this.VinRightChannelMasterVolume=8,this.mixerOutputCache=0,this.sequencerClocks=8192,this.sequencePosition=0,this.channel4FrequencyPeriod=8,this.channel4Counter=8,this.cachedChannel3Sample=0,this.cachedChannel4Sample=0,this.channel1Enabled=!1,this.channel2Enabled=!1,this.channel3Enabled=!1,this.channel4Enabled=!1,this.channel1canPlay=!1,this.channel2canPlay=!1,this.channel4canPlay=!1,this.audioClocksUntilNextEvent=1,this.audioClocksUntilNextEventCounter=1,this.channel1OutputLevelCache(),this.channel2OutputLevelCache(),this.channel3OutputLevelCache(),this.channel4OutputLevelCache(),this.noiseSampleTable=this.LSFR15Table},GameBoyCore.prototype.outputAudio=function(){this.audioBuffer[this.audioDestinationPosition++]=(this.downsampleInput>>>16)*this.downSampleInputDivider-1,this.audioBuffer[this.audioDestinationPosition++]=(65535&this.downsampleInput)*this.downSampleInputDivider-1,this.audioDestinationPosition==this.numSamplesTotal&&(this.audioHandle.writeAudioNoCallback(this.audioBuffer),this.audioDestinationPosition=0),this.downsampleInput=0},GameBoyCore.prototype.generateAudio=function(numSamples){var multiplier=0;if(this.soundMasterEnabled&&!this.CPUStopped)for(var clockUpTo=0;numSamples>0;){for(clockUpTo=Math.min(this.audioClocksUntilNextEventCounter,this.sequencerClocks,numSamples),this.audioClocksUntilNextEventCounter-=clockUpTo,this.sequencerClocks-=clockUpTo,numSamples-=clockUpTo;clockUpTo>0;)multiplier=Math.min(clockUpTo,this.audioResamplerFirstPassFactor-this.audioIndex),clockUpTo-=multiplier,this.audioIndex+=multiplier,this.downsampleInput+=this.mixerOutputCache*multiplier,this.audioIndex==this.audioResamplerFirstPassFactor&&(this.audioIndex=0,this.outputAudio());
0==this.sequencerClocks&&(this.audioComputeSequencer(),this.sequencerClocks=8192),0==this.audioClocksUntilNextEventCounter&&this.computeAudioChannels()}else for(;numSamples>0;)multiplier=Math.min(numSamples,this.audioResamplerFirstPassFactor-this.audioIndex),numSamples-=multiplier,this.audioIndex+=multiplier,this.audioIndex==this.audioResamplerFirstPassFactor&&(this.audioIndex=0,this.outputAudio())},GameBoyCore.prototype.generateAudioFake=function(numSamples){if(this.soundMasterEnabled&&!this.CPUStopped)for(var clockUpTo=0;numSamples>0;)clockUpTo=Math.min(this.audioClocksUntilNextEventCounter,this.sequencerClocks,numSamples),this.audioClocksUntilNextEventCounter-=clockUpTo,this.sequencerClocks-=clockUpTo,numSamples-=clockUpTo,0==this.sequencerClocks&&(this.audioComputeSequencer(),this.sequencerClocks=8192),0==this.audioClocksUntilNextEventCounter&&this.computeAudioChannels()},GameBoyCore.prototype.audioJIT=function(){this.opts.sound?this.generateAudio(this.audioTicks):this.generateAudioFake(this.audioTicks),this.audioTicks=0},GameBoyCore.prototype.audioComputeSequencer=function(){switch(this.sequencePosition++){case 0:this.clockAudioLength();break;case 2:this.clockAudioLength(),this.clockAudioSweep();break;case 4:this.clockAudioLength();break;case 6:this.clockAudioLength(),this.clockAudioSweep();break;case 7:this.clockAudioEnvelope(),this.sequencePosition=0}},GameBoyCore.prototype.clockAudioLength=function(){this.channel1totalLength>1?--this.channel1totalLength:1==this.channel1totalLength&&(this.channel1totalLength=0,this.channel1EnableCheck(),this.memory[65318]&=254),this.channel2totalLength>1?--this.channel2totalLength:1==this.channel2totalLength&&(this.channel2totalLength=0,this.channel2EnableCheck(),this.memory[65318]&=253),this.channel3totalLength>1?--this.channel3totalLength:1==this.channel3totalLength&&(this.channel3totalLength=0,this.channel3EnableCheck(),this.memory[65318]&=251),this.channel4totalLength>1?--this.channel4totalLength:1==this.channel4totalLength&&(this.channel4totalLength=0,this.channel4EnableCheck(),this.memory[65318]&=247)},GameBoyCore.prototype.clockAudioSweep=function(){!this.channel1SweepFault&&this.channel1timeSweep>0&&0==--this.channel1timeSweep&&this.runAudioSweep()},GameBoyCore.prototype.runAudioSweep=function(){this.channel1lastTimeSweep>0&&(this.channel1frequencySweepDivider>0?(this.channel1Swept=!0,this.channel1decreaseSweep?(this.channel1ShadowFrequency-=this.channel1ShadowFrequency>>this.channel1frequencySweepDivider,this.channel1frequency=2047&this.channel1ShadowFrequency,this.channel1FrequencyTracker=2048-this.channel1frequency<<2):(this.channel1ShadowFrequency+=this.channel1ShadowFrequency>>this.channel1frequencySweepDivider,this.channel1frequency=this.channel1ShadowFrequency,this.channel1ShadowFrequency<=2047?(this.channel1FrequencyTracker=2048-this.channel1frequency<<2,this.channel1ShadowFrequency+(this.channel1ShadowFrequency>>this.channel1frequencySweepDivider)>2047&&(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)):(this.channel1frequency&=2047,this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)),this.channel1timeSweep=this.channel1lastTimeSweep):(this.channel1SweepFault=!0,this.channel1EnableCheck()))},GameBoyCore.prototype.channel1AudioSweepPerformDummy=function(){if(this.channel1frequencySweepDivider>0&&!this.channel1decreaseSweep){var channel1ShadowFrequency=this.channel1ShadowFrequency+(this.channel1ShadowFrequency>>this.channel1frequencySweepDivider);2047>=channel1ShadowFrequency?channel1ShadowFrequency+(channel1ShadowFrequency>>this.channel1frequencySweepDivider)>2047&&(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254):(this.channel1SweepFault=!0,this.channel1EnableCheck(),this.memory[65318]&=254)}},GameBoyCore.prototype.clockAudioEnvelope=function(){this.channel1envelopeSweepsLast>-1&&(this.channel1envelopeSweeps>0?--this.channel1envelopeSweeps:this.channel1envelopeType?this.channel1envelopeVolume<15?(++this.channel1envelopeVolume,this.channel1envelopeSweeps=this.channel1envelopeSweepsLast,this.channel1OutputLevelCache()):this.channel1envelopeSweepsLast=-1:this.channel1envelopeVolume>0?(--this.channel1envelopeVolume,this.channel1envelopeSweeps=this.channel1envelopeSweepsLast,this.channel1OutputLevelCache()):this.channel1envelopeSweepsLast=-1),this.channel2envelopeSweepsLast>-1&&(this.channel2envelopeSweeps>0?--this.channel2envelopeSweeps:this.channel2envelopeType?this.channel2envelopeVolume<15?(++this.channel2envelopeVolume,this.channel2envelopeSweeps=this.channel2envelopeSweepsLast,this.channel2OutputLevelCache()):this.channel2envelopeSweepsLast=-1:this.channel2envelopeVolume>0?(--this.channel2envelopeVolume,this.channel2envelopeSweeps=this.channel2envelopeSweepsLast,this.channel2OutputLevelCache()):this.channel2envelopeSweepsLast=-1),this.channel4envelopeSweepsLast>-1&&(this.channel4envelopeSweeps>0?--this.channel4envelopeSweeps:this.channel4envelopeType?this.channel4envelopeVolume<15?(this.channel4currentVolume=++this.channel4envelopeVolume<<this.channel4VolumeShifter,this.channel4envelopeSweeps=this.channel4envelopeSweepsLast,this.channel4UpdateCache()):this.channel4envelopeSweepsLast=-1:this.channel4envelopeVolume>0?(this.channel4currentVolume=--this.channel4envelopeVolume<<this.channel4VolumeShifter,this.channel4envelopeSweeps=this.channel4envelopeSweepsLast,this.channel4UpdateCache()):this.channel4envelopeSweepsLast=-1)},GameBoyCore.prototype.computeAudioChannels=function(){this.channel1FrequencyCounter-=this.audioClocksUntilNextEvent,this.channel2FrequencyCounter-=this.audioClocksUntilNextEvent,this.channel3Counter-=this.audioClocksUntilNextEvent,this.channel4Counter-=this.audioClocksUntilNextEvent,0==this.channel1FrequencyCounter&&(this.channel1FrequencyCounter=this.channel1FrequencyTracker,this.channel1DutyTracker=this.channel1DutyTracker+1&7,this.channel1OutputLevelTrimaryCache()),0==this.channel2FrequencyCounter&&(this.channel2FrequencyCounter=this.channel2FrequencyTracker,this.channel2DutyTracker=this.channel2DutyTracker+1&7,this.channel2OutputLevelTrimaryCache()),0==this.channel3Counter&&(this.channel3canPlay&&(this.channel3lastSampleLookup=this.channel3lastSampleLookup+1&31),this.channel3Counter=this.channel3FrequencyPeriod,this.channel3UpdateCache()),0==this.channel4Counter&&(this.channel4lastSampleLookup=this.channel4lastSampleLookup+1&this.channel4BitRange,this.channel4Counter=this.channel4FrequencyPeriod,this.channel4UpdateCache()),this.audioClocksUntilNextEventCounter=this.audioClocksUntilNextEvent=Math.min(this.channel1FrequencyCounter,this.channel2FrequencyCounter,this.channel3Counter,this.channel4Counter)},GameBoyCore.prototype.channel1EnableCheck=function(){this.channel1Enabled=(this.channel1consecutive||this.channel1totalLength>0)&&!this.channel1SweepFault&&this.channel1canPlay,this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1VolumeEnableCheck=function(){this.channel1canPlay=this.memory[65298]>7,this.channel1EnableCheck(),this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1OutputLevelCache=function(){this.channel1currentSampleLeft=this.leftChannel1?this.channel1envelopeVolume:0,this.channel1currentSampleRight=this.rightChannel1?this.channel1envelopeVolume:0,this.channel1OutputLevelSecondaryCache()},GameBoyCore.prototype.channel1OutputLevelSecondaryCache=function(){this.channel1Enabled?(this.channel1currentSampleLeftSecondary=this.channel1currentSampleLeft,this.channel1currentSampleRightSecondary=this.channel1currentSampleRight):(this.channel1currentSampleLeftSecondary=0,this.channel1currentSampleRightSecondary=0),this.channel1OutputLevelTrimaryCache()},GameBoyCore.prototype.channel1OutputLevelTrimaryCache=function(){this.channel1CachedDuty[this.channel1DutyTracker]&&this.opts.channels[0]?(this.channel1currentSampleLeftTrimary=this.channel1currentSampleLeftSecondary,this.channel1currentSampleRightTrimary=this.channel1currentSampleRightSecondary):(this.channel1currentSampleLeftTrimary=0,this.channel1currentSampleRightTrimary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel2EnableCheck=function(){this.channel2Enabled=(this.channel2consecutive||this.channel2totalLength>0)&&this.channel2canPlay,this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2VolumeEnableCheck=function(){this.channel2canPlay=this.memory[65303]>7,this.channel2EnableCheck(),this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2OutputLevelCache=function(){this.channel2currentSampleLeft=this.leftChannel2?this.channel2envelopeVolume:0,this.channel2currentSampleRight=this.rightChannel2?this.channel2envelopeVolume:0,this.channel2OutputLevelSecondaryCache()},GameBoyCore.prototype.channel2OutputLevelSecondaryCache=function(){this.channel2Enabled?(this.channel2currentSampleLeftSecondary=this.channel2currentSampleLeft,this.channel2currentSampleRightSecondary=this.channel2currentSampleRight):(this.channel2currentSampleLeftSecondary=0,this.channel2currentSampleRightSecondary=0),this.channel2OutputLevelTrimaryCache()},GameBoyCore.prototype.channel2OutputLevelTrimaryCache=function(){this.channel2CachedDuty[this.channel2DutyTracker]&&this.opts.channels[1]?(this.channel2currentSampleLeftTrimary=this.channel2currentSampleLeftSecondary,this.channel2currentSampleRightTrimary=this.channel2currentSampleRightSecondary):(this.channel2currentSampleLeftTrimary=0,this.channel2currentSampleRightTrimary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel3EnableCheck=function(){this.channel3Enabled=this.channel3consecutive||this.channel3totalLength>0,this.channel3OutputLevelSecondaryCache()},GameBoyCore.prototype.channel3OutputLevelCache=function(){this.channel3currentSampleLeft=this.leftChannel3?this.cachedChannel3Sample:0,this.channel3currentSampleRight=this.rightChannel3?this.cachedChannel3Sample:0,this.channel3OutputLevelSecondaryCache()},GameBoyCore.prototype.channel3OutputLevelSecondaryCache=function(){this.channel3Enabled&&this.opts.channels[2]?(this.channel3currentSampleLeftSecondary=this.channel3currentSampleLeft,this.channel3currentSampleRightSecondary=this.channel3currentSampleRight):(this.channel3currentSampleLeftSecondary=0,this.channel3currentSampleRightSecondary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.channel4EnableCheck=function(){this.channel4Enabled=(this.channel4consecutive||this.channel4totalLength>0)&&this.channel4canPlay,this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4VolumeEnableCheck=function(){this.channel4canPlay=this.memory[65313]>7,this.channel4EnableCheck(),this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4OutputLevelCache=function(){this.channel4currentSampleLeft=this.leftChannel4?this.cachedChannel4Sample:0,this.channel4currentSampleRight=this.rightChannel4?this.cachedChannel4Sample:0,this.channel4OutputLevelSecondaryCache()},GameBoyCore.prototype.channel4OutputLevelSecondaryCache=function(){this.channel4Enabled&&this.opts.channels[3]?(this.channel4currentSampleLeftSecondary=this.channel4currentSampleLeft,this.channel4currentSampleRightSecondary=this.channel4currentSampleRight):(this.channel4currentSampleLeftSecondary=0,this.channel4currentSampleRightSecondary=0),this.mixerOutputLevelCache()},GameBoyCore.prototype.mixerOutputLevelCache=function(){this.mixerOutputCache=(this.channel1currentSampleLeftTrimary+this.channel2currentSampleLeftTrimary+this.channel3currentSampleLeftSecondary+this.channel4currentSampleLeftSecondary)*this.VinLeftChannelMasterVolume<<16|(this.channel1currentSampleRightTrimary+this.channel2currentSampleRightTrimary+this.channel3currentSampleRightSecondary+this.channel4currentSampleRightSecondary)*this.VinRightChannelMasterVolume},GameBoyCore.prototype.channel3UpdateCache=function(){this.cachedChannel3Sample=this.channel3PCM[this.channel3lastSampleLookup]>>this.channel3patternType,this.channel3OutputLevelCache()},GameBoyCore.prototype.channel3WriteRAM=function(address,data){this.channel3canPlay&&this.audioJIT(),this.memory[65328|address]=data,address<<=1,this.channel3PCM[address]=data>>4,this.channel3PCM[1|address]=15&data},GameBoyCore.prototype.channel4UpdateCache=function(){this.cachedChannel4Sample=this.noiseSampleTable[this.channel4currentVolume|this.channel4lastSampleLookup],this.channel4OutputLevelCache()},GameBoyCore.prototype.run=function(){0==(2&this.stopEmulator)&&(1==(1&this.stopEmulator)?this.CPUStopped?(this.audioUnderrunAdjustment(),this.audioTicks+=this.CPUCyclesTotal,this.audioJIT(),this.stopEmulator|=1):(this.stopEmulator=0,this.audioUnderrunAdjustment(),this.clockUpdate(),this.halt?(this.CPUTicks=0,this.calculateHALTPeriod(),this.halt?(this.updateCore(),this.iterationEndRoutine()):this.executeIteration()):this.executeIteration(),this.requestDraw()):this.emit("error",new Error("Iterator restarted a faulted core.")))},GameBoyCore.prototype.executeIteration=function(){for(var opcodeToExecute=0,timedTicks=0;0==this.stopEmulator;){switch(this.IRQEnableDelay){case 1:this.IME=!0,this.checkIRQMatching();case 2:--this.IRQEnableDelay}if(this.IRQLineMatched>0&&this.launchIRQ(),opcodeToExecute=this.memoryReader[this.programCounter](this,this.programCounter),this.programCounter=this.programCounter+1&65535,this.skipPCIncrement&&(this.programCounter=this.programCounter-1&65535,this.skipPCIncrement=!1),this.CPUTicks=this.TICKTable[opcodeToExecute],this.OPCODE[opcodeToExecute](this),this.LCDTicks+=this.CPUTicks>>this.doubleSpeedShifter,this.LCDCONTROL[this.actualScanLine](this),timedTicks=this.CPUTicks>>this.doubleSpeedShifter,this.audioTicks+=timedTicks,this.emulatorTicks+=timedTicks,this.DIVTicks+=this.CPUTicks,this.TIMAEnabled)for(this.timerTicks+=this.CPUTicks;this.timerTicks>=this.TACClocker;)this.timerTicks-=this.TACClocker,256==++this.memory[65285]&&(this.memory[65285]=this.memory[65286],this.interruptsRequested|=4,this.checkIRQMatching());this.serialTimer>0&&(this.serialTimer-=this.CPUTicks,this.serialTimer<=0&&(this.interruptsRequested|=8,this.checkIRQMatching()),this.serialShiftTimer-=this.CPUTicks,this.serialShiftTimer<=0&&(this.serialShiftTimer=this.serialShiftTimerAllocated,this.memory[65281]=this.memory[65281]<<1&254|1)),this.emulatorTicks>=this.CPUCyclesTotal&&this.iterationEndRoutine()}},GameBoyCore.prototype.iterationEndRoutine=function(){0==(1&this.stopEmulator)&&(this.audioJIT(),this.memory[65284]=this.memory[65284]+(this.DIVTicks>>8)&255,this.DIVTicks&=255,this.stopEmulator|=1,this.emulatorTicks-=this.CPUCyclesTotal,this.CPUCyclesTotalCurrent+=this.CPUCyclesTotalRoundoff,this.recalculateIterationClockLimit())},GameBoyCore.prototype.handleSTOP=function(){this.CPUStopped=!0,this.iterationEndRoutine(),this.emulatorTicks<0&&(this.audioTicks-=this.emulatorTicks,this.audioJIT())},GameBoyCore.prototype.recalculateIterationClockLimit=function(){var endModulus=this.CPUCyclesTotalCurrent%4;this.CPUCyclesTotal=this.CPUCyclesTotalBase+this.CPUCyclesTotalCurrent-endModulus,this.CPUCyclesTotalCurrent=endModulus},GameBoyCore.prototype.recalculateIterationClockLimitForAudio=function(audioClocking){this.CPUCyclesTotal+=Math.min(audioClocking>>2<<2,this.CPUCyclesTotalBase<<1)},GameBoyCore.prototype.scanLineMode2=function(){1!=this.STATTracker&&(this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=1,this.modeSTAT=2)},GameBoyCore.prototype.scanLineMode3=function(){3!=this.modeSTAT&&(0==this.STATTracker&&this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=1,this.modeSTAT=3)},GameBoyCore.prototype.scanLineMode0=function(){0!=this.modeSTAT&&(2!=this.STATTracker&&(0==this.STATTracker&&(this.mode2TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.modeSTAT=3),this.incrementScanLineQueue(),this.updateSpriteCount(this.actualScanLine),this.STATTracker=2),this.LCDTicks>=this.spriteCount&&(this.hdmaRunning&&this.executeHDMA(),this.mode0TriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching()),this.STATTracker=3,this.modeSTAT=0))},GameBoyCore.prototype.clocksUntilLYCMatch=function(){return 0!=this.memory[65349]?this.memory[65349]>this.actualScanLine?456*(this.memory[65349]-this.actualScanLine):456*(154-this.actualScanLine+this.memory[65349]):456*(153==this.actualScanLine&&0==this.memory[65348]?154:153-this.actualScanLine)+8},GameBoyCore.prototype.clocksUntilMode0=function(){switch(this.modeSTAT){case 0:return 143==this.actualScanLine?(this.updateSpriteCount(0),this.spriteCount+5016):(this.updateSpriteCount(this.actualScanLine+1),this.spriteCount+456);case 2:case 3:return this.updateSpriteCount(this.actualScanLine),this.spriteCount;case 1:return this.updateSpriteCount(0),this.spriteCount+456*(154-this.actualScanLine)}},GameBoyCore.prototype.updateSpriteCount=function(line){if(this.spriteCount=252,this.cGBC&&this.gfxSpriteShow)for(var lineAdjusted=line+16,yoffset=0,yCap=this.gfxSpriteNormalHeight?8:16,OAMAddress=65024;65184>OAMAddress&&this.spriteCount<312;OAMAddress+=4)yoffset=lineAdjusted-this.memory[OAMAddress],yoffset>-1&&yCap>yoffset&&(this.spriteCount+=6)},GameBoyCore.prototype.matchLYC=function(){this.memory[65348]==this.memory[65349]?(this.memory[65345]|=4,this.LYCMatchTriggerSTAT&&(this.interruptsRequested|=2,this.checkIRQMatching())):this.memory[65345]&=123},GameBoyCore.prototype.updateCore=function(){this.LCDTicks+=this.CPUTicks>>this.doubleSpeedShifter,this.LCDCONTROL[this.actualScanLine](this);var timedTicks=this.CPUTicks>>this.doubleSpeedShifter;if(this.audioTicks+=timedTicks,this.emulatorTicks+=timedTicks,this.DIVTicks+=this.CPUTicks,this.TIMAEnabled)for(this.timerTicks+=this.CPUTicks;this.timerTicks>=this.TACClocker;)this.timerTicks-=this.TACClocker,256==++this.memory[65285]&&(this.memory[65285]=this.memory[65286],this.interruptsRequested|=4,this.checkIRQMatching());this.serialTimer>0&&(this.serialTimer-=this.CPUTicks,this.serialTimer<=0&&(this.interruptsRequested|=8,this.checkIRQMatching()),this.serialShiftTimer-=this.CPUTicks,this.serialShiftTimer<=0&&(this.serialShiftTimer=this.serialShiftTimerAllocated,this.memory[65281]=this.memory[65281]<<1&254|1))},GameBoyCore.prototype.updateCoreFull=function(){this.updateCore(),this.emulatorTicks>=this.CPUCyclesTotal&&this.iterationEndRoutine()},GameBoyCore.prototype.initializeLCDController=function(){for(var line=0;154>line;)143>line?this.LINECONTROL[line]=function(parentObj){parentObj.LCDTicks<80?parentObj.scanLineMode2():parentObj.LCDTicks<252?parentObj.scanLineMode3():parentObj.LCDTicks<456?parentObj.scanLineMode0():(parentObj.LCDTicks-=456,3!=parentObj.STATTracker&&(2!=parentObj.STATTracker&&(0==parentObj.STATTracker&&parentObj.mode2TriggerSTAT&&(parentObj.interruptsRequested|=2),parentObj.incrementScanLineQueue()),parentObj.hdmaRunning&&parentObj.executeHDMA(),parentObj.mode0TriggerSTAT&&(parentObj.interruptsRequested|=2)),parentObj.actualScanLine=++parentObj.memory[65348],parentObj.actualScanLine==parentObj.memory[65349]?(parentObj.memory[65345]|=4,parentObj.LYCMatchTriggerSTAT&&(parentObj.interruptsRequested|=2)):parentObj.memory[65345]&=123,parentObj.checkIRQMatching(),parentObj.STATTracker=0,parentObj.modeSTAT=2,parentObj.LINECONTROL[parentObj.actualScanLine](parentObj))}:143==line?this.LINECONTROL[143]=function(parentObj){parentObj.LCDTicks<80?parentObj.scanLineMode2():parentObj.LCDTicks<252?parentObj.scanLineMode3():parentObj.LCDTicks<456?parentObj.scanLineMode0():(parentObj.LCDTicks-=456,3!=parentObj.STATTracker&&(2!=parentObj.STATTracker&&(0==parentObj.STATTracker&&parentObj.mode2TriggerSTAT&&(parentObj.interruptsRequested|=2),parentObj.incrementScanLineQueue()),parentObj.hdmaRunning&&parentObj.executeHDMA(),parentObj.mode0TriggerSTAT&&(parentObj.interruptsRequested|=2)),parentObj.actualScanLine=parentObj.memory[65348]=144,144==parentObj.memory[65349]?(parentObj.memory[65345]|=4,parentObj.LYCMatchTriggerSTAT&&(parentObj.interruptsRequested|=2)):parentObj.memory[65345]&=123,parentObj.STATTracker=0,parentObj.modeSTAT=1,parentObj.interruptsRequested|=parentObj.mode1TriggerSTAT?3:1,parentObj.checkIRQMatching(),0==parentObj.drewBlank?(parentObj.totalLinesPassed<144||144==parentObj.totalLinesPassed&&parentObj.midScanlineOffset>-1)&&(parentObj.graphicsJITVBlank(),parentObj.prepareFrame()):--parentObj.drewBlank,parentObj.LINECONTROL[144](parentObj))}:153>line?this.LINECONTROL[line]=function(parentObj){parentObj.LCDTicks>=456&&(parentObj.LCDTicks-=456,parentObj.actualScanLine=++parentObj.memory[65348],parentObj.actualScanLine==parentObj.memory[65349]?(parentObj.memory[65345]|=4,parentObj.LYCMatchTriggerSTAT&&(parentObj.interruptsRequested|=2,parentObj.checkIRQMatching())):parentObj.memory[65345]&=123,parentObj.LINECONTROL[parentObj.actualScanLine](parentObj))}:this.LINECONTROL[153]=function(parentObj){parentObj.LCDTicks>=8&&(4!=parentObj.STATTracker&&153==parentObj.memory[65348]&&(parentObj.memory[65348]=0,0==parentObj.memory[65349]?(parentObj.memory[65345]|=4,parentObj.LYCMatchTriggerSTAT&&(parentObj.interruptsRequested|=2,parentObj.checkIRQMatching())):parentObj.memory[65345]&=123,parentObj.STATTracker=4),parentObj.LCDTicks>=456&&(parentObj.LCDTicks-=456,parentObj.STATTracker=parentObj.actualScanLine=0,parentObj.LINECONTROL[0](parentObj)))},++line},GameBoyCore.prototype.DisplayShowOff=function(){0==this.drewBlank&&(this.clearFrameBuffer(),this.drewFrame=!0),this.drewBlank=2},GameBoyCore.prototype.executeHDMA=function(){this.DMAWrite(1),this.halt?this.LCDTicks-this.spriteCount<(4>>this.doubleSpeedShifter|32)&&(this.CPUTicks=4+(32+this.spriteCount<<this.doubleSpeedShifter),this.LCDTicks=this.spriteCount+(4>>this.doubleSpeedShifter|32)):this.LCDTicks+=4>>this.doubleSpeedShifter|32,0==this.memory[65365]?(this.hdmaRunning=!1,this.memory[65365]=255):--this.memory[65365]},GameBoyCore.prototype.clockUpdate=function(){if(this.cTIMER){var dateObj=new Date,newTime=dateObj.getTime(),timeElapsed=newTime-this.lastIteration;if(this.lastIteration=newTime,this.cTIMER&&!this.RTCHALT)for(this.RTCSeconds+=timeElapsed/1e3;this.RTCSeconds>=60;)this.RTCSeconds-=60,++this.RTCMinutes,this.RTCMinutes>=60&&(this.RTCMinutes-=60,++this.RTCHours,this.RTCHours>=24&&(this.RTCHours-=24,this.RTCDays++,this.RTCDays>=512&&(this.RTCDays-=512,this.RTCDayOverFlow=!0)))}},GameBoyCore.prototype.prepareFrame=function(){this.swizzleFrameBuffer(),this.drewFrame=!0},GameBoyCore.prototype.requestDraw=function(){this.drewFrame&&this.dispatchDraw()},GameBoyCore.prototype.dispatchDraw=function(){this.offscreenRGBCount>0&&this.processDraw(this.swizzledFrame)},GameBoyCore.prototype.processDraw=function(frameBuffer){for(var canvasRGBALength=this.offscreenRGBCount,canvasData=this.canvasBuffer.data,bufferIndex=0,canvasIndex=0;canvasRGBALength>canvasIndex;++canvasIndex)canvasData[canvasIndex++]=frameBuffer[bufferIndex++],canvasData[canvasIndex++]=frameBuffer[bufferIndex++],canvasData[canvasIndex++]=frameBuffer[bufferIndex++];this.graphicsBlit(),this.drewFrame=!1,this.opts.drawEvents&&this.emit("draw")},GameBoyCore.prototype.swizzleFrameBuffer=function(){for(var frameBuffer=this.frameBuffer,swizzledFrame=this.swizzledFrame,bufferIndex=0,canvasIndex=0;69120>canvasIndex;)swizzledFrame[canvasIndex++]=frameBuffer[bufferIndex]>>16&255,swizzledFrame[canvasIndex++]=frameBuffer[bufferIndex]>>8&255,swizzledFrame[canvasIndex++]=255&frameBuffer[bufferIndex++]},GameBoyCore.prototype.clearFrameBuffer=function(){var bufferIndex=0,frameBuffer=this.swizzledFrame;if(this.cGBC||this.colorizedGBPalettes)for(;69120>bufferIndex;)frameBuffer[bufferIndex++]=248;else for(;69120>bufferIndex;)frameBuffer[bufferIndex++]=239,frameBuffer[bufferIndex++]=255,frameBuffer[bufferIndex++]=222},GameBoyCore.prototype.renderScanLine=function(scanlineToRender){if(this.pixelStart=160*scanlineToRender,this.bgEnabled)this.pixelEnd=160,this.BGLayerRender(scanlineToRender),this.WindowLayerRender(scanlineToRender);else for(var pixelLine=160*(scanlineToRender+1),defaultColor=this.cGBC||this.colorizedGBPalettes?16316664:15728606,pixelPosition=160*scanlineToRender+this.currentX;pixelLine>pixelPosition;pixelPosition++)this.frameBuffer[pixelPosition]=defaultColor;this.SpriteLayerRender(scanlineToRender),this.currentX=0,this.midScanlineOffset=-1},GameBoyCore.prototype.renderMidScanLine=function(){if(this.actualScanLine<144&&3==this.modeSTAT&&(-1==this.midScanlineOffset&&(this.midScanlineOffset=7&this.backgroundX),this.LCDTicks>=82)){if(this.pixelEnd=this.LCDTicks-74,this.pixelEnd=Math.min(this.pixelEnd-this.midScanlineOffset-this.pixelEnd%8,160),this.bgEnabled)this.pixelStart=160*this.lastUnrenderedLine,this.BGLayerRender(this.lastUnrenderedLine),this.WindowLayerRender(this.lastUnrenderedLine);else for(var pixelLine=160*this.lastUnrenderedLine+this.pixelEnd,defaultColor=this.cGBC||this.colorizedGBPalettes?16316664:15728606,pixelPosition=160*this.lastUnrenderedLine+this.currentX;pixelLine>pixelPosition;pixelPosition++)this.frameBuffer[pixelPosition]=defaultColor;this.currentX=this.pixelEnd}},GameBoyCore.prototype.initializeModeSpecificArrays=function(){this.LCDCONTROL=this.LCDisOn?this.LINECONTROL:this.DISPLAYOFFCONTROL,this.cGBC?(this.gbcOBJRawPalette=this.getTypedArray(64,0,"uint8"),this.gbcBGRawPalette=this.getTypedArray(64,0,"uint8"),this.gbcOBJPalette=this.getTypedArray(32,16777216,"int32"),this.gbcBGPalette=this.getTypedArray(64,0,"int32"),this.BGCHRBank2=this.getTypedArray(2048,0,"uint8"),this.BGCHRCurrentBank=this.currVRAMBank>0?this.BGCHRBank2:this.BGCHRBank1,this.tileCache=this.generateCacheArray(3968)):(this.gbOBJPalette=this.getTypedArray(8,0,"int32"),this.gbBGPalette=this.getTypedArray(4,0,"int32"),this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette,this.tileCache=this.generateCacheArray(1792),this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32")),this.renderPathBuild()},GameBoyCore.prototype.GBCtoGBModeAdjust=function(){debug("Stepping down from GBC mode.",0),this.VRAM=this.GBCMemory=this.BGCHRCurrentBank=this.BGCHRBank2=null,this.tileCache.length=1792,this.opts.colorizeGb?(this.gbBGColorizedPalette=this.getTypedArray(4,0,"int32"),this.gbOBJColorizedPalette=this.getTypedArray(8,0,"int32"),this.cachedBGPaletteConversion=this.getTypedArray(4,0,"int32"),this.cachedOBJPaletteConversion=this.getTypedArray(8,0,"int32"),this.BGPalette=this.gbBGColorizedPalette,this.OBJPalette=this.gbOBJColorizedPalette,this.gbOBJPalette=this.gbBGPalette=null,this.getGBCColor()):(this.gbOBJPalette=this.getTypedArray(8,0,"int32"),this.gbBGPalette=this.getTypedArray(4,0,"int32"),this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette),this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32"),this.renderPathBuild(),this.memoryReadJumpCompile(),this.memoryWriteJumpCompile()},GameBoyCore.prototype.renderPathBuild=function(){this.cGBC?(this.priorityFlaggingPathRebuild(),this.SpriteLayerRender=this.SpriteGBCLayerRender):(this.BGLayerRender=this.BGGBLayerRender,this.WindowLayerRender=this.WindowGBLayerRender,this.SpriteLayerRender=this.SpriteGBLayerRender)},GameBoyCore.prototype.priorityFlaggingPathRebuild=function(){this.BGPriorityEnabled?(this.BGLayerRender=this.BGGBCLayerRender,this.WindowLayerRender=this.WindowGBCLayerRender):(this.BGLayerRender=this.BGGBCLayerRenderNoPriorityFlagging,this.WindowLayerRender=this.WindowGBCLayerRenderNoPriorityFlagging)},GameBoyCore.prototype.initializeReferencesFromSaveState=function(){this.LCDCONTROL=this.LCDisOn?this.LINECONTROL:this.DISPLAYOFFCONTROL;var tileIndex=0;if(this.cGBC)for(this.BGCHRCurrentBank=this.currVRAMBank>0?this.BGCHRBank2:this.BGCHRBank1,this.tileCache=this.generateCacheArray(3968);6144>tileIndex;tileIndex+=16)this.generateGBCTileBank1(tileIndex),this.generateGBCTileBank2(tileIndex);else{for(this.colorizedGBPalettes?(this.BGPalette=this.gbBGColorizedPalette,this.OBJPalette=this.gbOBJColorizedPalette,this.updateGBBGPalette=this.updateGBColorizedBGPalette,this.updateGBOBJPalette=this.updateGBColorizedOBJPalette):(this.BGPalette=this.gbBGPalette,this.OBJPalette=this.gbOBJPalette),this.tileCache=this.generateCacheArray(1792),tileIndex=32768;36864>tileIndex;tileIndex+=2)this.generateGBOAMTileLine(tileIndex);for(tileIndex=36864;38912>tileIndex;tileIndex+=2)this.generateGBTileLine(tileIndex);this.sortBuffer=this.getTypedArray(256,0,"uint8"),this.OAMAddressCache=this.getTypedArray(10,0,"int32")}this.renderPathBuild()},GameBoyCore.prototype.RGBTint=function(value){var r=31&value,g=value>>5&31,b=value>>10&31;return 13*r+2*g+b>>1<<16|3*g+b<<9|3*r+2*g+11*b>>1},GameBoyCore.prototype.getGBCColor=function(){for(var adjustedIndex,counter=0;4>counter;counter++)adjustedIndex=counter<<1,this.cachedBGPaletteConversion[counter]=this.RGBTint(this.gbcBGRawPalette[1|adjustedIndex]<<8|this.gbcBGRawPalette[adjustedIndex]),this.cachedOBJPaletteConversion[counter]=this.RGBTint(this.gbcOBJRawPalette[1|adjustedIndex]<<8|this.gbcOBJRawPalette[adjustedIndex]);for(counter=4;8>counter;counter++)adjustedIndex=counter<<1,this.cachedOBJPaletteConversion[counter]=this.RGBTint(this.gbcOBJRawPalette[1|adjustedIndex]<<8|this.gbcOBJRawPalette[adjustedIndex]);this.updateGBBGPalette=this.updateGBColorizedBGPalette,this.updateGBOBJPalette=this.updateGBColorizedOBJPalette,this.updateGBBGPalette(this.memory[65351]),this.updateGBOBJPalette(0,this.memory[65352]),this.updateGBOBJPalette(1,this.memory[65353]),this.colorizedGBPalettes=!0},GameBoyCore.prototype.updateGBRegularBGPalette=function(data){this.gbBGPalette[0]=33554432|this.colors[3&data],this.gbBGPalette[1]=this.colors[data>>2&3],this.gbBGPalette[2]=this.colors[data>>4&3],this.gbBGPalette[3]=this.colors[data>>6]},GameBoyCore.prototype.updateGBColorizedBGPalette=function(data){this.gbBGColorizedPalette[0]=33554432|this.cachedBGPaletteConversion[3&data],this.gbBGColorizedPalette[1]=this.cachedBGPaletteConversion[data>>2&3],this.gbBGColorizedPalette[2]=this.cachedBGPaletteConversion[data>>4&3],this.gbBGColorizedPalette[3]=this.cachedBGPaletteConversion[data>>6]},GameBoyCore.prototype.updateGBRegularOBJPalette=function(index,data){this.gbOBJPalette[1|index]=this.colors[data>>2&3],this.gbOBJPalette[2|index]=this.colors[data>>4&3],this.gbOBJPalette[3|index]=this.colors[data>>6]},GameBoyCore.prototype.updateGBColorizedOBJPalette=function(index,data){this.gbOBJColorizedPalette[1|index]=this.cachedOBJPaletteConversion[index|data>>2&3],this.gbOBJColorizedPalette[2|index]=this.cachedOBJPaletteConversion[index|data>>4&3],this.gbOBJColorizedPalette[3|index]=this.cachedOBJPaletteConversion[index|data>>6]},GameBoyCore.prototype.updateGBCBGPalette=function(index,data){this.gbcBGRawPalette[index]!=data&&(this.midScanLineJIT(),this.gbcBGRawPalette[index]=data,0==(6&index)?(data=33554432|this.RGBTint(this.gbcBGRawPalette[1|index]<<8|this.gbcBGRawPalette[62&index]),index>>=1,this.gbcBGPalette[index]=data,this.gbcBGPalette[32|index]=16777216|data):(data=this.RGBTint(this.gbcBGRawPalette[1|index]<<8|this.gbcBGRawPalette[62&index]),index>>=1,this.gbcBGPalette[index]=data,this.gbcBGPalette[32|index]=16777216|data))},GameBoyCore.prototype.updateGBCOBJPalette=function(index,data){this.gbcOBJRawPalette[index]!=data&&(this.gbcOBJRawPalette[index]=data,(6&index)>0&&(this.midScanLineJIT(),this.gbcOBJPalette[index>>1]=16777216|this.RGBTint(this.gbcOBJRawPalette[1|index]<<8|this.gbcOBJRawPalette[62&index])))},GameBoyCore.prototype.BGGBLayerRender=function(scanlineToRender){var scrollYAdjusted=this.backgroundY+scanlineToRender&255,tileYLine=(7&scrollYAdjusted)<<3,tileYDown=this.gfxBackgroundCHRBankPosition|(248&scrollYAdjusted)<<2,scrollXAdjusted=this.backgroundX+this.currentX&255,pixelPosition=this.pixelStart+this.currentX,pixelPositionEnd=this.pixelStart+(this.gfxWindowDisplay&&scanlineToRender-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),tileNumber=tileYDown+(scrollXAdjusted>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);for(var tile=this.tileCache[chrCode],texel=7&scrollXAdjusted;8>texel&&pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.BGPalette[tile[tileYLine|texel++]];
var scrollXAdjustedAligned=Math.min(pixelPositionEnd-pixelPosition,256-scrollXAdjusted)>>3;for(scrollXAdjusted+=scrollXAdjustedAligned<<3,scrollXAdjustedAligned+=tileNumber;scrollXAdjustedAligned>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],texel=tileYLine,this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel]];if(pixelPositionEnd>pixelPosition){if(256>scrollXAdjusted)for(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],texel=tileYLine-1;pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.BGPalette[tile[++texel]];for(scrollXAdjustedAligned=(pixelPositionEnd-pixelPosition>>3)+tileYDown;scrollXAdjustedAligned>tileYDown;)chrCode=this.BGCHRBank1[tileYDown++],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],texel=tileYLine,this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[tileYDown],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.BGPalette[tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.BGPalette[tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.BGPalette[tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.BGPalette[tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.BGPalette[tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.BGPalette[tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.BGPalette[tile[tileYLine]]}}},GameBoyCore.prototype.BGGBCLayerRender=function(scanlineToRender){var scrollYAdjusted=this.backgroundY+scanlineToRender&255,tileYLine=(7&scrollYAdjusted)<<3,tileYDown=this.gfxBackgroundCHRBankPosition|(248&scrollYAdjusted)<<2,scrollXAdjusted=this.backgroundX+this.currentX&255,pixelPosition=this.pixelStart+this.currentX,pixelPositionEnd=this.pixelStart+(this.gfxWindowDisplay&&scanlineToRender-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),tileNumber=tileYDown+(scrollXAdjusted>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);for(var attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=7&scrollXAdjusted;8>texel&&pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[tileYLine|texel++]];var scrollXAdjustedAligned=Math.min(pixelPositionEnd-pixelPosition,256-scrollXAdjusted)>>3;for(scrollXAdjusted+=scrollXAdjustedAligned<<3,scrollXAdjustedAligned+=tileNumber;scrollXAdjustedAligned>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition){if(256>scrollXAdjusted)for(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=tileYLine-1;pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[++texel]];for(scrollXAdjustedAligned=(pixelPositionEnd-pixelPosition>>3)+tileYDown;scrollXAdjustedAligned>tileYDown;)chrCode=this.BGCHRBank1[tileYDown],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileYDown++],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[tileYDown],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileYDown],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.gbcBGPalette[palette|tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.gbcBGPalette[palette|tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.gbcBGPalette[palette|tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.gbcBGPalette[palette|tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.gbcBGPalette[palette|tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.gbcBGPalette[palette|tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.gbcBGPalette[palette|tile[tileYLine]]}}},GameBoyCore.prototype.BGGBCLayerRenderNoPriorityFlagging=function(scanlineToRender){var scrollYAdjusted=this.backgroundY+scanlineToRender&255,tileYLine=(7&scrollYAdjusted)<<3,tileYDown=this.gfxBackgroundCHRBankPosition|(248&scrollYAdjusted)<<2,scrollXAdjusted=this.backgroundX+this.currentX&255,pixelPosition=this.pixelStart+this.currentX,pixelPositionEnd=this.pixelStart+(this.gfxWindowDisplay&&scanlineToRender-this.windowY>=0?Math.min(Math.max(this.windowX,0)+this.currentX,this.pixelEnd):this.pixelEnd),tileNumber=tileYDown+(scrollXAdjusted>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);for(var attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=7&scrollXAdjusted;8>texel&&pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[tileYLine|texel++]];var scrollXAdjustedAligned=Math.min(pixelPositionEnd-pixelPosition,256-scrollXAdjusted)>>3;for(scrollXAdjusted+=scrollXAdjustedAligned<<3,scrollXAdjustedAligned+=tileNumber;scrollXAdjustedAligned>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition){if(256>scrollXAdjusted)for(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=tileYLine-1;pixelPositionEnd>pixelPosition&&256>scrollXAdjusted;++scrollXAdjusted)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[++texel]];for(scrollXAdjustedAligned=(pixelPositionEnd-pixelPosition>>3)+tileYDown;scrollXAdjustedAligned>tileYDown;)chrCode=this.BGCHRBank1[tileYDown],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileYDown++],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[tileYDown],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileYDown],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.gbcBGPalette[palette|tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.gbcBGPalette[palette|tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.gbcBGPalette[palette|tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.gbcBGPalette[palette|tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.gbcBGPalette[palette|tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.gbcBGPalette[palette|tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.gbcBGPalette[palette|tile[tileYLine]]}}},GameBoyCore.prototype.WindowGBLayerRender=function(scanlineToRender){if(this.gfxWindowDisplay){var scrollYAdjusted=scanlineToRender-this.windowY;if(scrollYAdjusted>=0){var scrollXRangeAdjusted=this.windowX>0?this.windowX+this.currentX:this.currentX,pixelPosition=this.pixelStart+scrollXRangeAdjusted,pixelPositionEnd=this.pixelStart+this.pixelEnd;if(pixelPositionEnd>pixelPosition){var tileYLine=(7&scrollYAdjusted)<<3,tileNumber=(this.gfxWindowCHRBankPosition|(248&scrollYAdjusted)<<2)+(this.currentX>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);var tile=this.tileCache[chrCode],texel=scrollXRangeAdjusted-this.windowX&7;for(scrollXRangeAdjusted=Math.min(8,texel+pixelPositionEnd-pixelPosition);scrollXRangeAdjusted>texel;)this.frameBuffer[pixelPosition++]=this.BGPalette[tile[tileYLine|texel++]];for(scrollXRangeAdjusted=tileNumber+(pixelPositionEnd-pixelPosition>>3);scrollXRangeAdjusted>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],texel=tileYLine,this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel++]],this.frameBuffer[pixelPosition++]=this.BGPalette[tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),tile=this.tileCache[chrCode],pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.BGPalette[tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.BGPalette[tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.BGPalette[tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.BGPalette[tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.BGPalette[tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.BGPalette[tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.BGPalette[tile[tileYLine]]}}}}},GameBoyCore.prototype.WindowGBCLayerRender=function(scanlineToRender){if(this.gfxWindowDisplay){var scrollYAdjusted=scanlineToRender-this.windowY;if(scrollYAdjusted>=0){var scrollXRangeAdjusted=this.windowX>0?this.windowX+this.currentX:this.currentX,pixelPosition=this.pixelStart+scrollXRangeAdjusted,pixelPositionEnd=this.pixelStart+this.pixelEnd;if(pixelPositionEnd>pixelPosition){var tileYLine=(7&scrollYAdjusted)<<3,tileNumber=(this.gfxWindowCHRBankPosition|(248&scrollYAdjusted)<<2)+(this.currentX>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);var attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=scrollXRangeAdjusted-this.windowX&7;for(scrollXRangeAdjusted=Math.min(8,texel+pixelPositionEnd-pixelPosition);scrollXRangeAdjusted>texel;)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[tileYLine|texel++]];for(scrollXRangeAdjusted=tileNumber+(pixelPositionEnd-pixelPosition>>3);scrollXRangeAdjusted>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2|(128&attrCode)>>2,pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.gbcBGPalette[palette|tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.gbcBGPalette[palette|tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.gbcBGPalette[palette|tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.gbcBGPalette[palette|tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.gbcBGPalette[palette|tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.gbcBGPalette[palette|tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.gbcBGPalette[palette|tile[tileYLine]]}}}}},GameBoyCore.prototype.WindowGBCLayerRenderNoPriorityFlagging=function(scanlineToRender){if(this.gfxWindowDisplay){var scrollYAdjusted=scanlineToRender-this.windowY;if(scrollYAdjusted>=0){var scrollXRangeAdjusted=this.windowX>0?this.windowX+this.currentX:this.currentX,pixelPosition=this.pixelStart+scrollXRangeAdjusted,pixelPositionEnd=this.pixelStart+this.pixelEnd;if(pixelPositionEnd>pixelPosition){var tileYLine=(7&scrollYAdjusted)<<3,tileNumber=(this.gfxWindowCHRBankPosition|(248&scrollYAdjusted)<<2)+(this.currentX>>3),chrCode=this.BGCHRBank1[tileNumber];chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256);var attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=scrollXRangeAdjusted-this.windowX&7;for(scrollXRangeAdjusted=Math.min(8,texel+pixelPositionEnd-pixelPosition);scrollXRangeAdjusted>texel;)this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[tileYLine|texel++]];for(scrollXRangeAdjusted=tileNumber+(pixelPositionEnd-pixelPosition>>3);scrollXRangeAdjusted>tileNumber;)chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,texel=tileYLine,this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel++]],this.frameBuffer[pixelPosition++]=this.gbcBGPalette[palette|tile[texel]];if(pixelPositionEnd>pixelPosition)switch(chrCode=this.BGCHRBank1[++tileNumber],chrCode<this.gfxBackgroundBankOffset&&(chrCode|=256),attrCode=this.BGCHRBank2[tileNumber],tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|chrCode],palette=(7&attrCode)<<2,pixelPositionEnd-pixelPosition){case 7:this.frameBuffer[pixelPosition+6]=this.gbcBGPalette[palette|tile[6|tileYLine]];case 6:this.frameBuffer[pixelPosition+5]=this.gbcBGPalette[palette|tile[5|tileYLine]];case 5:this.frameBuffer[pixelPosition+4]=this.gbcBGPalette[palette|tile[4|tileYLine]];case 4:this.frameBuffer[pixelPosition+3]=this.gbcBGPalette[palette|tile[3|tileYLine]];case 3:this.frameBuffer[pixelPosition+2]=this.gbcBGPalette[palette|tile[2|tileYLine]];case 2:this.frameBuffer[pixelPosition+1]=this.gbcBGPalette[palette|tile[1|tileYLine]];case 1:this.frameBuffer[pixelPosition]=this.gbcBGPalette[palette|tile[tileYLine]]}}}}},GameBoyCore.prototype.SpriteGBLayerRender=function(scanlineToRender){if(this.gfxSpriteShow){for(var lineAdjusted=scanlineToRender+16,OAMAddress=65024,yoffset=0,xcoord=1,xCoordStart=0,xCoordEnd=0,attrCode=0,palette=0,tile=null,data=0,spriteCount=0,length=0,currentPixel=0,linePixel=0;168>xcoord;)this.sortBuffer[xcoord++]=255;if(this.gfxSpriteNormalHeight)for(var length=this.findLowestSpriteDrawable(lineAdjusted,7);length>spriteCount;++spriteCount)for(OAMAddress=this.OAMAddressCache[spriteCount],yoffset=lineAdjusted-this.memory[OAMAddress]<<3,attrCode=this.memory[3|OAMAddress],palette=(16&attrCode)>>2,tile=this.tileCache[(96&attrCode)<<4|this.memory[2|OAMAddress]],linePixel=xCoordStart=this.memory[1|OAMAddress],xCoordEnd=Math.min(168-linePixel,8),xcoord=linePixel>7?0:8-linePixel,currentPixel=this.pixelStart+(linePixel>8?linePixel-8:0);xCoordEnd>xcoord;++xcoord,++currentPixel,++linePixel)this.sortBuffer[linePixel]>xCoordStart&&(this.frameBuffer[currentPixel]>=33554432?(data=tile[yoffset|xcoord],data>0&&(this.frameBuffer[currentPixel]=this.OBJPalette[palette|data],this.sortBuffer[linePixel]=xCoordStart)):this.frameBuffer[currentPixel]<16777216&&(data=tile[yoffset|xcoord],data>0&&128>attrCode&&(this.frameBuffer[currentPixel]=this.OBJPalette[palette|data],this.sortBuffer[linePixel]=xCoordStart)));else for(var length=this.findLowestSpriteDrawable(lineAdjusted,15);length>spriteCount;++spriteCount)for(OAMAddress=this.OAMAddressCache[spriteCount],yoffset=lineAdjusted-this.memory[OAMAddress]<<3,attrCode=this.memory[3|OAMAddress],palette=(16&attrCode)>>2,tile=(64&attrCode)==(64&yoffset)?this.tileCache[(96&attrCode)<<4|254&this.memory[2|OAMAddress]]:this.tileCache[(96&attrCode)<<4|this.memory[2|OAMAddress]|1],yoffset&=63,linePixel=xCoordStart=this.memory[1|OAMAddress],xCoordEnd=Math.min(168-linePixel,8),xcoord=linePixel>7?0:8-linePixel,currentPixel=this.pixelStart+(linePixel>8?linePixel-8:0);xCoordEnd>xcoord;++xcoord,++currentPixel,++linePixel)this.sortBuffer[linePixel]>xCoordStart&&(this.frameBuffer[currentPixel]>=33554432?(data=tile[yoffset|xcoord],data>0&&(this.frameBuffer[currentPixel]=this.OBJPalette[palette|data],this.sortBuffer[linePixel]=xCoordStart)):this.frameBuffer[currentPixel]<16777216&&(data=tile[yoffset|xcoord],data>0&&128>attrCode&&(this.frameBuffer[currentPixel]=this.OBJPalette[palette|data],this.sortBuffer[linePixel]=xCoordStart)))}},GameBoyCore.prototype.findLowestSpriteDrawable=function(scanlineToRender,drawableRange){for(var address=65024,spriteCount=0,diff=0;65184>address&&10>spriteCount;)diff=scanlineToRender-this.memory[address],(diff&drawableRange)==diff&&(this.OAMAddressCache[spriteCount++]=address),address+=4;return spriteCount},GameBoyCore.prototype.SpriteGBCLayerRender=function(scanlineToRender){if(this.gfxSpriteShow){var OAMAddress=65024,lineAdjusted=scanlineToRender+16,yoffset=0,xcoord=0,endX=0,xCounter=0,attrCode=0,palette=0,tile=null,data=0,currentPixel=0,spriteCount=0;if(this.gfxSpriteNormalHeight){for(;65184>OAMAddress&&10>spriteCount;OAMAddress+=4)if(yoffset=lineAdjusted-this.memory[OAMAddress],(7&yoffset)==yoffset){for(xcoord=this.memory[1|OAMAddress]-8,endX=Math.min(160,xcoord+8),attrCode=this.memory[3|OAMAddress],palette=(7&attrCode)<<2,tile=this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|this.memory[2|OAMAddress]],xCounter=xcoord>0?xcoord:0,xcoord-=yoffset<<3,currentPixel=this.pixelStart+xCounter;endX>xCounter;++xCounter,++currentPixel)this.frameBuffer[currentPixel]>=33554432?(data=tile[xCounter-xcoord],data>0&&(this.frameBuffer[currentPixel]=this.gbcOBJPalette[palette|data])):this.frameBuffer[currentPixel]<16777216&&(data=tile[xCounter-xcoord],data>0&&128>attrCode&&(this.frameBuffer[currentPixel]=this.gbcOBJPalette[palette|data]));++spriteCount}}else for(;65184>OAMAddress&&10>spriteCount;OAMAddress+=4)if(yoffset=lineAdjusted-this.memory[OAMAddress],(15&yoffset)==yoffset){for(xcoord=this.memory[1|OAMAddress]-8,endX=Math.min(160,xcoord+8),attrCode=this.memory[3|OAMAddress],palette=(7&attrCode)<<2,tile=(64&attrCode)==(64&yoffset<<3)?this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|254&this.memory[2|OAMAddress]]:this.tileCache[(8&attrCode)<<8|(96&attrCode)<<4|this.memory[2|OAMAddress]|1],xCounter=xcoord>0?xcoord:0,xcoord-=(7&yoffset)<<3,currentPixel=this.pixelStart+xCounter;endX>xCounter;++xCounter,++currentPixel)this.frameBuffer[currentPixel]>=33554432?(data=tile[xCounter-xcoord],data>0&&(this.frameBuffer[currentPixel]=this.gbcOBJPalette[palette|data])):this.frameBuffer[currentPixel]<16777216&&(data=tile[xCounter-xcoord],data>0&&128>attrCode&&(this.frameBuffer[currentPixel]=this.gbcOBJPalette[palette|data]));++spriteCount}}},GameBoyCore.prototype.generateGBTileLine=function(address){var lineCopy=this.memory[1|address]<<8|this.memory[40958&address],tileBlock=this.tileCache[(8176&address)>>4];address=(14&address)<<2,tileBlock[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7},GameBoyCore.prototype.generateGBCTileLineBank1=function(address){var lineCopy=this.memory[1|address]<<8|this.memory[40958&address];address&=8190;var tileBlock1=this.tileCache[address>>4],tileBlock2=this.tileCache[512|address>>4],tileBlock3=this.tileCache[1024|address>>4],tileBlock4=this.tileCache[1536|address>>4];address=(14&address)<<2;var addressFlipped=56-address;tileBlock4[addressFlipped]=tileBlock2[address]=tileBlock3[7|addressFlipped]=tileBlock1[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock4[1|addressFlipped]=tileBlock2[1|address]=tileBlock3[6|addressFlipped]=tileBlock1[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock4[2|addressFlipped]=tileBlock2[2|address]=tileBlock3[5|addressFlipped]=tileBlock1[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock4[3|addressFlipped]=tileBlock2[3|address]=tileBlock3[4|addressFlipped]=tileBlock1[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock4[4|addressFlipped]=tileBlock2[4|address]=tileBlock3[3|addressFlipped]=tileBlock1[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock4[5|addressFlipped]=tileBlock2[5|address]=tileBlock3[2|addressFlipped]=tileBlock1[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock4[6|addressFlipped]=tileBlock2[6|address]=tileBlock3[1|addressFlipped]=tileBlock1[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock4[7|addressFlipped]=tileBlock2[7|address]=tileBlock3[addressFlipped]=tileBlock1[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7},GameBoyCore.prototype.generateGBCTileBank1=function(vramAddress){var address=vramAddress>>4,tileBlock1=this.tileCache[address],tileBlock2=this.tileCache[512|address],tileBlock3=this.tileCache[1024|address],tileBlock4=this.tileCache[1536|address],lineCopy=0;vramAddress|=32768,address=0;var addressFlipped=56;do lineCopy=this.memory[1|vramAddress]<<8|this.memory[vramAddress],tileBlock4[addressFlipped]=tileBlock2[address]=tileBlock3[7|addressFlipped]=tileBlock1[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock4[1|addressFlipped]=tileBlock2[1|address]=tileBlock3[6|addressFlipped]=tileBlock1[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock4[2|addressFlipped]=tileBlock2[2|address]=tileBlock3[5|addressFlipped]=tileBlock1[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock4[3|addressFlipped]=tileBlock2[3|address]=tileBlock3[4|addressFlipped]=tileBlock1[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock4[4|addressFlipped]=tileBlock2[4|address]=tileBlock3[3|addressFlipped]=tileBlock1[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock4[5|addressFlipped]=tileBlock2[5|address]=tileBlock3[2|addressFlipped]=tileBlock1[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock4[6|addressFlipped]=tileBlock2[6|address]=tileBlock3[1|addressFlipped]=tileBlock1[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock4[7|addressFlipped]=tileBlock2[7|address]=tileBlock3[addressFlipped]=tileBlock1[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7,address+=8,addressFlipped-=8,vramAddress+=2;while(addressFlipped>-1)},GameBoyCore.prototype.generateGBCTileLineBank2=function(address){var lineCopy=this.VRAM[1|address]<<8|this.VRAM[8190&address],tileBlock1=this.tileCache[2048|address>>4],tileBlock2=this.tileCache[2560|address>>4],tileBlock3=this.tileCache[3072|address>>4],tileBlock4=this.tileCache[3584|address>>4];address=(14&address)<<2;var addressFlipped=56-address;tileBlock4[addressFlipped]=tileBlock2[address]=tileBlock3[7|addressFlipped]=tileBlock1[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock4[1|addressFlipped]=tileBlock2[1|address]=tileBlock3[6|addressFlipped]=tileBlock1[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock4[2|addressFlipped]=tileBlock2[2|address]=tileBlock3[5|addressFlipped]=tileBlock1[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock4[3|addressFlipped]=tileBlock2[3|address]=tileBlock3[4|addressFlipped]=tileBlock1[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock4[4|addressFlipped]=tileBlock2[4|address]=tileBlock3[3|addressFlipped]=tileBlock1[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock4[5|addressFlipped]=tileBlock2[5|address]=tileBlock3[2|addressFlipped]=tileBlock1[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock4[6|addressFlipped]=tileBlock2[6|address]=tileBlock3[1|addressFlipped]=tileBlock1[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock4[7|addressFlipped]=tileBlock2[7|address]=tileBlock3[addressFlipped]=tileBlock1[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7},GameBoyCore.prototype.generateGBCTileBank2=function(vramAddress){var address=vramAddress>>4,tileBlock1=this.tileCache[2048|address],tileBlock2=this.tileCache[2560|address],tileBlock3=this.tileCache[3072|address],tileBlock4=this.tileCache[3584|address],lineCopy=0;address=0;var addressFlipped=56;do lineCopy=this.VRAM[1|vramAddress]<<8|this.VRAM[vramAddress],tileBlock4[addressFlipped]=tileBlock2[address]=tileBlock3[7|addressFlipped]=tileBlock1[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock4[1|addressFlipped]=tileBlock2[1|address]=tileBlock3[6|addressFlipped]=tileBlock1[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock4[2|addressFlipped]=tileBlock2[2|address]=tileBlock3[5|addressFlipped]=tileBlock1[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock4[3|addressFlipped]=tileBlock2[3|address]=tileBlock3[4|addressFlipped]=tileBlock1[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock4[4|addressFlipped]=tileBlock2[4|address]=tileBlock3[3|addressFlipped]=tileBlock1[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock4[5|addressFlipped]=tileBlock2[5|address]=tileBlock3[2|addressFlipped]=tileBlock1[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock4[6|addressFlipped]=tileBlock2[6|address]=tileBlock3[1|addressFlipped]=tileBlock1[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock4[7|addressFlipped]=tileBlock2[7|address]=tileBlock3[addressFlipped]=tileBlock1[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7,address+=8,addressFlipped-=8,vramAddress+=2;while(addressFlipped>-1)},GameBoyCore.prototype.generateGBOAMTileLine=function(address){var lineCopy=this.memory[1|address]<<8|this.memory[40958&address];address&=8190;var tileBlock1=this.tileCache[address>>4],tileBlock2=this.tileCache[512|address>>4],tileBlock3=this.tileCache[1024|address>>4],tileBlock4=this.tileCache[1536|address>>4];address=(14&address)<<2;var addressFlipped=56-address;tileBlock4[addressFlipped]=tileBlock2[address]=tileBlock3[7|addressFlipped]=tileBlock1[7|address]=(256&lineCopy)>>7|1&lineCopy,tileBlock4[1|addressFlipped]=tileBlock2[1|address]=tileBlock3[6|addressFlipped]=tileBlock1[6|address]=(512&lineCopy)>>8|(2&lineCopy)>>1,tileBlock4[2|addressFlipped]=tileBlock2[2|address]=tileBlock3[5|addressFlipped]=tileBlock1[5|address]=(1024&lineCopy)>>9|(4&lineCopy)>>2,tileBlock4[3|addressFlipped]=tileBlock2[3|address]=tileBlock3[4|addressFlipped]=tileBlock1[4|address]=(2048&lineCopy)>>10|(8&lineCopy)>>3,tileBlock4[4|addressFlipped]=tileBlock2[4|address]=tileBlock3[3|addressFlipped]=tileBlock1[3|address]=(4096&lineCopy)>>11|(16&lineCopy)>>4,tileBlock4[5|addressFlipped]=tileBlock2[5|address]=tileBlock3[2|addressFlipped]=tileBlock1[2|address]=(8192&lineCopy)>>12|(32&lineCopy)>>5,tileBlock4[6|addressFlipped]=tileBlock2[6|address]=tileBlock3[1|addressFlipped]=tileBlock1[1|address]=(16384&lineCopy)>>13|(64&lineCopy)>>6,tileBlock4[7|addressFlipped]=tileBlock2[7|address]=tileBlock3[addressFlipped]=tileBlock1[address]=(32768&lineCopy)>>14|(128&lineCopy)>>7},GameBoyCore.prototype.graphicsJIT=function(){this.LCDisOn&&(this.totalLinesPassed=0,this.graphicsJITScanlineGroup())},GameBoyCore.prototype.graphicsJITVBlank=function(){this.totalLinesPassed+=this.queuedScanLines,this.graphicsJITScanlineGroup()
},GameBoyCore.prototype.graphicsJITScanlineGroup=function(){for(;this.queuedScanLines>0;)this.renderScanLine(this.lastUnrenderedLine),this.lastUnrenderedLine<143?++this.lastUnrenderedLine:this.lastUnrenderedLine=0,--this.queuedScanLines},GameBoyCore.prototype.incrementScanLineQueue=function(){this.queuedScanLines<144?++this.queuedScanLines:(this.currentX=0,this.midScanlineOffset=-1,this.lastUnrenderedLine<143?++this.lastUnrenderedLine:this.lastUnrenderedLine=0)},GameBoyCore.prototype.midScanLineJIT=function(){this.graphicsJIT(),this.renderMidScanLine()},GameBoyCore.prototype.launchIRQ=function(){var bitShift=0,testbit=1;do{if((testbit&this.IRQLineMatched)==testbit)return this.IME=!1,this.interruptsRequested-=testbit,this.IRQLineMatched=0,this.CPUTicks=20,this.stackPointer=this.stackPointer-1&65535,this.memoryWriter[this.stackPointer](this,this.stackPointer,this.programCounter>>8),this.stackPointer=this.stackPointer-1&65535,this.memoryWriter[this.stackPointer](this,this.stackPointer,255&this.programCounter),this.programCounter=64|bitShift<<3,void this.updateCore();testbit=1<<++bitShift}while(5>bitShift)},GameBoyCore.prototype.checkIRQMatching=function(){this.IME&&(this.IRQLineMatched=this.interruptsEnabled&this.interruptsRequested&31)},GameBoyCore.prototype.calculateHALTPeriod=function(){var currentClocks;if(this.halt)currentClocks=this.remainingClocks;else{this.halt=!0,currentClocks=-1;var temp_var=0;this.LCDisOn&&(1==(1&this.interruptsEnabled)&&(currentClocks=456*((1==this.modeSTAT?298:144)-this.actualScanLine)-this.LCDTicks<<this.doubleSpeedShifter),2==(2&this.interruptsEnabled)&&(this.mode0TriggerSTAT&&(temp_var=this.clocksUntilMode0()-this.LCDTicks<<this.doubleSpeedShifter,(currentClocks>=temp_var||-1==currentClocks)&&(currentClocks=temp_var)),this.mode1TriggerSTAT&&0==(1&this.interruptsEnabled)&&(temp_var=456*((1==this.modeSTAT?298:144)-this.actualScanLine)-this.LCDTicks<<this.doubleSpeedShifter,(currentClocks>=temp_var||-1==currentClocks)&&(currentClocks=temp_var)),this.mode2TriggerSTAT&&(temp_var=(this.actualScanLine>=143?456*(154-this.actualScanLine):456)-this.LCDTicks<<this.doubleSpeedShifter,(currentClocks>=temp_var||-1==currentClocks)&&(currentClocks=temp_var)),this.LYCMatchTriggerSTAT&&this.memory[65349]<=153&&(temp_var=this.clocksUntilLYCMatch()-this.LCDTicks<<this.doubleSpeedShifter,(currentClocks>=temp_var||-1==currentClocks)&&(currentClocks=temp_var)))),this.TIMAEnabled&&4==(4&this.interruptsEnabled)&&(temp_var=(256-this.memory[65285])*this.TACClocker-this.timerTicks,(currentClocks>=temp_var||-1==currentClocks)&&(currentClocks=temp_var)),this.serialTimer>0&&8==(8&this.interruptsEnabled)&&(this.serialTimer<=currentClocks||-1==currentClocks)&&(currentClocks=this.serialTimer)}var maxClocks=this.CPUCyclesTotal-this.emulatorTicks<<this.doubleSpeedShifter;currentClocks>=0?maxClocks>=currentClocks?(this.CPUTicks=Math.max(currentClocks,this.CPUTicks),this.updateCoreFull(),this.halt=!1,this.CPUTicks=0):(this.CPUTicks=Math.max(maxClocks,this.CPUTicks),this.remainingClocks=currentClocks-this.CPUTicks):this.CPUTicks+=maxClocks},GameBoyCore.prototype.memoryRead=function(address){return this.memoryReader[address](this,address)},GameBoyCore.prototype.memoryHighRead=function(address){return this.memoryHighReader[address](this,address)},GameBoyCore.prototype.memoryReadJumpCompile=function(){for(var index=0;65535>=index;index++)if(16384>index)this.memoryReader[index]=this.memoryReadNormal;else if(32768>index)this.memoryReader[index]=this.memoryReadROM;else if(38912>index)this.memoryReader[index]=this.cGBC?this.VRAMDATAReadCGBCPU:this.VRAMDATAReadDMGCPU;else if(40960>index)this.memoryReader[index]=this.cGBC?this.VRAMCHRReadCGBCPU:this.VRAMCHRReadDMGCPU;else if(index>=40960&&49152>index)this.memoryReader[index]=this.numRAMBanks==1/16&&41472>index||this.numRAMBanks>=1?this.cMBC7?this.memoryReadMBC7:this.cMBC3?this.memoryReadMBC3:this.memoryReadMBC:this.memoryReadBAD;else if(index>=49152&&57344>index)this.memoryReader[index]=!this.cGBC||53248>index?this.memoryReadNormal:this.memoryReadGBCMemory;else if(index>=57344&&65024>index)this.memoryReader[index]=!this.cGBC||61440>index?this.memoryReadECHONormal:this.memoryReadECHOGBCMemory;else if(65184>index)this.memoryReader[index]=this.memoryReadOAM;else if(this.cGBC&&index>=65184&&65280>index)this.memoryReader[index]=this.memoryReadNormal;else if(index>=65280)switch(index){case 65280:this.memoryHighReader[0]=this.memoryReader[65280]=function(parentObj){return 192|parentObj.memory[65280]};break;case 65281:this.memoryHighReader[1]=this.memoryReader[65281]=function(parentObj){return parentObj.memory[65282]<128?parentObj.memory[65281]:255};break;case 65282:this.memoryHighReader[2]=this.memoryReader[65282]=this.cGBC?function(parentObj){return(parentObj.serialTimer<=0?124:252)|parentObj.memory[65282]}:function(parentObj){return(parentObj.serialTimer<=0?126:254)|parentObj.memory[65282]};break;case 65283:this.memoryHighReader[3]=this.memoryReader[65283]=this.memoryReadBAD;break;case 65284:this.memoryHighReader[4]=this.memoryReader[65284]=function(parentObj){return parentObj.memory[65284]=parentObj.memory[65284]+(parentObj.DIVTicks>>8)&255,parentObj.DIVTicks&=255,parentObj.memory[65284]};break;case 65285:case 65286:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65287:this.memoryHighReader[7]=this.memoryReader[65287]=function(parentObj){return 248|parentObj.memory[65287]};break;case 65288:case 65289:case 65290:case 65291:case 65292:case 65293:case 65294:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65295:this.memoryHighReader[15]=this.memoryReader[65295]=function(parentObj){return 224|parentObj.interruptsRequested};break;case 65296:this.memoryHighReader[16]=this.memoryReader[65296]=function(parentObj){return 128|parentObj.memory[65296]};break;case 65297:this.memoryHighReader[17]=this.memoryReader[65297]=function(parentObj){return 63|parentObj.memory[65297]};break;case 65298:this.memoryHighReader[18]=this.memoryHighReadNormal,this.memoryReader[65298]=this.memoryReadNormal;break;case 65299:this.memoryHighReader[19]=this.memoryReader[65299]=this.memoryReadBAD;break;case 65300:this.memoryHighReader[20]=this.memoryReader[65300]=function(parentObj){return 191|parentObj.memory[65300]};break;case 65301:this.memoryHighReader[21]=this.memoryReadBAD,this.memoryReader[65301]=this.memoryReadBAD;break;case 65302:this.memoryHighReader[22]=this.memoryReader[65302]=function(parentObj){return 63|parentObj.memory[65302]};break;case 65303:this.memoryHighReader[23]=this.memoryHighReadNormal,this.memoryReader[65303]=this.memoryReadNormal;break;case 65304:this.memoryHighReader[24]=this.memoryReader[65304]=this.memoryReadBAD;break;case 65305:this.memoryHighReader[25]=this.memoryReader[65305]=function(parentObj){return 191|parentObj.memory[65305]};break;case 65306:this.memoryHighReader[26]=this.memoryReader[65306]=function(parentObj){return 127|parentObj.memory[65306]};break;case 65307:this.memoryHighReader[27]=this.memoryReader[65307]=this.memoryReadBAD;break;case 65308:this.memoryHighReader[28]=this.memoryReader[65308]=function(parentObj){return 159|parentObj.memory[65308]};break;case 65309:this.memoryHighReader[29]=this.memoryReader[65309]=this.memoryReadBAD;break;case 65310:this.memoryHighReader[30]=this.memoryReader[65310]=function(parentObj){return 191|parentObj.memory[65310]};break;case 65311:case 65312:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65313:case 65314:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65315:this.memoryHighReader[35]=this.memoryReader[65315]=function(parentObj){return 191|parentObj.memory[65315]};break;case 65316:case 65317:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65318:this.memoryHighReader[38]=this.memoryReader[65318]=function(parentObj){return parentObj.audioJIT(),112|parentObj.memory[65318]};break;case 65319:case 65320:case 65321:case 65322:case 65323:case 65324:case 65325:case 65326:case 65327:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65328:case 65329:case 65330:case 65331:case 65332:case 65333:case 65334:case 65335:case 65336:case 65337:case 65338:case 65339:case 65340:case 65341:case 65342:case 65343:this.memoryReader[index]=function(parentObj,address){return parentObj.channel3canPlay?parentObj.memory[65280|parentObj.channel3lastSampleLookup>>1]:parentObj.memory[address]},this.memoryHighReader[255&index]=function(parentObj,address){return parentObj.channel3canPlay?parentObj.memory[65280|parentObj.channel3lastSampleLookup>>1]:parentObj.memory[65280|address]};break;case 65344:this.memoryHighReader[64]=this.memoryHighReadNormal,this.memoryReader[65344]=this.memoryReadNormal;break;case 65345:this.memoryHighReader[65]=this.memoryReader[65345]=function(parentObj){return 128|parentObj.memory[65345]|parentObj.modeSTAT};break;case 65346:this.memoryHighReader[66]=this.memoryReader[65346]=function(parentObj){return parentObj.backgroundY};break;case 65347:this.memoryHighReader[67]=this.memoryReader[65347]=function(parentObj){return parentObj.backgroundX};break;case 65348:this.memoryHighReader[68]=this.memoryReader[65348]=function(parentObj){return parentObj.LCDisOn?parentObj.memory[65348]:0};break;case 65349:case 65350:case 65351:case 65352:case 65353:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65354:this.memoryHighReader[74]=this.memoryReader[65354]=function(parentObj){return parentObj.windowY};break;case 65355:this.memoryHighReader[75]=this.memoryHighReadNormal,this.memoryReader[65355]=this.memoryReadNormal;break;case 65356:this.memoryHighReader[76]=this.memoryReader[65356]=this.memoryReadBAD;break;case 65357:this.memoryHighReader[77]=this.memoryHighReadNormal,this.memoryReader[65357]=this.memoryReadNormal;break;case 65358:this.memoryHighReader[78]=this.memoryReader[65358]=this.memoryReadBAD;break;case 65359:this.memoryHighReader[79]=this.memoryReader[65359]=function(parentObj){return parentObj.currVRAMBank};break;case 65360:case 65361:case 65362:case 65363:case 65364:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65365:this.cGBC?this.memoryHighReader[85]=this.memoryReader[65365]=function(parentObj){return!parentObj.LCDisOn&&parentObj.hdmaRunning&&(parentObj.DMAWrite((127&parentObj.memory[65365])+1),parentObj.memory[65365]=255,parentObj.hdmaRunning=!1),parentObj.memory[65365]}:(this.memoryReader[65365]=this.memoryReadNormal,this.memoryHighReader[85]=this.memoryHighReadNormal);break;case 65366:this.cGBC?this.memoryHighReader[86]=this.memoryReader[65366]=function(parentObj){return 60|(parentObj.memory[65366]>=192?2|193&parentObj.memory[65366]:195&parentObj.memory[65366])}:(this.memoryReader[65366]=this.memoryReadNormal,this.memoryHighReader[86]=this.memoryHighReadNormal);break;case 65367:case 65368:case 65369:case 65370:case 65371:case 65372:case 65373:case 65374:case 65375:case 65376:case 65377:case 65378:case 65379:case 65380:case 65381:case 65382:case 65383:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65384:case 65385:case 65386:case 65387:this.memoryHighReader[255&index]=this.memoryHighReadNormal,this.memoryReader[index]=this.memoryReadNormal;break;case 65388:this.memoryHighReader[108]=this.memoryReader[65388]=this.cGBC?function(parentObj){return 254|parentObj.memory[65388]}:this.memoryReadBAD;break;case 65389:case 65390:case 65391:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65392:this.memoryHighReader[112]=this.memoryReader[65392]=this.cGBC?function(parentObj){return 64|parentObj.memory[65392]}:this.memoryReadBAD;break;case 65393:this.memoryHighReader[113]=this.memoryReader[65393]=this.memoryReadBAD;break;case 65394:case 65395:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadNormal;break;case 65396:this.memoryHighReader[116]=this.memoryReader[65396]=this.cGBC?this.memoryReadNormal:this.memoryReadBAD;break;case 65397:this.memoryHighReader[117]=this.memoryReader[65397]=function(parentObj){return 143|parentObj.memory[65397]};break;case 65398:case 65399:this.memoryHighReader[255&index]=this.memoryReader[index]=function(){return 0};break;case 65400:case 65401:case 65402:case 65403:case 65404:case 65405:case 65406:case 65407:this.memoryHighReader[255&index]=this.memoryReader[index]=this.memoryReadBAD;break;case 65535:this.memoryHighReader[255]=this.memoryReader[65535]=function(parentObj){return parentObj.interruptsEnabled};break;default:this.memoryReader[index]=this.memoryReadNormal,this.memoryHighReader[255&index]=this.memoryHighReadNormal}else this.memoryReader[index]=this.memoryReadBAD},GameBoyCore.prototype.memoryReadNormal=function(parentObj,address){return parentObj.memory[address]},GameBoyCore.prototype.memoryHighReadNormal=function(parentObj,address){return parentObj.memory[65280|address]},GameBoyCore.prototype.memoryReadROM=function(parentObj,address){return parentObj.ROM[parentObj.currentROMBank+address]},GameBoyCore.prototype.memoryReadMBC=function(parentObj,address){return parentObj.MBCRAMBanksEnabled||this.opts.overrideMbc?parentObj.MBCRam[address+parentObj.currMBCRAMBankPosition]:255},GameBoyCore.prototype.memoryReadMBC7=function(parentObj,address){if(parentObj.MBCRAMBanksEnabled||this.opts.overrideMbc)switch(address){case 40960:case 41056:case 41072:return 0;case 41088:return 0;case 41040:return parentObj.highY;case 41024:return parentObj.lowY;case 41008:return parentObj.highX;case 40992:return parentObj.lowX;default:return parentObj.MBCRam[address+parentObj.currMBCRAMBankPosition]}return 255},GameBoyCore.prototype.memoryReadMBC3=function(parentObj,address){if(parentObj.MBCRAMBanksEnabled||this.opts.overrideMbc)switch(parentObj.currMBCRAMBank){case 0:case 1:case 2:case 3:return parentObj.MBCRam[address+parentObj.currMBCRAMBankPosition];case 8:return parentObj.latchedSeconds;case 9:return parentObj.latchedMinutes;case 10:return parentObj.latchedHours;case 11:return parentObj.latchedLDays;case 12:return(parentObj.RTCDayOverFlow?128:0)+(parentObj.RTCHALT?64:0)+parentObj.latchedHDays}return 255},GameBoyCore.prototype.memoryReadGBCMemory=function(parentObj,address){return parentObj.GBCMemory[address+parentObj.gbcRamBankPosition]},GameBoyCore.prototype.memoryReadOAM=function(parentObj,address){return parentObj.modeSTAT>1?255:parentObj.memory[address]},GameBoyCore.prototype.memoryReadECHOGBCMemory=function(parentObj,address){return parentObj.GBCMemory[address+parentObj.gbcRamBankPositionECHO]},GameBoyCore.prototype.memoryReadECHONormal=function(parentObj,address){return parentObj.memory[address-8192]},GameBoyCore.prototype.memoryReadBAD=function(){return 255},GameBoyCore.prototype.VRAMDATAReadCGBCPU=function(parentObj,address){return parentObj.modeSTAT>2?255:0==parentObj.currVRAMBank?parentObj.memory[address]:parentObj.VRAM[8191&address]},GameBoyCore.prototype.VRAMDATAReadDMGCPU=function(parentObj,address){return parentObj.modeSTAT>2?255:parentObj.memory[address]},GameBoyCore.prototype.VRAMCHRReadCGBCPU=function(parentObj,address){return parentObj.modeSTAT>2?255:parentObj.BGCHRCurrentBank[2047&address]},GameBoyCore.prototype.VRAMCHRReadDMGCPU=function(parentObj,address){return parentObj.modeSTAT>2?255:parentObj.BGCHRBank1[2047&address]},GameBoyCore.prototype.setCurrentMBC1ROMBank=function(){switch(this.ROMBank1offs){case 0:case 32:case 64:case 96:this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge<<14;break;default:this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge-1<<14}},GameBoyCore.prototype.setCurrentMBC2AND3ROMBank=function(){this.currentROMBank=Math.max(this.ROMBank1offs%this.ROMBankEdge-1,0)<<14},GameBoyCore.prototype.setCurrentMBC5ROMBank=function(){this.currentROMBank=this.ROMBank1offs%this.ROMBankEdge-1<<14},GameBoyCore.prototype.memoryWrite=function(address,data){this.memoryWriter[address](this,address,data)},GameBoyCore.prototype.memoryHighWrite=function(address,data){this.memoryHighWriter[address](this,address,data)},GameBoyCore.prototype.memoryWriteJumpCompile=function(){for(var index=0;65535>=index;index++)32768>index?this.memoryWriter[index]=this.cMBC1?8192>index?this.MBCWriteEnable:16384>index?this.MBC1WriteROMBank:24576>index?this.MBC1WriteRAMBank:this.MBC1WriteType:this.cMBC2?4096>index?this.MBCWriteEnable:index>=8448&&8704>index?this.MBC2WriteROMBank:this.cartIgnoreWrite:this.cMBC3?8192>index?this.MBCWriteEnable:16384>index?this.MBC3WriteROMBank:24576>index?this.MBC3WriteRAMBank:this.MBC3WriteRTCLatch:this.cMBC5||this.cRUMBLE||this.cMBC7?8192>index?this.MBCWriteEnable:12288>index?this.MBC5WriteROMBankLow:16384>index?this.MBC5WriteROMBankHigh:24576>index?this.cRUMBLE?this.RUMBLEWriteRAMBank:this.MBC5WriteRAMBank:this.cartIgnoreWrite:this.cHuC3?8192>index?this.MBCWriteEnable:16384>index?this.MBC3WriteROMBank:24576>index?this.HuC3WriteRAMBank:this.cartIgnoreWrite:this.cartIgnoreWrite:36864>index?this.memoryWriter[index]=this.cGBC?this.VRAMGBCDATAWrite:this.VRAMGBDATAWrite:38912>index?this.memoryWriter[index]=this.cGBC?this.VRAMGBCDATAWrite:this.VRAMGBDATAUpperWrite:40960>index?this.memoryWriter[index]=this.cGBC?this.VRAMGBCCHRMAPWrite:this.VRAMGBCHRMAPWrite:49152>index?this.memoryWriter[index]=this.numRAMBanks==1/16&&41472>index||this.numRAMBanks>=1?this.cMBC3?this.memoryWriteMBC3RAM:this.memoryWriteMBCRAM:this.cartIgnoreWrite:57344>index?this.memoryWriter[index]=this.cGBC&&index>=53248?this.memoryWriteGBCRAM:this.memoryWriteNormal:65024>index?this.memoryWriter[index]=this.cGBC&&index>=61440?this.memoryWriteECHOGBCRAM:this.memoryWriteECHONormal:65184>=index?this.memoryWriter[index]=this.memoryWriteOAMRAM:65280>index?this.memoryWriter[index]=this.cGBC?this.memoryWriteNormal:this.cartIgnoreWrite:(this.memoryWriter[index]=this.memoryWriteNormal,this.memoryHighWriter[255&index]=this.memoryHighWriteNormal);this.registerWriteJumpCompile()},GameBoyCore.prototype.MBCWriteEnable=function(parentObj,address,data){parentObj.MBCRAMBanksEnabled=10==(15&data)},GameBoyCore.prototype.MBC1WriteROMBank=function(parentObj,address,data){parentObj.ROMBank1offs=96&parentObj.ROMBank1offs|31&data,parentObj.setCurrentMBC1ROMBank()},GameBoyCore.prototype.MBC1WriteRAMBank=function(parentObj,address,data){parentObj.MBC1Mode?(parentObj.currMBCRAMBank=3&data,parentObj.currMBCRAMBankPosition=(parentObj.currMBCRAMBank<<13)-40960):(parentObj.ROMBank1offs=(3&data)<<5|31&parentObj.ROMBank1offs,parentObj.setCurrentMBC1ROMBank())},GameBoyCore.prototype.MBC1WriteType=function(parentObj,address,data){parentObj.MBC1Mode=1==(1&data),parentObj.MBC1Mode?(parentObj.ROMBank1offs&=31,parentObj.setCurrentMBC1ROMBank()):(parentObj.currMBCRAMBank=0,parentObj.currMBCRAMBankPosition=-40960)},GameBoyCore.prototype.MBC2WriteROMBank=function(parentObj,address,data){parentObj.ROMBank1offs=15&data,parentObj.setCurrentMBC2AND3ROMBank()},GameBoyCore.prototype.MBC3WriteROMBank=function(parentObj,address,data){parentObj.ROMBank1offs=127&data,parentObj.setCurrentMBC2AND3ROMBank()},GameBoyCore.prototype.MBC3WriteRAMBank=function(parentObj,address,data){parentObj.currMBCRAMBank=data,4>data&&(parentObj.currMBCRAMBankPosition=(parentObj.currMBCRAMBank<<13)-40960)},GameBoyCore.prototype.MBC3WriteRTCLatch=function(parentObj,address,data){0==data?parentObj.RTCisLatched=!1:parentObj.RTCisLatched||(parentObj.RTCisLatched=!0,parentObj.latchedSeconds=0|parentObj.RTCSeconds,parentObj.latchedMinutes=parentObj.RTCMinutes,parentObj.latchedHours=parentObj.RTCHours,parentObj.latchedLDays=255&parentObj.RTCDays,parentObj.latchedHDays=parentObj.RTCDays>>8)},GameBoyCore.prototype.MBC5WriteROMBankLow=function(parentObj,address,data){parentObj.ROMBank1offs=256&parentObj.ROMBank1offs|data,parentObj.setCurrentMBC5ROMBank()},GameBoyCore.prototype.MBC5WriteROMBankHigh=function(parentObj,address,data){parentObj.ROMBank1offs=(1&data)<<8|255&parentObj.ROMBank1offs,parentObj.setCurrentMBC5ROMBank()},GameBoyCore.prototype.MBC5WriteRAMBank=function(parentObj,address,data){parentObj.currMBCRAMBank=15&data,parentObj.currMBCRAMBankPosition=(parentObj.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.RUMBLEWriteRAMBank=function(parentObj,address,data){parentObj.currMBCRAMBank=3&data,parentObj.currMBCRAMBankPosition=(parentObj.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.HuC3WriteRAMBank=function(parentObj,address,data){parentObj.currMBCRAMBank=3&data,parentObj.currMBCRAMBankPosition=(parentObj.currMBCRAMBank<<13)-40960},GameBoyCore.prototype.cartIgnoreWrite=function(){},GameBoyCore.prototype.memoryWriteNormal=function(parentObj,address,data){parentObj.memory[address]=data},GameBoyCore.prototype.memoryHighWriteNormal=function(parentObj,address,data){parentObj.memory[65280|address]=data},GameBoyCore.prototype.memoryWriteMBCRAM=function(parentObj,address,data){(parentObj.MBCRAMBanksEnabled||this.opts.overrideMbc)&&(parentObj.MBCRam[address+parentObj.currMBCRAMBankPosition]=data)},GameBoyCore.prototype.memoryWriteMBC3RAM=function(parentObj,address,data){if(parentObj.MBCRAMBanksEnabled||this.opts.overrideMbc)switch(parentObj.currMBCRAMBank){case 0:case 1:case 2:case 3:parentObj.MBCRam[address+parentObj.currMBCRAMBankPosition]=data;break;case 8:60>data?parentObj.RTCSeconds=data:debug("(Bank #"+parentObj.currMBCRAMBank+") RTC write out of range: "+data,1);break;case 9:60>data?parentObj.RTCMinutes=data:debug("(Bank #"+parentObj.currMBCRAMBank+") RTC write out of range: "+data,1);break;case 10:24>data?parentObj.RTCHours=data:debug("(Bank #"+parentObj.currMBCRAMBank+") RTC write out of range: "+data,1);break;case 11:parentObj.RTCDays=255&data|256&parentObj.RTCDays;break;case 12:parentObj.RTCDayOverFlow=data>127,parentObj.RTCHalt=64==(64&data),parentObj.RTCDays=(1&data)<<8|255&parentObj.RTCDays;break;default:debug("Invalid MBC3 bank address selected: "+parentObj.currMBCRAMBank,0)}},GameBoyCore.prototype.memoryWriteGBCRAM=function(parentObj,address,data){parentObj.GBCMemory[address+parentObj.gbcRamBankPosition]=data},GameBoyCore.prototype.memoryWriteOAMRAM=function(parentObj,address,data){parentObj.modeSTAT<2&&parentObj.memory[address]!=data&&(parentObj.graphicsJIT(),parentObj.memory[address]=data)},GameBoyCore.prototype.memoryWriteECHOGBCRAM=function(parentObj,address,data){parentObj.GBCMemory[address+parentObj.gbcRamBankPositionECHO]=data},GameBoyCore.prototype.memoryWriteECHONormal=function(parentObj,address,data){parentObj.memory[address-8192]=data},GameBoyCore.prototype.VRAMGBDATAWrite=function(parentObj,address,data){parentObj.modeSTAT<3&&parentObj.memory[address]!=data&&(parentObj.graphicsJIT(),parentObj.memory[address]=data,parentObj.generateGBOAMTileLine(address))},GameBoyCore.prototype.VRAMGBDATAUpperWrite=function(parentObj,address,data){parentObj.modeSTAT<3&&parentObj.memory[address]!=data&&(parentObj.graphicsJIT(),parentObj.memory[address]=data,parentObj.generateGBTileLine(address))},GameBoyCore.prototype.VRAMGBCDATAWrite=function(parentObj,address,data){parentObj.modeSTAT<3&&(0==parentObj.currVRAMBank?parentObj.memory[address]!=data&&(parentObj.graphicsJIT(),parentObj.memory[address]=data,parentObj.generateGBCTileLineBank1(address)):(address&=8191,parentObj.VRAM[address]!=data&&(parentObj.graphicsJIT(),parentObj.VRAM[address]=data,parentObj.generateGBCTileLineBank2(address))))},GameBoyCore.prototype.VRAMGBCHRMAPWrite=function(parentObj,address,data){parentObj.modeSTAT<3&&(address&=2047,parentObj.BGCHRBank1[address]!=data&&(parentObj.graphicsJIT(),parentObj.BGCHRBank1[address]=data))},GameBoyCore.prototype.VRAMGBCCHRMAPWrite=function(parentObj,address,data){parentObj.modeSTAT<3&&(address&=2047,parentObj.BGCHRCurrentBank[address]!=data&&(parentObj.graphicsJIT(),parentObj.BGCHRCurrentBank[address]=data))},GameBoyCore.prototype.DMAWrite=function(tilesToTransfer){this.halt||(this.CPUTicks+=4|tilesToTransfer<<5<<this.doubleSpeedShifter);var source=this.memory[65361]<<8|this.memory[65362],destination=this.memory[65363]<<8|this.memory[65364],memoryReader=this.memoryReader;this.graphicsJIT();var memory=this.memory;if(0==this.currVRAMBank){do 6144>destination?(memory[32768|destination]=memoryReader[source](this,source++),memory[32769|destination]=memoryReader[source](this,source++),memory[32770|destination]=memoryReader[source](this,source++),memory[32771|destination]=memoryReader[source](this,source++),memory[32772|destination]=memoryReader[source](this,source++),memory[32773|destination]=memoryReader[source](this,source++),memory[32774|destination]=memoryReader[source](this,source++),memory[32775|destination]=memoryReader[source](this,source++),memory[32776|destination]=memoryReader[source](this,source++),memory[32777|destination]=memoryReader[source](this,source++),memory[32778|destination]=memoryReader[source](this,source++),memory[32779|destination]=memoryReader[source](this,source++),memory[32780|destination]=memoryReader[source](this,source++),memory[32781|destination]=memoryReader[source](this,source++),memory[32782|destination]=memoryReader[source](this,source++),memory[32783|destination]=memoryReader[source](this,source++),this.generateGBCTileBank1(destination),destination+=16):(destination&=2032,this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),this.BGCHRBank1[destination++]=memoryReader[source](this,source++),destination=destination+6144&8176),source&=65520,--tilesToTransfer;while(tilesToTransfer>0)}else{var VRAM=this.VRAM;do 6144>destination?(VRAM[destination]=memoryReader[source](this,source++),VRAM[1|destination]=memoryReader[source](this,source++),VRAM[2|destination]=memoryReader[source](this,source++),VRAM[3|destination]=memoryReader[source](this,source++),VRAM[4|destination]=memoryReader[source](this,source++),VRAM[5|destination]=memoryReader[source](this,source++),VRAM[6|destination]=memoryReader[source](this,source++),VRAM[7|destination]=memoryReader[source](this,source++),VRAM[8|destination]=memoryReader[source](this,source++),VRAM[9|destination]=memoryReader[source](this,source++),VRAM[10|destination]=memoryReader[source](this,source++),VRAM[11|destination]=memoryReader[source](this,source++),VRAM[12|destination]=memoryReader[source](this,source++),VRAM[13|destination]=memoryReader[source](this,source++),VRAM[14|destination]=memoryReader[source](this,source++),VRAM[15|destination]=memoryReader[source](this,source++),this.generateGBCTileBank2(destination),destination+=16):(destination&=2032,this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),this.BGCHRBank2[destination++]=memoryReader[source](this,source++),destination=destination+6144&8176),source&=65520,--tilesToTransfer;while(tilesToTransfer>0)}memory[65361]=source>>8,memory[65362]=240&source,memory[65363]=destination>>8,memory[65364]=240&destination},GameBoyCore.prototype.registerWriteJumpCompile=function(){this.memoryHighWriter[0]=this.memoryWriter[65280]=function(parentObj,address,data){parentObj.memory[65280]=48&data|(0==(32&data)?parentObj.JoyPad>>4:15)&(0==(16&data)?15&parentObj.JoyPad:15)},this.memoryHighWriter[1]=this.memoryWriter[65281]=function(parentObj,address,data){parentObj.memory[65282]<128&&(parentObj.memory[65281]=data)},this.memoryHighWriter[2]=this.memoryHighWriteNormal,this.memoryWriter[65282]=this.memoryWriteNormal,this.memoryHighWriter[3]=this.memoryWriter[65283]=this.cartIgnoreWrite,this.memoryHighWriter[4]=this.memoryWriter[65284]=function(parentObj){parentObj.DIVTicks&=255,parentObj.memory[65284]=0},this.memoryHighWriter[5]=this.memoryWriter[65285]=function(parentObj,address,data){parentObj.memory[65285]=data},this.memoryHighWriter[6]=this.memoryWriter[65286]=function(parentObj,address,data){parentObj.memory[65286]=data},this.memoryHighWriter[7]=this.memoryWriter[65287]=function(parentObj,address,data){parentObj.memory[65287]=7&data,parentObj.TIMAEnabled=4==(4&data),parentObj.TACClocker=Math.pow(4,0!=(3&data)?3&data:4)<<2},this.memoryHighWriter[8]=this.memoryWriter[65288]=this.cartIgnoreWrite,this.memoryHighWriter[9]=this.memoryWriter[65289]=this.cartIgnoreWrite,this.memoryHighWriter[10]=this.memoryWriter[65290]=this.cartIgnoreWrite,this.memoryHighWriter[11]=this.memoryWriter[65291]=this.cartIgnoreWrite,this.memoryHighWriter[12]=this.memoryWriter[65292]=this.cartIgnoreWrite,this.memoryHighWriter[13]=this.memoryWriter[65293]=this.cartIgnoreWrite,this.memoryHighWriter[14]=this.memoryWriter[65294]=this.cartIgnoreWrite,this.memoryHighWriter[15]=this.memoryWriter[65295]=function(parentObj,address,data){parentObj.interruptsRequested=data,parentObj.checkIRQMatching()},this.memoryHighWriter[16]=this.memoryWriter[65296]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel1decreaseSweep&&0==(8&data)&&parentObj.channel1Swept&&(parentObj.channel1SweepFault=!0),parentObj.channel1lastTimeSweep=(112&data)>>4,parentObj.channel1frequencySweepDivider=7&data,parentObj.channel1decreaseSweep=8==(8&data),parentObj.memory[65296]=data,parentObj.channel1EnableCheck())},this.memoryHighWriter[17]=this.memoryWriter[65297]=function(parentObj,address,data){(parentObj.soundMasterEnabled||!parentObj.cGBC)&&(parentObj.soundMasterEnabled?parentObj.audioJIT():data&=63,parentObj.channel1CachedDuty=parentObj.dutyLookup[data>>6],parentObj.channel1totalLength=64-(63&data),parentObj.memory[65297]=data,parentObj.channel1EnableCheck())},this.memoryHighWriter[18]=this.memoryWriter[65298]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel1Enabled&&0==parentObj.channel1envelopeSweeps&&(8==(8&(parentObj.memory[65298]^data))?(0==(8&parentObj.memory[65298])&&(7==(7&parentObj.memory[65298])?parentObj.channel1envelopeVolume+=2:++parentObj.channel1envelopeVolume),parentObj.channel1envelopeVolume=16-parentObj.channel1envelopeVolume&15):8==(15&parentObj.memory[65298])&&(parentObj.channel1envelopeVolume=1+parentObj.channel1envelopeVolume&15),parentObj.channel1OutputLevelCache()),parentObj.channel1envelopeType=8==(8&data),parentObj.memory[65298]=data,parentObj.channel1VolumeEnableCheck())
},this.memoryHighWriter[19]=this.memoryWriter[65299]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel1frequency=1792&parentObj.channel1frequency|data,parentObj.channel1FrequencyTracker=2048-parentObj.channel1frequency<<2)},this.memoryHighWriter[20]=this.memoryWriter[65300]=function(parentObj,address,data){if(parentObj.soundMasterEnabled){if(parentObj.audioJIT(),parentObj.channel1consecutive=0==(64&data),parentObj.channel1frequency=(7&data)<<8|255&parentObj.channel1frequency,parentObj.channel1FrequencyTracker=2048-parentObj.channel1frequency<<2,data>127){parentObj.channel1timeSweep=parentObj.channel1lastTimeSweep,parentObj.channel1Swept=!1;var nr12=parentObj.memory[65298];parentObj.channel1envelopeVolume=nr12>>4,parentObj.channel1OutputLevelCache(),parentObj.channel1envelopeSweepsLast=(7&nr12)-1,0==parentObj.channel1totalLength&&(parentObj.channel1totalLength=64),parentObj.channel1lastTimeSweep>0||parentObj.channel1frequencySweepDivider>0?parentObj.memory[65318]|=1:parentObj.memory[65318]&=254,64==(64&data)&&(parentObj.memory[65318]|=1),parentObj.channel1ShadowFrequency=parentObj.channel1frequency,parentObj.channel1SweepFault=!1,parentObj.channel1AudioSweepPerformDummy()}parentObj.channel1EnableCheck(),parentObj.memory[65300]=data}},this.memoryHighWriter[21]=this.memoryWriter[65301]=this.cartIgnoreWrite,this.memoryHighWriter[22]=this.memoryWriter[65302]=function(parentObj,address,data){(parentObj.soundMasterEnabled||!parentObj.cGBC)&&(parentObj.soundMasterEnabled?parentObj.audioJIT():data&=63,parentObj.channel2CachedDuty=parentObj.dutyLookup[data>>6],parentObj.channel2totalLength=64-(63&data),parentObj.memory[65302]=data,parentObj.channel2EnableCheck())},this.memoryHighWriter[23]=this.memoryWriter[65303]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel2Enabled&&0==parentObj.channel2envelopeSweeps&&(8==(8&(parentObj.memory[65303]^data))?(0==(8&parentObj.memory[65303])&&(7==(7&parentObj.memory[65303])?parentObj.channel2envelopeVolume+=2:++parentObj.channel2envelopeVolume),parentObj.channel2envelopeVolume=16-parentObj.channel2envelopeVolume&15):8==(15&parentObj.memory[65303])&&(parentObj.channel2envelopeVolume=1+parentObj.channel2envelopeVolume&15),parentObj.channel2OutputLevelCache()),parentObj.channel2envelopeType=8==(8&data),parentObj.memory[65303]=data,parentObj.channel2VolumeEnableCheck())},this.memoryHighWriter[24]=this.memoryWriter[65304]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel2frequency=1792&parentObj.channel2frequency|data,parentObj.channel2FrequencyTracker=2048-parentObj.channel2frequency<<2)},this.memoryHighWriter[25]=this.memoryWriter[65305]=function(parentObj,address,data){if(parentObj.soundMasterEnabled){if(parentObj.audioJIT(),data>127){var nr22=parentObj.memory[65303];parentObj.channel2envelopeVolume=nr22>>4,parentObj.channel2OutputLevelCache(),parentObj.channel2envelopeSweepsLast=(7&nr22)-1,0==parentObj.channel2totalLength&&(parentObj.channel2totalLength=64),64==(64&data)&&(parentObj.memory[65318]|=2)}parentObj.channel2consecutive=0==(64&data),parentObj.channel2frequency=(7&data)<<8|255&parentObj.channel2frequency,parentObj.channel2FrequencyTracker=2048-parentObj.channel2frequency<<2,parentObj.memory[65305]=data,parentObj.channel2EnableCheck()}},this.memoryHighWriter[26]=this.memoryWriter[65306]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),!parentObj.channel3canPlay&&data>=128&&(parentObj.channel3lastSampleLookup=0,parentObj.channel3UpdateCache()),parentObj.channel3canPlay=data>127,parentObj.channel3canPlay&&parentObj.memory[65306]>127&&!parentObj.channel3consecutive&&(parentObj.memory[65318]|=4),parentObj.memory[65306]=data)},this.memoryHighWriter[27]=this.memoryWriter[65307]=function(parentObj,address,data){(parentObj.soundMasterEnabled||!parentObj.cGBC)&&(parentObj.soundMasterEnabled&&parentObj.audioJIT(),parentObj.channel3totalLength=256-data,parentObj.channel3EnableCheck())},this.memoryHighWriter[28]=this.memoryWriter[65308]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),data&=96,parentObj.memory[65308]=data,parentObj.channel3patternType=0==data?4:(data>>5)-1)},this.memoryHighWriter[29]=this.memoryWriter[65309]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel3frequency=1792&parentObj.channel3frequency|data,parentObj.channel3FrequencyPeriod=2048-parentObj.channel3frequency<<1)},this.memoryHighWriter[30]=this.memoryWriter[65310]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),data>127&&(0==parentObj.channel3totalLength&&(parentObj.channel3totalLength=256),parentObj.channel3lastSampleLookup=0,64==(64&data)&&(parentObj.memory[65318]|=4)),parentObj.channel3consecutive=0==(64&data),parentObj.channel3frequency=(7&data)<<8|255&parentObj.channel3frequency,parentObj.channel3FrequencyPeriod=2048-parentObj.channel3frequency<<1,parentObj.memory[65310]=data,parentObj.channel3EnableCheck())},this.memoryHighWriter[31]=this.memoryWriter[65311]=this.cartIgnoreWrite,this.memoryHighWriter[32]=this.memoryWriter[65312]=function(parentObj,address,data){(parentObj.soundMasterEnabled||!parentObj.cGBC)&&(parentObj.soundMasterEnabled&&parentObj.audioJIT(),parentObj.channel4totalLength=64-(63&data),parentObj.channel4EnableCheck())},this.memoryHighWriter[33]=this.memoryWriter[65313]=function(parentObj,address,data){parentObj.soundMasterEnabled&&(parentObj.audioJIT(),parentObj.channel4Enabled&&0==parentObj.channel4envelopeSweeps&&(8==(8&(parentObj.memory[65313]^data))?(0==(8&parentObj.memory[65313])&&(7==(7&parentObj.memory[65313])?parentObj.channel4envelopeVolume+=2:++parentObj.channel4envelopeVolume),parentObj.channel4envelopeVolume=16-parentObj.channel4envelopeVolume&15):8==(15&parentObj.memory[65313])&&(parentObj.channel4envelopeVolume=1+parentObj.channel4envelopeVolume&15),parentObj.channel4currentVolume=parentObj.channel4envelopeVolume<<parentObj.channel4VolumeShifter),parentObj.channel4envelopeType=8==(8&data),parentObj.memory[65313]=data,parentObj.channel4UpdateCache(),parentObj.channel4VolumeEnableCheck())},this.memoryHighWriter[34]=this.memoryWriter[65314]=function(parentObj,address,data){if(parentObj.soundMasterEnabled){parentObj.audioJIT(),parentObj.channel4FrequencyPeriod=Math.max((7&data)<<4,8)<<(data>>4);var bitWidth=8&data;(8==bitWidth&&32767==parentObj.channel4BitRange||0==bitWidth&&127==parentObj.channel4BitRange)&&(parentObj.channel4lastSampleLookup=0,parentObj.channel4BitRange=8==bitWidth?127:32767,parentObj.channel4VolumeShifter=8==bitWidth?7:15,parentObj.channel4currentVolume=parentObj.channel4envelopeVolume<<parentObj.channel4VolumeShifter,parentObj.noiseSampleTable=8==bitWidth?parentObj.LSFR7Table:parentObj.LSFR15Table),parentObj.memory[65314]=data,parentObj.channel4UpdateCache()}},this.memoryHighWriter[35]=this.memoryWriter[65315]=function(parentObj,address,data){if(parentObj.soundMasterEnabled){if(parentObj.audioJIT(),parentObj.memory[65315]=data,parentObj.channel4consecutive=0==(64&data),data>127){var nr42=parentObj.memory[65313];parentObj.channel4envelopeVolume=nr42>>4,parentObj.channel4currentVolume=parentObj.channel4envelopeVolume<<parentObj.channel4VolumeShifter,parentObj.channel4envelopeSweepsLast=(7&nr42)-1,0==parentObj.channel4totalLength&&(parentObj.channel4totalLength=64),64==(64&data)&&(parentObj.memory[65318]|=8)}parentObj.channel4EnableCheck()}},this.memoryHighWriter[36]=this.memoryWriter[65316]=function(parentObj,address,data){parentObj.soundMasterEnabled&&parentObj.memory[65316]!=data&&(parentObj.audioJIT(),parentObj.memory[65316]=data,parentObj.VinLeftChannelMasterVolume=(data>>4&7)+1,parentObj.VinRightChannelMasterVolume=(7&data)+1,parentObj.mixerOutputLevelCache())},this.memoryHighWriter[37]=this.memoryWriter[65317]=function(parentObj,address,data){parentObj.soundMasterEnabled&&parentObj.memory[65317]!=data&&(parentObj.audioJIT(),parentObj.memory[65317]=data,parentObj.rightChannel1=1==(1&data),parentObj.rightChannel2=2==(2&data),parentObj.rightChannel3=4==(4&data),parentObj.rightChannel4=8==(8&data),parentObj.leftChannel1=16==(16&data),parentObj.leftChannel2=32==(32&data),parentObj.leftChannel3=64==(64&data),parentObj.leftChannel4=data>127,parentObj.channel1OutputLevelCache(),parentObj.channel2OutputLevelCache(),parentObj.channel3OutputLevelCache(),parentObj.channel4OutputLevelCache())},this.memoryHighWriter[38]=this.memoryWriter[65318]=function(parentObj,address,data){if(parentObj.audioJIT(),!parentObj.soundMasterEnabled&&data>127)parentObj.memory[65318]=128,parentObj.soundMasterEnabled=!0,parentObj.initializeAudioStartState();else if(parentObj.soundMasterEnabled&&128>data){parentObj.memory[65318]=0,parentObj.soundMasterEnabled=!1;for(var index=65296;65318>index;index++)parentObj.memoryWriter[index](parentObj,index,0)}},this.memoryHighWriter[39]=this.memoryWriter[65319]=this.cartIgnoreWrite,this.memoryHighWriter[40]=this.memoryWriter[65320]=this.cartIgnoreWrite,this.memoryHighWriter[41]=this.memoryWriter[65321]=this.cartIgnoreWrite,this.memoryHighWriter[42]=this.memoryWriter[65322]=this.cartIgnoreWrite,this.memoryHighWriter[43]=this.memoryWriter[65323]=this.cartIgnoreWrite,this.memoryHighWriter[44]=this.memoryWriter[65324]=this.cartIgnoreWrite,this.memoryHighWriter[45]=this.memoryWriter[65325]=this.cartIgnoreWrite,this.memoryHighWriter[46]=this.memoryWriter[65326]=this.cartIgnoreWrite,this.memoryHighWriter[47]=this.memoryWriter[65327]=this.cartIgnoreWrite,this.memoryHighWriter[48]=this.memoryWriter[65328]=function(parentObj,address,data){parentObj.channel3WriteRAM(0,data)},this.memoryHighWriter[49]=this.memoryWriter[65329]=function(parentObj,address,data){parentObj.channel3WriteRAM(1,data)},this.memoryHighWriter[50]=this.memoryWriter[65330]=function(parentObj,address,data){parentObj.channel3WriteRAM(2,data)},this.memoryHighWriter[51]=this.memoryWriter[65331]=function(parentObj,address,data){parentObj.channel3WriteRAM(3,data)},this.memoryHighWriter[52]=this.memoryWriter[65332]=function(parentObj,address,data){parentObj.channel3WriteRAM(4,data)},this.memoryHighWriter[53]=this.memoryWriter[65333]=function(parentObj,address,data){parentObj.channel3WriteRAM(5,data)},this.memoryHighWriter[54]=this.memoryWriter[65334]=function(parentObj,address,data){parentObj.channel3WriteRAM(6,data)},this.memoryHighWriter[55]=this.memoryWriter[65335]=function(parentObj,address,data){parentObj.channel3WriteRAM(7,data)},this.memoryHighWriter[56]=this.memoryWriter[65336]=function(parentObj,address,data){parentObj.channel3WriteRAM(8,data)},this.memoryHighWriter[57]=this.memoryWriter[65337]=function(parentObj,address,data){parentObj.channel3WriteRAM(9,data)},this.memoryHighWriter[58]=this.memoryWriter[65338]=function(parentObj,address,data){parentObj.channel3WriteRAM(10,data)},this.memoryHighWriter[59]=this.memoryWriter[65339]=function(parentObj,address,data){parentObj.channel3WriteRAM(11,data)},this.memoryHighWriter[60]=this.memoryWriter[65340]=function(parentObj,address,data){parentObj.channel3WriteRAM(12,data)},this.memoryHighWriter[61]=this.memoryWriter[65341]=function(parentObj,address,data){parentObj.channel3WriteRAM(13,data)},this.memoryHighWriter[62]=this.memoryWriter[65342]=function(parentObj,address,data){parentObj.channel3WriteRAM(14,data)},this.memoryHighWriter[63]=this.memoryWriter[65343]=function(parentObj,address,data){parentObj.channel3WriteRAM(15,data)},this.memoryHighWriter[66]=this.memoryWriter[65346]=function(parentObj,address,data){parentObj.backgroundY!=data&&(parentObj.midScanLineJIT(),parentObj.backgroundY=data)},this.memoryHighWriter[67]=this.memoryWriter[65347]=function(parentObj,address,data){parentObj.backgroundX!=data&&(parentObj.midScanLineJIT(),parentObj.backgroundX=data)},this.memoryHighWriter[68]=this.memoryWriter[65348]=function(parentObj){parentObj.LCDisOn&&(parentObj.modeSTAT=2,parentObj.midScanlineOffset=-1,parentObj.totalLinesPassed=parentObj.currentX=parentObj.queuedScanLines=parentObj.lastUnrenderedLine=parentObj.LCDTicks=parentObj.STATTracker=parentObj.actualScanLine=parentObj.memory[65348]=0)},this.memoryHighWriter[69]=this.memoryWriter[65349]=function(parentObj,address,data){parentObj.memory[65349]!=data&&(parentObj.memory[65349]=data,parentObj.LCDisOn&&parentObj.matchLYC())},this.memoryHighWriter[74]=this.memoryWriter[65354]=function(parentObj,address,data){parentObj.windowY!=data&&(parentObj.midScanLineJIT(),parentObj.windowY=data)},this.memoryHighWriter[75]=this.memoryWriter[65355]=function(parentObj,address,data){parentObj.memory[65355]!=data&&(parentObj.midScanLineJIT(),parentObj.memory[65355]=data,parentObj.windowX=data-7)},this.memoryHighWriter[114]=this.memoryWriter[65394]=function(parentObj,address,data){parentObj.memory[65394]=data},this.memoryHighWriter[115]=this.memoryWriter[65395]=function(parentObj,address,data){parentObj.memory[65395]=data},this.memoryHighWriter[117]=this.memoryWriter[65397]=function(parentObj,address,data){parentObj.memory[65397]=data},this.memoryHighWriter[118]=this.memoryWriter[65398]=this.cartIgnoreWrite,this.memoryHighWriter[119]=this.memoryWriter[65399]=this.cartIgnoreWrite,this.memoryHighWriter[255]=this.memoryWriter[65535]=function(parentObj,address,data){parentObj.interruptsEnabled=data,parentObj.checkIRQMatching()},this.recompileModelSpecificIOWriteHandling(),this.recompileBootIOWriteHandling()},GameBoyCore.prototype.recompileModelSpecificIOWriteHandling=function(){this.cGBC?(this.memoryHighWriter[2]=this.memoryWriter[65282]=function(parentObj,address,data){1==(1&data)?(parentObj.memory[65282]=127&data,parentObj.serialTimer=0==(2&data)?4096:128,parentObj.serialShiftTimer=parentObj.serialShiftTimerAllocated=0==(2&data)?512:16):(parentObj.memory[65282]=data,parentObj.serialShiftTimer=parentObj.serialShiftTimerAllocated=parentObj.serialTimer=0)},this.memoryHighWriter[64]=this.memoryWriter[65344]=function(parentObj,address,data){if(parentObj.memory[65344]!=data){parentObj.midScanLineJIT();var temp_var=data>127;temp_var!=parentObj.LCDisOn&&(parentObj.LCDisOn=temp_var,parentObj.memory[65345]&=120,parentObj.midScanlineOffset=-1,parentObj.totalLinesPassed=parentObj.currentX=parentObj.queuedScanLines=parentObj.lastUnrenderedLine=parentObj.STATTracker=parentObj.LCDTicks=parentObj.actualScanLine=parentObj.memory[65348]=0,parentObj.LCDisOn?(parentObj.modeSTAT=2,parentObj.matchLYC(),parentObj.LCDCONTROL=parentObj.LINECONTROL):(parentObj.modeSTAT=0,parentObj.LCDCONTROL=parentObj.DISPLAYOFFCONTROL,parentObj.DisplayShowOff()),parentObj.interruptsRequested&=253),parentObj.gfxWindowCHRBankPosition=64==(64&data)?1024:0,parentObj.gfxWindowDisplay=32==(32&data),parentObj.gfxBackgroundBankOffset=16==(16&data)?0:128,parentObj.gfxBackgroundCHRBankPosition=8==(8&data)?1024:0,parentObj.gfxSpriteNormalHeight=0==(4&data),parentObj.gfxSpriteShow=2==(2&data),parentObj.BGPriorityEnabled=1==(1&data),parentObj.priorityFlaggingPathRebuild(),parentObj.memory[65344]=data}},this.memoryHighWriter[65]=this.memoryWriter[65345]=function(parentObj,address,data){parentObj.LYCMatchTriggerSTAT=64==(64&data),parentObj.mode2TriggerSTAT=32==(32&data),parentObj.mode1TriggerSTAT=16==(16&data),parentObj.mode0TriggerSTAT=8==(8&data),parentObj.memory[65345]=120&data},this.memoryHighWriter[70]=this.memoryWriter[65350]=function(parentObj,address,data){if(parentObj.memory[65350]=data,224>data){data<<=8,address=65024;var stat=parentObj.modeSTAT;parentObj.modeSTAT=0;var newData=0;do if(newData=parentObj.memoryReader[data](parentObj,data++),newData!=parentObj.memory[address]){parentObj.modeSTAT=stat,parentObj.graphicsJIT(),parentObj.modeSTAT=0,parentObj.memory[address++]=newData;break}while(++address<65184);if(65184>address)do parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++);while(65184>address);parentObj.modeSTAT=stat}},this.memoryHighWriter[77]=this.memoryWriter[65357]=function(parentObj,address,data){parentObj.memory[65357]=127&data|128&parentObj.memory[65357]},this.memoryHighWriter[79]=this.memoryWriter[65359]=function(parentObj,address,data){parentObj.currVRAMBank=1&data,parentObj.BGCHRCurrentBank=parentObj.currVRAMBank>0?parentObj.BGCHRBank2:parentObj.BGCHRBank1},this.memoryHighWriter[81]=this.memoryWriter[65361]=function(parentObj,address,data){parentObj.hdmaRunning||(parentObj.memory[65361]=data)},this.memoryHighWriter[82]=this.memoryWriter[65362]=function(parentObj,address,data){parentObj.hdmaRunning||(parentObj.memory[65362]=240&data)},this.memoryHighWriter[83]=this.memoryWriter[65363]=function(parentObj,address,data){parentObj.hdmaRunning||(parentObj.memory[65363]=31&data)},this.memoryHighWriter[84]=this.memoryWriter[65364]=function(parentObj,address,data){parentObj.hdmaRunning||(parentObj.memory[65364]=240&data)},this.memoryHighWriter[85]=this.memoryWriter[65365]=function(parentObj,address,data){parentObj.hdmaRunning?0==(128&data)?(parentObj.hdmaRunning=!1,parentObj.memory[65365]|=128):parentObj.memory[65365]=127&data:0==(128&data)?(parentObj.DMAWrite((127&data)+1),parentObj.memory[65365]=255):(parentObj.hdmaRunning=!0,parentObj.memory[65365]=127&data)},this.memoryHighWriter[104]=this.memoryWriter[65384]=function(parentObj,address,data){parentObj.memory[65385]=parentObj.gbcBGRawPalette[63&data],parentObj.memory[65384]=data},this.memoryHighWriter[105]=this.memoryWriter[65385]=function(parentObj,address,data){if(parentObj.updateGBCBGPalette(63&parentObj.memory[65384],data),parentObj.memory[65384]>127){var next=parentObj.memory[65384]+1&63;parentObj.memory[65384]=128|next,parentObj.memory[65385]=parentObj.gbcBGRawPalette[next]}else parentObj.memory[65385]=data},this.memoryHighWriter[106]=this.memoryWriter[65386]=function(parentObj,address,data){parentObj.memory[65387]=parentObj.gbcOBJRawPalette[63&data],parentObj.memory[65386]=data},this.memoryHighWriter[107]=this.memoryWriter[65387]=function(parentObj,address,data){if(parentObj.updateGBCOBJPalette(63&parentObj.memory[65386],data),parentObj.memory[65386]>127){var next=parentObj.memory[65386]+1&63;parentObj.memory[65386]=128|next,parentObj.memory[65387]=parentObj.gbcOBJRawPalette[next]}else parentObj.memory[65387]=data},this.memoryHighWriter[112]=this.memoryWriter[65392]=function(parentObj,address,data){var addressCheck=parentObj.memory[65361]<<8|parentObj.memory[65362];(!parentObj.hdmaRunning||53248>addressCheck||addressCheck>=57344)&&(parentObj.gbcRamBank=Math.max(7&data,1),parentObj.gbcRamBankPosition=(parentObj.gbcRamBank-1<<12)-53248,parentObj.gbcRamBankPositionECHO=parentObj.gbcRamBankPosition-8192),parentObj.memory[65392]=data},this.memoryHighWriter[116]=this.memoryWriter[65396]=function(parentObj,address,data){parentObj.memory[65396]=data}):(this.memoryHighWriter[2]=this.memoryWriter[65282]=function(parentObj,address,data){1==(1&data)?(parentObj.memory[65282]=127&data,parentObj.serialTimer=4096,parentObj.serialShiftTimer=parentObj.serialShiftTimerAllocated=512):(parentObj.memory[65282]=data,parentObj.serialShiftTimer=parentObj.serialShiftTimerAllocated=parentObj.serialTimer=0)},this.memoryHighWriter[64]=this.memoryWriter[65344]=function(parentObj,address,data){if(parentObj.memory[65344]!=data){parentObj.midScanLineJIT();var temp_var=data>127;temp_var!=parentObj.LCDisOn&&(parentObj.LCDisOn=temp_var,parentObj.memory[65345]&=120,parentObj.midScanlineOffset=-1,parentObj.totalLinesPassed=parentObj.currentX=parentObj.queuedScanLines=parentObj.lastUnrenderedLine=parentObj.STATTracker=parentObj.LCDTicks=parentObj.actualScanLine=parentObj.memory[65348]=0,parentObj.LCDisOn?(parentObj.modeSTAT=2,parentObj.matchLYC(),parentObj.LCDCONTROL=parentObj.LINECONTROL):(parentObj.modeSTAT=0,parentObj.LCDCONTROL=parentObj.DISPLAYOFFCONTROL,parentObj.DisplayShowOff()),parentObj.interruptsRequested&=253),parentObj.gfxWindowCHRBankPosition=64==(64&data)?1024:0,parentObj.gfxWindowDisplay=32==(32&data),parentObj.gfxBackgroundBankOffset=16==(16&data)?0:128,parentObj.gfxBackgroundCHRBankPosition=8==(8&data)?1024:0,parentObj.gfxSpriteNormalHeight=0==(4&data),parentObj.gfxSpriteShow=2==(2&data),parentObj.bgEnabled=1==(1&data),parentObj.memory[65344]=data}},this.memoryHighWriter[65]=this.memoryWriter[65345]=function(parentObj,address,data){parentObj.LYCMatchTriggerSTAT=64==(64&data),parentObj.mode2TriggerSTAT=32==(32&data),parentObj.mode1TriggerSTAT=16==(16&data),parentObj.mode0TriggerSTAT=8==(8&data),parentObj.memory[65345]=120&data,(!parentObj.usedBootROM||!parentObj.usedGBCBootROM)&&parentObj.LCDisOn&&parentObj.modeSTAT<2&&(parentObj.interruptsRequested|=2,parentObj.checkIRQMatching())},this.memoryHighWriter[70]=this.memoryWriter[65350]=function(parentObj,address,data){if(parentObj.memory[65350]=data,data>127&&224>data){data<<=8,address=65024;var stat=parentObj.modeSTAT;parentObj.modeSTAT=0;var newData=0;do if(newData=parentObj.memoryReader[data](parentObj,data++),newData!=parentObj.memory[address]){parentObj.modeSTAT=stat,parentObj.graphicsJIT(),parentObj.modeSTAT=0,parentObj.memory[address++]=newData;break}while(++address<65184);if(65184>address)do parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++),parentObj.memory[address++]=parentObj.memoryReader[data](parentObj,data++);while(65184>address);parentObj.modeSTAT=stat}},this.memoryHighWriter[71]=this.memoryWriter[65351]=function(parentObj,address,data){parentObj.memory[65351]!=data&&(parentObj.midScanLineJIT(),parentObj.updateGBBGPalette(data),parentObj.memory[65351]=data)},this.memoryHighWriter[72]=this.memoryWriter[65352]=function(parentObj,address,data){parentObj.memory[65352]!=data&&(parentObj.midScanLineJIT(),parentObj.updateGBOBJPalette(0,data),parentObj.memory[65352]=data)},this.memoryHighWriter[73]=this.memoryWriter[65353]=function(parentObj,address,data){parentObj.memory[65353]!=data&&(parentObj.midScanLineJIT(),parentObj.updateGBOBJPalette(4,data),parentObj.memory[65353]=data)},this.memoryHighWriter[77]=this.memoryWriter[65357]=function(parentObj,address,data){parentObj.memory[65357]=data},this.memoryHighWriter[79]=this.memoryWriter[65359]=this.cartIgnoreWrite,this.memoryHighWriter[85]=this.memoryWriter[65365]=this.cartIgnoreWrite,this.memoryHighWriter[104]=this.memoryWriter[65384]=this.cartIgnoreWrite,this.memoryHighWriter[105]=this.memoryWriter[65385]=this.cartIgnoreWrite,this.memoryHighWriter[106]=this.memoryWriter[65386]=this.cartIgnoreWrite,this.memoryHighWriter[107]=this.memoryWriter[65387]=this.cartIgnoreWrite,this.memoryHighWriter[108]=this.memoryWriter[65388]=this.cartIgnoreWrite,this.memoryHighWriter[112]=this.memoryWriter[65392]=this.cartIgnoreWrite,this.memoryHighWriter[116]=this.memoryWriter[65396]=this.cartIgnoreWrite)},GameBoyCore.prototype.recompileBootIOWriteHandling=function(){this.inBootstrap?(this.memoryHighWriter[80]=this.memoryWriter[65360]=function(parentObj,address,data){debug("Boot ROM reads blocked: Bootstrap process has ended.",0),parentObj.inBootstrap=!1,parentObj.disableBootROM(),parentObj.memory[65360]=data},this.cGBC&&(this.memoryHighWriter[108]=this.memoryWriter[65388]=function(parentObj,address,data){parentObj.inBootstrap&&(parentObj.cGBC=0==(1&data),parentObj.name+parentObj.gameCode+parentObj.ROM[323]=="Game and Watch 50"&&(parentObj.cGBC=!0,debug("Created a boot exception for Game and Watch Gallery 2 (GBC ID byte is wrong on the cartridge).",1)),debug("Booted to GBC Mode: "+parentObj.cGBC,0)),parentObj.memory[65388]=data})):this.memoryHighWriter[80]=this.memoryWriter[65360]=this.cartIgnoreWrite},GameBoyCore.prototype.toTypedArray=function(baseArray,memtype){try{if(!this.opts.typedArrays)return baseArray;if(!baseArray||!baseArray.length)return[];var length=baseArray.length;switch(memtype){case"uint8":var typedArrayTemp=new Uint8Array(length);break;case"int8":var typedArrayTemp=new Int8Array(length);break;case"int32":var typedArrayTemp=new Int32Array(length);break;case"float32":var typedArrayTemp=new Float32Array(length)}for(var index=0;length>index;index++)typedArrayTemp[index]=baseArray[index];return typedArrayTemp}catch(error){return debug("Could not convert an array to a typed array: "+error.message,1),baseArray}},GameBoyCore.prototype.fromTypedArray=function(baseArray){try{if(!baseArray||!baseArray.length)return[];for(var arrayTemp=[],index=0;index<baseArray.length;++index)arrayTemp[index]=baseArray[index];return arrayTemp}catch(error){return debug("Conversion from a typed array failed: "+error.message,1),baseArray}},GameBoyCore.prototype.getTypedArray=function(length,defaultValue,numberType){var arrayHandle;try{if(!this.opts.typedArrays)throw new Error("Settings forced typed arrays to be disabled.");switch(numberType){case"int8":arrayHandle=new Int8Array(length);break;case"uint8":arrayHandle=new Uint8Array(length);break;case"int32":arrayHandle=new Int32Array(length);break;case"float32":arrayHandle=new Float32Array(length)}if(0!=defaultValue)for(var index=0;length>index;)arrayHandle[index++]=defaultValue}catch(error){debug("Could not convert an array to a typed array: "+error.message,1);for(var arrayHandle=[],index=0;length>index;)arrayHandle[index++]=defaultValue}return arrayHandle}},function(module,exports,__webpack_require__){function XAudioServer(channels,sampleRate,minBufferSize,maxBufferSize,underRunCallback,volume,failureCallback){XAudioJSChannelsAllocated=Math.max(channels,1),this.XAudioJSSampleRate=Math.abs(sampleRate),XAudioJSMinBufferSize=minBufferSize>=XAudioJSSamplesPerCallback*XAudioJSChannelsAllocated&&maxBufferSize>minBufferSize?minBufferSize&-XAudioJSChannelsAllocated:XAudioJSSamplesPerCallback*XAudioJSChannelsAllocated,XAudioJSMaxBufferSize=Math.floor(maxBufferSize)>XAudioJSMinBufferSize+XAudioJSChannelsAllocated?maxBufferSize&-XAudioJSChannelsAllocated:XAudioJSMinBufferSize*XAudioJSChannelsAllocated,this.underRunCallback="function"==typeof underRunCallback?underRunCallback:function(){},XAudioJSVolume=volume>=0&&1>=volume?volume:1,this.failureCallback="function"==typeof failureCallback?failureCallback:function(){throw new Error("XAudioJS has encountered a fatal error.")},this.initializeAudio()}function XAudioJSGenerateFlashSurroundString(){var XAudioJSTotalSamples=XAudioJSSamplesPerCallback<<1;XAudioJSBinaryString.length>XAudioJSTotalSamples&&(XAudioJSBinaryString=[]),XAudioJSTotalSamples=0;for(var index=0;XAudioJSSamplesPerCallback>index&&XAudioJSResampleBufferStart!=XAudioJSResampleBufferEnd;++index)XAudioJSBinaryString[XAudioJSTotalSamples++]=String.fromCharCode((16383*Math.min(Math.max(XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]+1,0),2)|0)+12288),XAudioJSBinaryString[XAudioJSTotalSamples++]=String.fromCharCode((16383*Math.min(Math.max(XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]+1,0),2)|0)+12288),XAudioJSResampleBufferStart+=XAudioJSChannelsAllocated-2,XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0);return XAudioJSBinaryString.join("")}function XAudioJSGenerateFlashStereoString(){var XAudioJSTotalSamples=XAudioJSSamplesPerCallback<<1;XAudioJSBinaryString.length>XAudioJSTotalSamples&&(XAudioJSBinaryString=[]);for(var index=0;XAudioJSTotalSamples>index&&XAudioJSResampleBufferStart!=XAudioJSResampleBufferEnd;)XAudioJSBinaryString[index++]=String.fromCharCode((16383*Math.min(Math.max(XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]+1,0),2)|0)+12288),XAudioJSBinaryString[index++]=String.fromCharCode((16383*Math.min(Math.max(XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]+1,0),2)|0)+12288),XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0);return XAudioJSBinaryString.join("")}function XAudioJSGenerateFlashMonoString(){XAudioJSBinaryString.length>XAudioJSSamplesPerCallback&&(XAudioJSBinaryString=[]);for(var index=0;XAudioJSSamplesPerCallback>index&&XAudioJSResampleBufferStart!=XAudioJSResampleBufferEnd;)XAudioJSBinaryString[index++]=String.fromCharCode((16383*Math.min(Math.max(XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]+1,0),2)|0)+12288),XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0);return XAudioJSBinaryString.join("")}function XAudioJSWebAudioEvent(event){for(var bufferCount=0,buffers=[];XAudioJSChannelsAllocated>bufferCount;++bufferCount)buffers[bufferCount]=event.outputBuffer.getChannelData(bufferCount);XAudioJSResampleRefill();for(var index=0;XAudioJSSamplesPerCallback>index&&XAudioJSResampleBufferStart!=XAudioJSResampleBufferEnd;++index){for(bufferCount=0;XAudioJSChannelsAllocated>bufferCount;++bufferCount)buffers[bufferCount][index]=XAudioJSResampledBuffer[XAudioJSResampleBufferStart++]*XAudioJSVolume;XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0)}for(;XAudioJSSamplesPerCallback>index;){for(bufferCount=0;XAudioJSChannelsAllocated>bufferCount;++bufferCount)buffers[bufferCount][index]=0;++index}}function XAudioJSMediaStreamPushAudio(event){var index=0,audioLengthRequested=event.data,samplesPerCallbackAll=XAudioJSSamplesPerCallback*XAudioJSChannelsAllocated,XAudioJSMediaStreamLengthAlias=audioLengthRequested%XAudioJSSamplesPerCallback;for(audioLengthRequested=audioLengthRequested-(XAudioJSMediaStreamLengthAliasCounter-XAudioJSMediaStreamLengthAliasCounter%XAudioJSSamplesPerCallback)-XAudioJSMediaStreamLengthAlias+XAudioJSSamplesPerCallback,XAudioJSMediaStreamLengthAliasCounter-=XAudioJSMediaStreamLengthAliasCounter-XAudioJSMediaStreamLengthAliasCounter%XAudioJSSamplesPerCallback,XAudioJSMediaStreamLengthAliasCounter+=XAudioJSSamplesPerCallback-XAudioJSMediaStreamLengthAlias,XAudioJSMediaStreamBuffer.length!=samplesPerCallbackAll&&(XAudioJSMediaStreamBuffer=new Float32Array(samplesPerCallbackAll)),XAudioJSResampleRefill();audioLengthRequested>index;){for(var index2=0;samplesPerCallbackAll>index2&&XAudioJSResampleBufferStart!=XAudioJSResampleBufferEnd;)XAudioJSMediaStreamBuffer[index2++]=XAudioJSResampledBuffer[XAudioJSResampleBufferStart++],XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0);XAudioJSMediaStreamWorker.postMessage([0,XAudioJSMediaStreamBuffer]),index+=XAudioJSSamplesPerCallback}}function XAudioJSResampleRefill(){if(XAudioJSAudioBufferSize>0){for(var resampleLength=XAudioJSResampleControl.resampler(XAudioJSGetBufferSamples()),resampledResult=XAudioJSResampleControl.outputBuffer,index2=0;resampleLength>index2;)XAudioJSResampledBuffer[XAudioJSResampleBufferEnd++]=resampledResult[index2++],XAudioJSResampleBufferEnd==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferEnd=0),XAudioJSResampleBufferStart==XAudioJSResampleBufferEnd&&(XAudioJSResampleBufferStart+=XAudioJSChannelsAllocated,XAudioJSResampleBufferStart==XAudioJSResampleBufferSize&&(XAudioJSResampleBufferStart=0));XAudioJSAudioBufferSize=0}}function XAudioJSResampledSamplesLeft(){return(XAudioJSResampleBufferEnd>=XAudioJSResampleBufferStart?0:XAudioJSResampleBufferSize)+XAudioJSResampleBufferEnd-XAudioJSResampleBufferStart}function XAudioJSGetBufferSamples(){return XAudioJSGetArraySlice(XAudioJSAudioContextSampleBuffer,XAudioJSAudioBufferSize)}function XAudioJSGetArraySlice(buffer,lengthOf){try{return buffer.subarray(0,lengthOf)}catch(error){try{return buffer.length=lengthOf,buffer}catch(error){return buffer.slice(0,lengthOf)}}}var Resampler=__webpack_require__(5),XAudioJSscriptsHandle=document.getElementsByTagName("script"),XAudioJSsourceHandle=XAudioJSscriptsHandle[XAudioJSscriptsHandle.length-1].src;XAudioServer.prototype.MOZWriteAudioNoCallback=function(buffer){for(var bufferLength=buffer.length,bufferIndex=0;bufferLength>bufferIndex;){for(var sliceLength=Math.min(bufferLength-bufferIndex,XAudioJSMaxBufferSize),sliceIndex=0;sliceLength>sliceIndex;++sliceIndex)XAudioJSAudioContextSampleBuffer[sliceIndex]=buffer[bufferIndex++];
var resampleLength=XAudioJSResampleControl.resampler(XAudioJSGetArraySlice(XAudioJSAudioContextSampleBuffer,sliceIndex));if(resampleLength>0){var resampledResult=XAudioJSResampleControl.outputBuffer,resampledBuffer=XAudioJSGetArraySlice(resampledResult,resampleLength);this.samplesAlreadyWritten+=this.audioHandleMoz.mozWriteAudio(resampledBuffer)}}},XAudioServer.prototype.callbackBasedWriteAudioNoCallback=function(buffer){for(var length=buffer.length,bufferCounter=0;length>bufferCounter&&XAudioJSMaxBufferSize>XAudioJSAudioBufferSize;)XAudioJSAudioContextSampleBuffer[XAudioJSAudioBufferSize++]=buffer[bufferCounter++]},XAudioServer.prototype.writeAudio=function(buffer){switch(this.audioType){case 0:this.MOZWriteAudioNoCallback(buffer),this.MOZExecuteCallback();break;case 2:this.checkFlashInit();case 1:case 3:this.callbackBasedWriteAudioNoCallback(buffer),this.callbackBasedExecuteCallback();break;default:this.failureCallback()}},XAudioServer.prototype.writeAudioNoCallback=function(buffer){switch(this.audioType){case 0:this.MOZWriteAudioNoCallback(buffer);break;case 2:this.checkFlashInit();case 1:case 3:this.callbackBasedWriteAudioNoCallback(buffer);break;default:this.failureCallback()}},XAudioServer.prototype.remainingBuffer=function(){switch(this.audioType){case 0:return Math.floor((this.samplesAlreadyWritten-this.audioHandleMoz.mozCurrentSampleOffset())*XAudioJSResampleControl.ratioWeight/XAudioJSChannelsAllocated)*XAudioJSChannelsAllocated;case 2:this.checkFlashInit();case 1:case 3:return Math.floor(XAudioJSResampledSamplesLeft()*XAudioJSResampleControl.ratioWeight/XAudioJSChannelsAllocated)*XAudioJSChannelsAllocated+XAudioJSAudioBufferSize;default:return this.failureCallback(),null}},XAudioServer.prototype.MOZExecuteCallback=function(){var samplesRequested=XAudioJSMinBufferSize-this.remainingBuffer();samplesRequested>0&&this.MOZWriteAudioNoCallback(this.underRunCallback(samplesRequested))},XAudioServer.prototype.callbackBasedExecuteCallback=function(){var samplesRequested=XAudioJSMinBufferSize-this.remainingBuffer();samplesRequested>0&&this.callbackBasedWriteAudioNoCallback(this.underRunCallback(samplesRequested))},XAudioServer.prototype.executeCallback=function(){switch(this.audioType){case 0:this.MOZExecuteCallback();break;case 2:this.checkFlashInit();case 1:case 3:this.callbackBasedExecuteCallback();break;default:this.failureCallback()}},XAudioServer.prototype.initializeAudio=function(){try{this.initializeMozAudio()}catch(error){try{this.initializeWebAudio()}catch(error){try{this.initializeMediaStream()}catch(error){try{this.initializeFlashAudio()}catch(error){this.audioType=-1,this.failureCallback()}}}}},XAudioServer.prototype.initializeMediaStream=function(){this.audioHandleMediaStream=new Audio,this.resetCallbackAPIAudioBuffer(XAudioJSMediaStreamSampleRate),XAudioJSMediaStreamWorker&&XAudioJSMediaStreamWorker.terminate(),XAudioJSMediaStreamWorker=new Worker(XAudioJSsourceHandle.substring(0,XAudioJSsourceHandle.length-3)+"MediaStreamWorker.js"),this.audioHandleMediaStreamProcessing=new ProcessedMediaStream(XAudioJSMediaStreamWorker,XAudioJSMediaStreamSampleRate,XAudioJSChannelsAllocated),this.audioHandleMediaStream.src=this.audioHandleMediaStreamProcessing,this.audioHandleMediaStream.volume=XAudioJSVolume,XAudioJSMediaStreamWorker.onmessage=XAudioJSMediaStreamPushAudio,XAudioJSMediaStreamWorker.postMessage([1,XAudioJSResampleBufferSize,XAudioJSChannelsAllocated]),this.audioHandleMediaStream.play(),this.audioType=3},XAudioServer.prototype.initializeMozAudio=function(){this.audioHandleMoz=new Audio,this.audioHandleMoz.mozSetup(XAudioJSChannelsAllocated,XAudioJSMozAudioSampleRate),this.audioHandleMoz.volume=XAudioJSVolume,this.samplesAlreadyWritten=0,this.audioType=0;var bufferAmount=this.XAudioJSSampleRate*XAudioJSChannelsAllocated/10|0;bufferAmount-=bufferAmount%XAudioJSChannelsAllocated,this.samplesAlreadyWritten-=bufferAmount,this.initializeResampler(XAudioJSMozAudioSampleRate)},XAudioServer.prototype.initializeWebAudio=function(){if(!XAudioJSWebAudioLaunchedContext){try{XAudioJSWebAudioContextHandle=new AudioContext}catch(error){XAudioJSWebAudioContextHandle=new webkitAudioContext}XAudioJSWebAudioLaunchedContext=!0}XAudioJSWebAudioAudioNode&&(XAudioJSWebAudioAudioNode.disconnect(),XAudioJSWebAudioAudioNode.onaudioprocess=null,XAudioJSWebAudioAudioNode=null);try{XAudioJSWebAudioAudioNode=XAudioJSWebAudioContextHandle.createScriptProcessor(XAudioJSSamplesPerCallback,0,XAudioJSChannelsAllocated)}catch(error){XAudioJSWebAudioAudioNode=XAudioJSWebAudioContextHandle.createJavaScriptNode(XAudioJSSamplesPerCallback,0,XAudioJSChannelsAllocated)}XAudioJSWebAudioAudioNode.onaudioprocess=XAudioJSWebAudioEvent,XAudioJSWebAudioAudioNode.connect(XAudioJSWebAudioContextHandle.destination),this.resetCallbackAPIAudioBuffer(XAudioJSWebAudioContextHandle.sampleRate),this.audioType=1},XAudioServer.prototype.initializeFlashAudio=function(){var existingFlashload=document.getElementById("XAudioJS");switch(this.flashInitialized=!1,this.resetCallbackAPIAudioBuffer(44100),XAudioJSChannelsAllocated){case 1:XAudioJSFlashTransportEncoder=XAudioJSGenerateFlashMonoString;break;case 2:XAudioJSFlashTransportEncoder=XAudioJSGenerateFlashStereoString;break;default:XAudioJSFlashTransportEncoder=XAudioJSGenerateFlashSurroundString}if(null==existingFlashload){this.audioHandleFlash=null;var thisObj=this,mainContainerNode=document.createElement("div");mainContainerNode.setAttribute("style","position: fixed; bottom: 0px; right: 0px; margin: 0px; padding: 0px; border: none; width: 8px; height: 8px; overflow: hidden; z-index: -1000; ");var containerNode=document.createElement("div");containerNode.setAttribute("style","position: static; border: none; width: 0px; height: 0px; visibility: hidden; margin: 8px; padding: 0px;"),containerNode.setAttribute("id","XAudioJS"),mainContainerNode.appendChild(containerNode),document.getElementsByTagName("body")[0].appendChild(mainContainerNode),swfobject.embedSWF(XAudioJSsourceHandle.substring(0,XAudioJSsourceHandle.length-9)+"JS.swf","XAudioJS","8","8","9.0.0","",{},{allowscriptaccess:"always"},{style:"position: static; visibility: hidden; margin: 8px; padding: 0px; border: none"},function(event){event.success?(thisObj.audioHandleFlash=event.ref,thisObj.checkFlashInit()):(thisObj.failureCallback(),thisObj.audioType=-1)})}else this.audioHandleFlash=existingFlashload,this.checkFlashInit();this.audioType=2},XAudioServer.prototype.changeVolume=function(newVolume){if(newVolume>=0&&1>=newVolume)switch(XAudioJSVolume=newVolume,this.audioType){case 0:this.audioHandleMoz.volume=XAudioJSVolume;case 1:break;case 2:this.flashInitialized?this.audioHandleFlash.changeVolume(XAudioJSVolume):this.checkFlashInit();break;case 3:this.audioHandleMediaStream.volume=XAudioJSVolume;break;default:this.failureCallback()}},XAudioServer.prototype.checkFlashInit=function(){if(!this.flashInitialized)try{this.audioHandleFlash&&this.audioHandleFlash.initialize&&(this.flashInitialized=!0,this.audioHandleFlash.initialize(XAudioJSChannelsAllocated,XAudioJSVolume))}catch(error){this.flashInitialized=!1}},XAudioServer.prototype.resetCallbackAPIAudioBuffer=function(APISampleRate){XAudioJSAudioBufferSize=XAudioJSResampleBufferEnd=XAudioJSResampleBufferStart=0,this.initializeResampler(APISampleRate),XAudioJSResampledBuffer=this.getFloat32(XAudioJSResampleBufferSize)},XAudioServer.prototype.initializeResampler=function(sampleRate){XAudioJSAudioContextSampleBuffer=this.getFloat32(XAudioJSMaxBufferSize),XAudioJSResampleBufferSize=Math.max(XAudioJSMaxBufferSize*Math.ceil(sampleRate/this.XAudioJSSampleRate)+XAudioJSChannelsAllocated,XAudioJSSamplesPerCallback*XAudioJSChannelsAllocated),XAudioJSResampleControl=new Resampler(this.XAudioJSSampleRate,sampleRate,XAudioJSChannelsAllocated,XAudioJSResampleBufferSize,!0)},XAudioServer.prototype.getFloat32=function(size){try{return new Float32Array(size)}catch(error){return[]}};var XAudioJSWebAudioContextHandle=null,XAudioJSWebAudioAudioNode=null,XAudioJSWebAudioLaunchedContext=!1,XAudioJSAudioContextSampleBuffer=[],XAudioJSResampledBuffer=[],XAudioJSMinBufferSize=15e3,XAudioJSMaxBufferSize=25e3,XAudioJSChannelsAllocated=1,XAudioJSVolume=1,XAudioJSResampleControl=null,XAudioJSAudioBufferSize=0,XAudioJSResampleBufferStart=0,XAudioJSResampleBufferEnd=0,XAudioJSResampleBufferSize=0,XAudioJSMediaStreamWorker=null,XAudioJSMediaStreamBuffer=[],XAudioJSMediaStreamSampleRate=44100,XAudioJSMozAudioSampleRate=44100,XAudioJSSamplesPerCallback=2048,XAudioJSFlashTransportEncoder=null,XAudioJSMediaStreamLengthAliasCounter=0,XAudioJSBinaryString=[];module.exports=XAudioServer},function(module){function Resampler(fromSampleRate,toSampleRate,channels,outputBufferSize,noReturn){this.fromSampleRate=fromSampleRate,this.toSampleRate=toSampleRate,this.channels=0|channels,this.outputBufferSize=outputBufferSize,this.noReturn=!!noReturn,this.initialize()}Resampler.prototype.initialize=function(){if(!(this.fromSampleRate>0&&this.toSampleRate>0&&this.channels>0))throw new Error("Invalid settings specified for the resampler.");this.fromSampleRate==this.toSampleRate?(this.resampler=this.bypassResampler,this.ratioWeight=1):(this.fromSampleRate<this.toSampleRate?(this.compileLinearInterpolationFunction(),this.lastWeight=1):(this.compileMultiTapFunction(),this.tailExists=!1,this.lastWeight=0),this.ratioWeight=this.fromSampleRate/this.toSampleRate,this.initializeBuffers())},Resampler.prototype.compileLinearInterpolationFunction=function(){for(var toCompile="var bufferLength = buffer.length;	  var outLength = this.outputBufferSize;	  if ((bufferLength % "+this.channels+") == 0) {	    if (bufferLength > 0) {	      var ratioWeight = this.ratioWeight;	      var weight = this.lastWeight;	      var firstWeight = 0;	      var secondWeight = 0;	      var sourceOffset = 0;	      var outputOffset = 0;	      var outputBuffer = this.outputBuffer;	      for (; weight < 1; weight += ratioWeight) {	        secondWeight = weight % 1;	        firstWeight = 1 - secondWeight;",channel=0;channel<this.channels;++channel)toCompile+="outputBuffer[outputOffset++] = (this.lastOutput["+channel+"] * firstWeight) + (buffer["+channel+"] * secondWeight);";toCompile+="}	      weight -= 1;	      for (bufferLength -= "+this.channels+", sourceOffset = Math.floor(weight) * "+this.channels+"; outputOffset < outLength && sourceOffset < bufferLength;) {	        secondWeight = weight % 1;	        firstWeight = 1 - secondWeight;";for(var channel=0;channel<this.channels;++channel)toCompile+="outputBuffer[outputOffset++] = (buffer[sourceOffset"+(channel>0?" + "+channel:"")+"] * firstWeight) + (buffer[sourceOffset + "+(this.channels+channel)+"] * secondWeight);";toCompile+="weight += ratioWeight;	        sourceOffset = Math.floor(weight) * "+this.channels+";	      }";for(var channel=0;channel<this.channels;++channel)toCompile+="this.lastOutput["+channel+"] = buffer[sourceOffset++];";toCompile+='this.lastWeight = weight % 1;	      return this.bufferSlice(outputOffset);	    }	    else {	      return (this.noReturn) ? 0 : [];	    }	  }	  else {	    throw(new Error("Buffer was of incorrect sample length."));	  }',this.resampler=Function("buffer",toCompile)},Resampler.prototype.compileMultiTapFunction=function(){for(var toCompile="var bufferLength = buffer.length;	  var outLength = this.outputBufferSize;	  if ((bufferLength % "+this.channels+") == 0) {	    if (bufferLength > 0) {	      var ratioWeight = this.ratioWeight;	      var weight = 0;",channel=0;channel<this.channels;++channel)toCompile+="var output"+channel+" = 0;";for(toCompile+="var actualPosition = 0;	      var amountToNext = 0;	      var alreadyProcessedTail = !this.tailExists;	      this.tailExists = false;	      var outputBuffer = this.outputBuffer;	      var outputOffset = 0;	      var currentPosition = 0;	      do {	        if (alreadyProcessedTail) {	          weight = ratioWeight;",channel=0;channel<this.channels;++channel)toCompile+="output"+channel+" = 0;";for(toCompile+="}	        else {	          weight = this.lastWeight;",channel=0;channel<this.channels;++channel)toCompile+="output"+channel+" = this.lastOutput["+channel+"];";for(toCompile+="alreadyProcessedTail = true;	        }	        while (weight > 0 && actualPosition < bufferLength) {	          amountToNext = 1 + actualPosition - currentPosition;	          if (weight >= amountToNext) {",channel=0;channel<this.channels;++channel)toCompile+="output"+channel+" += buffer[actualPosition++] * amountToNext;";for(toCompile+="currentPosition = actualPosition;	            weight -= amountToNext;	          }	          else {",channel=0;channel<this.channels;++channel)toCompile+="output"+channel+" += buffer[actualPosition"+(channel>0?" + "+channel:"")+"] * weight;";for(toCompile+="currentPosition += weight;	            weight = 0;	            break;	          }	        }	        if (weight == 0) {",channel=0;channel<this.channels;++channel)toCompile+="outputBuffer[outputOffset++] = output"+channel+" / ratioWeight;";for(toCompile+="}	        else {	          this.lastWeight = weight;",channel=0;channel<this.channels;++channel)toCompile+="this.lastOutput["+channel+"] = output"+channel+";";toCompile+='this.tailExists = true;	          break;	        }	      } while (actualPosition < bufferLength && outputOffset < outLength);	      return this.bufferSlice(outputOffset);	    }	    else {	      return (this.noReturn) ? 0 : [];	    }	  }	  else {	    throw(new Error("Buffer was of incorrect sample length."));	  }',this.resampler=Function("buffer",toCompile)},Resampler.prototype.bypassResampler=function(buffer){return this.noReturn?(this.outputBuffer=buffer,buffer.length):buffer},Resampler.prototype.bufferSlice=function(sliceAmount){if(this.noReturn)return sliceAmount;try{return this.outputBuffer.subarray(0,sliceAmount)}catch(error){try{return this.outputBuffer.length=sliceAmount,this.outputBuffer}catch(error){return this.outputBuffer.slice(0,sliceAmount)}}},Resampler.prototype.initializeBuffers=function(){try{this.outputBuffer=new Float32Array(this.outputBufferSize),this.lastOutput=new Float32Array(this.channels)}catch(error){this.outputBuffer=[],this.lastOutput=[]}},module.exports=Resampler},function(module,exports,__webpack_require__){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}var index=__webpack_require__(8);module.exports=Emitter,Emitter.prototype.on=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},fn._off=on,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;var i=index(callbacks,fn._off||fn);return~i&&callbacks.splice(i,1),this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module){function debug(name){return debug.enabled(name)?function(fmt){fmt=coerce(fmt);var curr=new Date,ms=curr-(debug[name]||curr);debug[name]=curr,fmt=name+" "+fmt+" +"+debug.humanize(ms),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(val){return val instanceof Error?val.stack||val.message:val}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(name){try{localStorage.debug=name}catch(e){}for(var split=(name||"").split(/[\s,]+/),len=split.length,i=0;len>i;i++)name=split[i].replace("*",".*?"),"-"===name[0]?debug.skips.push(new RegExp("^"+name.substr(1)+"$")):debug.names.push(new RegExp("^"+name+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(ms){var sec=1e3,min=6e4,hour=60*min;return ms>=hour?(ms/hour).toFixed(1)+"h":ms>=min?(ms/min).toFixed(1)+"m":ms>=sec?(ms/sec|0)+"s":ms+"ms"},debug.enabled=function(name){for(var i=0,len=debug.skips.length;len>i;i++)if(debug.skips[i].test(name))return!1;for(var i=0,len=debug.names.length;len>i;i++)if(debug.names[i].test(name))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}},function(module){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}}])});
//# sourceMappingURL=react-gameboy.min.map